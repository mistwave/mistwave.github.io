<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Yifu&#39;s Blog</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://duanyifu.com/"/>
  <updated>2020-01-31T08:41:06.385Z</updated>
  <id>http://duanyifu.com/</id>
  
  <author>
    <name>Yifu Duan</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>å®¢æˆ·ç«¯åˆ é™¤DOMèŠ‚ç‚¹çš„å‡ ç§æ–¹å¼</title>
    <link href="http://duanyifu.com/2020/01/31/%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%88%A0%E9%99%A4DOM%E8%8A%82%E7%82%B9%E7%9A%84%E5%87%A0%E7%A7%8D%E6%96%B9%E5%BC%8F/"/>
    <id>http://duanyifu.com/2020/01/31/å®¢æˆ·ç«¯åˆ é™¤DOMèŠ‚ç‚¹çš„å‡ ç§æ–¹å¼/</id>
    <published>2020-01-31T01:31:56.000Z</published>
    <updated>2020-01-31T08:41:06.385Z</updated>
    
    <content type="html"><![CDATA[<p>Bç«™é¦–é¡µæœ‰ä¸€äº›æ¿å—å®åœ¨æ˜¯<strong>è¾£çœ¼ç›</strong>ï¼Œæ‰€ä»¥å¾—æƒ³åŠæ³•å¤„ç†ä¸€ä¸‹ã€‚</p><p><img src="https://vip1.loli.net/2020/01/31/kiCKtmYol6Upbyh.jpg" alt="needremovebilibili.jpg"></p><h2 id="å‡†å¤‡å·¥ä½œ">å‡†å¤‡å·¥ä½œ</h2><p>æˆ‘å¸¸ç”¨çš„æµè§ˆå™¨æ˜¯Chromeï¼Œæ‰€ä»¥å°±ç”¨<a href="https://chrome.google.com/webstore/detail/tampermonkey/dhdgffkkebhmkfjojejmpbldmpobfkfo" target="_blank" rel="noopener">Tampermonkey</a>æ¥åŠ è½½è„šæœ¬ã€‚</p><p>åŸç†ä¹Ÿå¾ˆç®€å•ï¼Œç­‰é¡µé¢åŠ è½½å®Œæˆåï¼Œæˆ‘ä»¬å¯ä»¥ç”¨Tampermonkeyå†è·‘ä¸€æ®µè‡ªå®šä¹‰çš„JavaScriptï¼Œç”¨æ¥æ“ä½œDOMæ ‘ã€‚</p><p>ç„¶åé€šè¿‡Chromeçš„å®¡æŸ¥å…ƒç´ ï¼Œå¾—çŸ¥ï¼Œéœ€è¦å»é™¤çš„å…ƒç´ idåˆ†åˆ«ä¸º<code>bili_report_live</code>å’Œ<code>reportFirst2</code>ã€‚</p><a id="more"></a><h2 id="version-1">Version 1</h2><p>æ ¹æ®æˆ‘ååˆ†æµ…è–„çš„å‰ç«¯çŸ¥è¯†ï¼Œå†™ä¸‹äº†éå¸¸<em>naÃ¯ve</em>çš„ä¸¤è¡Œï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">"bili_report_live"</span>).remove();</span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">"reportFirst2"</span>).remove();</span><br></pre></td></tr></table></figure><p>å®éªŒå‘ç°ï¼Œåœ¨REPLï¼ˆConsole tab in dev toolsï¼‰é‡Œè¾“å…¥è¿™ä¸¤è¡Œæ˜¯å¯è¡Œçš„ï¼Œä½†æ˜¯æ”¾åœ¨Tampermonkeyä¸­ï¼Œå°±ä¸è¡Œäº†ã€‚</p><p>æ²¡å…³ç³»ï¼Œæˆ‘ä»¬ä¾ç„¶å¯ä»¥åœ¨REPLä¸­çœ‹è§æŠ¥é”™ä¿¡æ¯ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Uncaught TypeError: Cannot read property &apos;remove&apos; of null</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p>NPEäº†ï¼Œæ¨æµ‹æ˜¯è„šæœ¬æ‰§è¡Œæ—¶æœºçš„é—®é¢˜ï¼ŒTampermonkeyæ‰§è¡Œè„šæœ¬çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦çš„èŠ‚ç‚¹è¿˜æ²¡æœ‰ç”Ÿæˆã€‚</p><h2 id="version-2">Version 2</h2><p>æ—¢ç„¶å¦‚æ­¤ï¼Œæˆ‘ä»¬å°è¯•ç­‰å¾…ä¸€ä¼šå„¿å†æ‰§è¡Œã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">document</span>.getElementById(<span class="string">"bili_report_live"</span>).remove(), <span class="number">500</span>)</span><br><span class="line">setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">document</span>.getElementById(<span class="string">"reportFirst2"</span>).remove(), <span class="number">500</span>)</span><br></pre></td></tr></table></figure><p>å°è¯•äº†ä¸‹500msçš„è¶…æ—¶ï¼Œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹å¯ä»¥æ­£ç¡®å¤„ç†ï¼Œä½†æ˜¯å¦‚æœç½‘ç»œæ³¢åŠ¨äº†ï¼Œå°±ä¼šå¤±è´¥ã€‚</p><p>é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰ç‚¹ä»¤äººä¸çˆ½ï¼Œä½ ä¼šçœ‹ç€è¿™ä¸¤å—å†…å®¹<strong>å…ˆå‡ºç°ï¼Œå†æ¶ˆå¤±</strong>ã€‚</p><p>çœ‹çœ‹è¿˜æœ‰æ²¡æœ‰åˆ«çš„åŠæ³•ã€‚</p><h2 id="version-3">Version 3</h2><p>CSSçš„id selectoræ˜¯ä¸ªå¥½é€‰æ‹©ï¼ŒDOMæ ‘ä¸­æœ‰äº†å°±è‡ªåŠ¨åº”ç”¨æ ·å¼ï¼Œæ²¡æœ‰çš„è¯ä¹Ÿä¸å½±å“ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(<span class="built_in">document</span>.head || <span class="built_in">document</span>.documentElement)</span><br><span class="line">  .insertAdjacentHTML(<span class="string">'beforeend'</span>,</span><br><span class="line">                      <span class="string">'&lt;style&gt;#bili_report_live &#123; display: none!important; &#125;&lt;/style&gt;'</span>);</span><br><span class="line">(<span class="built_in">document</span>.head || <span class="built_in">document</span>.documentElement)</span><br><span class="line">  .insertAdjacentHTML(<span class="string">'beforeend'</span>,</span><br><span class="line">                      <span class="string">'&lt;style&gt;#reportFirst2 &#123; display: none!important; &#125;&lt;/style&gt;'</span>);</span><br></pre></td></tr></table></figure><h2 id="version-4">Version 4</h2><p>è¿™ä¸ªéœ€æ±‚å…¶å®æœ‰ä¸ªç®€å•çš„æ€è·¯ï¼šæˆ‘å¸Œæœ›èƒ½åœ¨DOMæ ‘å˜æ›´çš„æ—¶å€™è¢«é€šçŸ¥åˆ°ã€‚</p><p>åœ¨MDNæœç´¢äº†ä¸€ä¸‹ï¼Œæœç„¶æœ‰è¿™ä¸ªAPIï¼š<a href="https://developer.mozilla.org/en-US/docs/Web/API/MutationObserver" target="_blank" rel="noopener">MutationObserver</a></p><p>è¿™æ ·å†™ä¹Ÿå°±OKäº†ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> MutationObserver(<span class="function"><span class="keyword">function</span>(<span class="params">mutations</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> e = <span class="built_in">document</span>.getElementById(<span class="string">"bili_report_live"</span>)</span><br><span class="line">  <span class="keyword">if</span> (e) &#123;</span><br><span class="line">    e.remove();</span><br><span class="line">    <span class="keyword">this</span>.disconnect();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;).observe(<span class="built_in">document</span>, &#123;<span class="attr">childList</span>: <span class="literal">true</span>, <span class="attr">subtree</span>: <span class="literal">true</span>&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> MutationObserver(<span class="function"><span class="keyword">function</span>(<span class="params">mutations</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> e = <span class="built_in">document</span>.getElementById(<span class="string">"reportFirst2"</span>)</span><br><span class="line">  <span class="keyword">if</span> (e) &#123;</span><br><span class="line">    e.remove();</span><br><span class="line">    <span class="keyword">this</span>.disconnect();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;).observe(<span class="built_in">document</span>, &#123;<span class="attr">childList</span>: <span class="literal">true</span>, <span class="attr">subtree</span>: <span class="literal">true</span>&#125;);</span><br></pre></td></tr></table></figure><h2 id="å°ç»“">å°ç»“</h2><p>v3å’Œv4éƒ½æ˜¯ä¸é”™çš„æ–¹æ³•ï¼Œèƒ½å¤Ÿå®Œç¾è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘çš„å‰ç«¯çŸ¥è¯†åˆå‰è¿›äº†ä¸€å°æ­¥ã€‚</p><p>ç°åœ¨bç«™é¦–é¡µçœ‹èµ·æ¥å°±æ˜¯è¿™ä¸ªæ ·å­äº†ï¼Œå¾ˆæ¸…çˆ½ï¼Œå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆã€‚</p><p><img src="https://vip1.loli.net/2020/01/31/LeX9iZvPyKhVWB5.png" alt="IMG_5192.PNG"></p><p>å®Œæ•´è„šæœ¬å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ==UserScript==</span></span><br><span class="line"><span class="comment">// @name         å»é™¤bilibiliæ¨å¹¿æ å’Œç›´æ’­æ </span></span><br><span class="line"><span class="comment">// @namespace    http://tampermonkey.net/</span></span><br><span class="line"><span class="comment">// @version      0.2</span></span><br><span class="line"><span class="comment">// @description  try to take over the world!</span></span><br><span class="line"><span class="comment">// @author       You</span></span><br><span class="line"><span class="comment">// @match        https://www.bilibili.com/</span></span><br><span class="line"><span class="comment">// @grant        none</span></span><br><span class="line"><span class="comment">// ==/UserScript==</span></span><br><span class="line"></span><br><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="meta">    'use strict'</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Your code here...=</span></span><br><span class="line">    <span class="comment">// v3</span></span><br><span class="line">    <span class="comment">// (document.head || document.documentElement)</span></span><br><span class="line">    <span class="comment">//   .insertAdjacentHTML('beforeend',</span></span><br><span class="line">    <span class="comment">//                       '&lt;style&gt;#bili_report_live &#123; display: none!important; &#125;&lt;/style&gt;');</span></span><br><span class="line">    <span class="comment">// (document.head || document.documentElement)</span></span><br><span class="line">    <span class="comment">//   .insertAdjacentHTML('beforeend',</span></span><br><span class="line">    <span class="comment">//                       '&lt;style&gt;#reportFirst2 &#123; display: none!important; &#125;&lt;/style&gt;');</span></span><br><span class="line">    <span class="comment">// v4</span></span><br><span class="line">    <span class="keyword">new</span> MutationObserver(<span class="function"><span class="keyword">function</span>(<span class="params">mutations</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">const</span> e = <span class="built_in">document</span>.getElementById(<span class="string">"bili_report_live"</span>)</span><br><span class="line">        <span class="keyword">if</span> (e) &#123;</span><br><span class="line">            e.remove();</span><br><span class="line">            <span class="keyword">this</span>.disconnect(); <span class="comment">// disconnect the observer</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;).observe(<span class="built_in">document</span>, &#123;<span class="attr">childList</span>: <span class="literal">true</span>, <span class="attr">subtree</span>: <span class="literal">true</span>&#125;);</span><br><span class="line">    <span class="keyword">new</span> MutationObserver(<span class="function"><span class="keyword">function</span>(<span class="params">mutations</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">const</span> e = <span class="built_in">document</span>.getElementById(<span class="string">"reportFirst2"</span>)</span><br><span class="line">        <span class="keyword">if</span> (e) &#123;</span><br><span class="line">            e.remove();</span><br><span class="line">            <span class="keyword">this</span>.disconnect(); <span class="comment">// disconnect the observer</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;).observe(<span class="built_in">document</span>, &#123;<span class="attr">childList</span>: <span class="literal">true</span>, <span class="attr">subtree</span>: <span class="literal">true</span>&#125;);</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Bç«™é¦–é¡µæœ‰ä¸€äº›æ¿å—å®åœ¨æ˜¯&lt;strong&gt;è¾£çœ¼ç›&lt;/strong&gt;ï¼Œæ‰€ä»¥å¾—æƒ³åŠæ³•å¤„ç†ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://vip1.loli.net/2020/01/31/kiCKtmYol6Upbyh.jpg&quot; alt=&quot;needremovebilibili.jpg&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;å‡†å¤‡å·¥ä½œ&quot;&gt;å‡†å¤‡å·¥ä½œ&lt;/h2&gt;
&lt;p&gt;æˆ‘å¸¸ç”¨çš„æµè§ˆå™¨æ˜¯Chromeï¼Œæ‰€ä»¥å°±ç”¨&lt;a href=&quot;https://chrome.google.com/webstore/detail/tampermonkey/dhdgffkkebhmkfjojejmpbldmpobfkfo&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Tampermonkey&lt;/a&gt;æ¥åŠ è½½è„šæœ¬ã€‚&lt;/p&gt;
&lt;p&gt;åŸç†ä¹Ÿå¾ˆç®€å•ï¼Œç­‰é¡µé¢åŠ è½½å®Œæˆåï¼Œæˆ‘ä»¬å¯ä»¥ç”¨Tampermonkeyå†è·‘ä¸€æ®µè‡ªå®šä¹‰çš„JavaScriptï¼Œç”¨æ¥æ“ä½œDOMæ ‘ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åé€šè¿‡Chromeçš„å®¡æŸ¥å…ƒç´ ï¼Œå¾—çŸ¥ï¼Œéœ€è¦å»é™¤çš„å…ƒç´ idåˆ†åˆ«ä¸º&lt;code&gt;bili_report_live&lt;/code&gt;å’Œ&lt;code&gt;reportFirst2&lt;/code&gt;ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Programming" scheme="http://duanyifu.com/categories/Programming/"/>
    
    
      <category term="Javascript" scheme="http://duanyifu.com/tags/Javascript/"/>
    
      <category term="Frontend" scheme="http://duanyifu.com/tags/Frontend/"/>
    
      <category term="Tampermonkey" scheme="http://duanyifu.com/tags/Tampermonkey/"/>
    
  </entry>
  
  <entry>
    <title>ForkJoinPoolç®€ä»‹</title>
    <link href="http://duanyifu.com/2019/12/30/ForkJoinPool/"/>
    <id>http://duanyifu.com/2019/12/30/ForkJoinPool/</id>
    <published>2019-12-29T22:33:56.000Z</published>
    <updated>2019-12-31T05:24:30.837Z</updated>
    
    <content type="html"><![CDATA[<h2 id="tl-dr">TL;DR</h2><p><code>ForkJoinPool</code>æ˜¯å®ç°äº†<a href="https://en.wikipedia.org/wiki/Work_stealing" target="_blank" rel="noopener">work stealing</a>çš„çº¿ç¨‹æ± ï¼Œå…¶ä¸­æ‰€æœ‰çº¿ç¨‹éƒ½æ˜¯<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Thread.html" target="_blank" rel="noopener">daemon thread</a>ã€‚</p><h2 id="å‡ ä¸ªæ —å­ğŸŒ°">å‡ ä¸ªæ —å­ğŸŒ°</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Java 7+</span></span><br><span class="line">CompletableFuture.supplyAsync(() -&gt; <span class="number">10</span>)</span><br><span class="line">  .thenCombineAsync(CompletableFuture.supplyAsync(() -&gt; <span class="number">32</span>),</span><br><span class="line">                    Integer::sum)</span><br><span class="line">  .thenAcceptAsync(x -&gt; System.out.println(<span class="string">"The answer is "</span> + x + <span class="string">"!"</span>));</span><br><span class="line"><span class="comment">// The answer is 42!</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Java 8+</span></span><br><span class="line">LongStream.rangeClosed(<span class="number">1</span>, <span class="number">1000000</span>)</span><br><span class="line">  .parallel()</span><br><span class="line">  .sum()</span><br><span class="line"><span class="comment">// 500000500000</span></span><br></pre></td></tr></table></figure><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Scala</span></span><br><span class="line">(<span class="number">1</span> to <span class="number">1000000</span>).toVector.par.fold(<span class="number">0</span>)(_ + _)</span><br><span class="line"><span class="comment">// 500000500000</span></span><br></pre></td></tr></table></figure><p>ä¸‰ä¸ªä¾‹å­åˆ†åˆ«æ˜¯ï¼š</p><ol><li>ä½¿ç”¨<code>CompletableFuture</code>ç»„åˆå¼‚æ­¥è®¡ç®—ï¼šå…¶ä¸­æ¯ä¸ªä»¥<em>Async</em>ç»“å°¾çš„æ–¹æ³•ï¼Œéƒ½å†æ¬¡å°†ä»»åŠ¡æäº¤ç»™äº†çº¿ç¨‹æ± ï¼Œå¤§æ¦‚ç‡ä¼šåœ¨å¦å¤–ä¸€ä¸ªçº¿ç¨‹ä¸­æ‰§è¡Œï¼›</li><li>ä½¿ç”¨<code>.parallel()</code>å¹¶è¡Œå¤„ç†Streamï¼š<code>.sum()</code>å¯¹å¹¶è¡ŒStreamæœ‰ä¼˜åŒ–ï¼Œå¯ä»¥æå‡æ•ˆç‡ï¼›</li><li>ä½¿ç”¨<code>.par</code>å°†<code>Vector</code>å˜æˆå¹¶è¡Œçš„è¿›è¡Œ<code>fold</code>ï¼šMonoidæ»¡è¶³ç»“åˆå¾‹ï¼Œæ‰€ä»¥å¯ä»¥å¹¶è¡Œ<code>fold</code>ã€‚</li></ol><p>æ‰¿è½½è¿™äº›å¼‚æ­¥ã€å¹¶è¡Œè®¡ç®—çš„çº¿ç¨‹æ± ï¼Œé»˜è®¤ä¼šä½¿ç”¨ä¸€ä¸ªJVMä¸ºæˆ‘ä»¬ç”Ÿæˆçš„<code>ForkJoinPool</code>ï¼Œå¯ä»¥ç”¨<code>ForkJoinPool.commonPool()</code>å¾—åˆ°å®ä¾‹ã€‚</p><p>é™¤æ­¤ä¹‹å¤–ï¼ŒScalaä¸­çš„<code>scala.concurrent.Future</code>ä¸€èˆ¬ä¼šä½¿ç”¨åˆ°<code>scala.concurrent.ExecutionContext.Implicits.global</code>ï¼Œè€Œåè€…å°±æ˜¯åŒ…è£…äº†è¿™ä¸ªcommon poolã€‚</p><a id="more"></a><h2 id="forkjoinpoolæ˜¯ä¸ªçº¿ç¨‹æ± ï¼Ÿ">ForkJoinPoolæ˜¯ä¸ªçº¿ç¨‹æ± ï¼Ÿ</h2><p>æ²¡é”™ï¼Œ<code>ForkJoinPool</code>å®ç°äº†<code>ExecutorService</code>æ¥å£ï¼Œæ˜¯ä¸ªçº¿ç¨‹æ± ã€‚</p><p>å¯¹äºcommon poolï¼Œæˆ‘ä»¬å¯ä»¥çœ‹è§å®ƒçš„é»˜è®¤å¤§å°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// CPU: i7-7920HQ(4 Cores, 8 Threads @3.10 GHz): </span></span><br><span class="line">System.out.println(ForkJoinPool.getCommonPoolParallelism());</span><br><span class="line"><span class="comment">// 7, the rest one is for main thread</span></span><br><span class="line"></span><br><span class="line">System.out.println(Runtime.getRuntime().availableProcessors());</span><br><span class="line"><span class="comment">// 8</span></span><br></pre></td></tr></table></figure><p>ç›¸æ¯”å…¶ä»–çº¿ç¨‹æ± ï¼Œ<code>ForkJoinPool</code>æœ‰ä¸¤ä¸ªæ˜¾è‘—çš„ç‰¹ç‚¹ï¼š</p><ol><li>æ‰€æœ‰çº¿ç¨‹éƒ½æ˜¯daemon threadï¼Œè¿™æ„å‘³ç€å½“JVMåœæ­¢æ—¶ï¼Œæ‰€æœ‰æœªå®Œæˆçš„ä»»åŠ¡ä¼šç›´æ¥ç»ˆä¸­æ–­ï¼›</li><li>work stealingç­–ç•¥ï¼šæ¯ä¸ªçº¿ç¨‹ä¼šæœ‰è‡ªå·±çš„dequeæ¥ç»´æŠ¤ä»»åŠ¡åˆ—è¡¨ï¼Œå½“è‡ªå·±çš„dequeç©ºäº†ï¼Œä¼šä»åˆ«çš„threadé˜Ÿåˆ—ï¼ˆæˆ–è€…æ˜¯poolçº§åˆ«çš„dequeï¼‰æœ«å°¾å·ä»»åŠ¡è¿‡æ¥æ‰§è¡Œã€‚æ¢å¥è¯è¯´ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½ä¼š<strong>å°½å¯èƒ½åœ°ä¸è®©è‡ªå·±ç©ºé—²ä¸‹æ¥</strong>ã€‚</li></ol><h2 id="æ¯”è¾ƒå¥½çš„å®è·µ">æ¯”è¾ƒå¥½çš„å®è·µ</h2><ol><li>ä¸è¦æäº¤<strong>å¯èƒ½é˜»å¡</strong>çš„ä»»åŠ¡ï¼Œè¿™æ ·å¯èƒ½é˜»å¡æ‰€æœ‰çº¿ç¨‹ï¼Œä½¿æ•´ä¸ªçº¿ç¨‹æ± æ— æ³•å“åº”ï¼›</li><li>å¦‚æœä¸€å®šè¦è¿™ä¹ˆåšï¼ˆ<code>ForkJoinPool</code>ä¼šå…ˆå¢å¤§å¹¶å‘åº¦ï¼ˆåŠ çº¿ç¨‹ï¼‰ï¼Œå†å¤„ç†ï¼‰ï¼š<ul><li>Javaç”¨<code>managedBlock(ForkJoinPool.ManagedBlocker blocker)</code>æ¥æ›¿ä»£<code>submit</code>ã€<code>execute</code>ç­‰</li><li>Scalaçš„<code>Future</code>ä½¿ç”¨<code>scala.concurrent.blocking</code></li></ul></li><li>å¦‚æœè¦syncï¼Œä½¿ç”¨<code>CompletableFuture</code>çš„<code>join()</code>æˆ–è€…<code>CountDownLatch</code>ã€‚</li></ol><h2 id="å¦ä¸€ç§ç”¨æ³•">å¦ä¸€ç§ç”¨æ³•</h2><p>ä¸Šé¢æè¿°çš„ç”¨æ³•ï¼Œä¸»è¦åœ¨åˆ©ç”¨äº†work stealingä»¥åŠcommon poolã€‚</p><p>ä»”ç»†æµè§ˆä¸€ä¸‹<code>ForkJoinPool</code>çš„APIï¼Œä¼šå‘ç°æœ‰ä¸€ä¸ªé•¿å¾—å¾ˆåƒçš„ç±»<code>ForkJoinTask</code>ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> ForkJoinTask&lt;V&gt; <span class="title">fork</span><span class="params">()</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">invokeAll</span><span class="params">(ForkJoinTask&lt;?&gt;... tasks)</span></span></span><br><span class="line"><span class="function">...</span></span><br></pre></td></tr></table></figure><p><code>ForkJoinTask</code>æœ‰è¿™ä¹ˆå‡ ä¸ªç‰¹ç‚¹ï¼š</p><ol><li>å¯ä»¥å¯¹åˆ†æ²»é€’å½’è¿›è¡Œå»ºæ¨¡ï¼Œæ‹†åˆ†å‡ºæ¥çš„å­ä»»åŠ¡è®©çº¿ç¨‹æ± å»å¤„ç†ï¼›</li><li>å­ä»»åŠ¡å¯ä»¥ä¾èµ–çˆ¶ä»»åŠ¡ï¼Œä»»åŠ¡é—´ä¾èµ–æ„æˆDAGï¼›</li><li>å¯ä»¥å½“æˆ<code>Future</code>ä½¿ç”¨ã€‚</li></ol><p>å…·ä½“å®è·µçš„ä¾‹å­å¯ä»¥å‚è€ƒè¿™é‡Œ<a href="https://www.baeldung.com/java-fork-join" target="_blank" rel="noopener">Guide to the Fork/Join Framework in Java</a>ã€‚</p><p>ä¸è¿‡è¿™ç§å¹¶å‘æ¨¡å‹æŒºè¯¡å¼‚çš„ï¼Œå¯ç»´æŠ¤æ€§ä¹Ÿæ¯”è¾ƒå·®ã€‚å¦‚æœèƒ½å¤Ÿä½¿ç”¨åˆ«çš„æ¨¡å‹ï¼Œè¿˜æ˜¯å°½é‡ä¸è¦ç”¨è¿™ä¸ªã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;tl-dr&quot;&gt;TL;DR&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;ForkJoinPool&lt;/code&gt;æ˜¯å®ç°äº†&lt;a href=&quot;https://en.wikipedia.org/wiki/Work_stealing&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;work stealing&lt;/a&gt;çš„çº¿ç¨‹æ± ï¼Œå…¶ä¸­æ‰€æœ‰çº¿ç¨‹éƒ½æ˜¯&lt;a href=&quot;https://docs.oracle.com/javase/8/docs/api/java/lang/Thread.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;daemon thread&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&quot;å‡ ä¸ªæ —å­ğŸŒ°&quot;&gt;å‡ ä¸ªæ —å­ğŸŒ°&lt;/h2&gt;
&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// Java 7+&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;CompletableFuture.supplyAsync(() -&amp;gt; &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  .thenCombineAsync(CompletableFuture.supplyAsync(() -&amp;gt; &lt;span class=&quot;number&quot;&gt;32&lt;/span&gt;),&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    Integer::sum)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  .thenAcceptAsync(x -&amp;gt; System.out.println(&lt;span class=&quot;string&quot;&gt;&quot;The answer is &quot;&lt;/span&gt; + x + &lt;span class=&quot;string&quot;&gt;&quot;!&quot;&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// The answer is 42!&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// Java 8+&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;LongStream.rangeClosed(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1000000&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  .parallel()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  .sum()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 500000500000&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&quot;highlight scala&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// Scala&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; to &lt;span class=&quot;number&quot;&gt;1000000&lt;/span&gt;).toVector.par.fold(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;)(_ + _)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 500000500000&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ä¸‰ä¸ªä¾‹å­åˆ†åˆ«æ˜¯ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä½¿ç”¨&lt;code&gt;CompletableFuture&lt;/code&gt;ç»„åˆå¼‚æ­¥è®¡ç®—ï¼šå…¶ä¸­æ¯ä¸ªä»¥&lt;em&gt;Async&lt;/em&gt;ç»“å°¾çš„æ–¹æ³•ï¼Œéƒ½å†æ¬¡å°†ä»»åŠ¡æäº¤ç»™äº†çº¿ç¨‹æ± ï¼Œå¤§æ¦‚ç‡ä¼šåœ¨å¦å¤–ä¸€ä¸ªçº¿ç¨‹ä¸­æ‰§è¡Œï¼›&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨&lt;code&gt;.parallel()&lt;/code&gt;å¹¶è¡Œå¤„ç†Streamï¼š&lt;code&gt;.sum()&lt;/code&gt;å¯¹å¹¶è¡ŒStreamæœ‰ä¼˜åŒ–ï¼Œå¯ä»¥æå‡æ•ˆç‡ï¼›&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨&lt;code&gt;.par&lt;/code&gt;å°†&lt;code&gt;Vector&lt;/code&gt;å˜æˆå¹¶è¡Œçš„è¿›è¡Œ&lt;code&gt;fold&lt;/code&gt;ï¼šMonoidæ»¡è¶³ç»“åˆå¾‹ï¼Œæ‰€ä»¥å¯ä»¥å¹¶è¡Œ&lt;code&gt;fold&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ‰¿è½½è¿™äº›å¼‚æ­¥ã€å¹¶è¡Œè®¡ç®—çš„çº¿ç¨‹æ± ï¼Œé»˜è®¤ä¼šä½¿ç”¨ä¸€ä¸ªJVMä¸ºæˆ‘ä»¬ç”Ÿæˆçš„&lt;code&gt;ForkJoinPool&lt;/code&gt;ï¼Œå¯ä»¥ç”¨&lt;code&gt;ForkJoinPool.commonPool()&lt;/code&gt;å¾—åˆ°å®ä¾‹ã€‚&lt;/p&gt;
&lt;p&gt;é™¤æ­¤ä¹‹å¤–ï¼ŒScalaä¸­çš„&lt;code&gt;scala.concurrent.Future&lt;/code&gt;ä¸€èˆ¬ä¼šä½¿ç”¨åˆ°&lt;code&gt;scala.concurrent.ExecutionContext.Implicits.global&lt;/code&gt;ï¼Œè€Œåè€…å°±æ˜¯åŒ…è£…äº†è¿™ä¸ªcommon poolã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Programming" scheme="http://duanyifu.com/categories/Programming/"/>
    
    
      <category term="Java" scheme="http://duanyifu.com/tags/Java/"/>
    
      <category term="Scala" scheme="http://duanyifu.com/tags/Scala/"/>
    
  </entry>
  
  <entry>
    <title>Monad in FP, Part I</title>
    <link href="http://duanyifu.com/2019/10/31/monad-in-FP-part-I/"/>
    <id>http://duanyifu.com/2019/10/31/monad-in-FP-part-I/</id>
    <published>2019-10-31T10:22:56.000Z</published>
    <updated>2019-10-31T10:20:58.301Z</updated>
    
    <content type="html"><![CDATA[<p><strong><em>Monad ---- â€œthe m-wordâ€ï¼Œâ€œa monoid in the category of endofunctorsâ€.</em></strong><br><em>see <a href="https://stackoverflow.com/questions/3870088/a-monad-is-just-a-monoid-in-the-category-of-endofunctors-whats-the-problem" target="_blank" rel="noopener">A monad is just a monoid in the category of endofunctors, whatâ€™s the problem?</a> for fun</em></p><hr><p>åœ¨FPçš„è·¯ä¸Šï¼Œä¸å¯é¿å…åœ°ä¼šç¢°åˆ°monadè¿™ä¸ªæ‹¦è·¯è™ã€‚ç»•æ˜¯ç»•ä¸è¿‡å»çš„ï¼Œé‚£å°±å­¦å’¯ã€‚</p><p><em>â€œæˆ‘çœ‹äº†å‡ åç¯‡å…³äºmonadçš„æ–‡ç« ï¼Œè¿˜æ˜¯æ²¡æ‡‚ã€‚â€ â€“ æŸä¸çŸ¥åFPçˆ±å¥½è€…</em></p><p>è¿™ç¯‡æ–‡ç« ä¹Ÿä¸æ˜¯silver bulletï¼Œæˆ‘åªå¸Œæœ›è¯»è€…åœ¨è¯»è¿‡ä»¥åï¼Œå¯¹monadèƒ½æœ‰ä¸ªå¤§è‡´çš„ã€æ¨¡ç³Šçš„å°è±¡ï¼Œä»Šåèƒ½å¤ŸæŒç»­åœ°ä»å¤šä¸ªè§’åº¦å»å®¡è§†è¿™ä¸ªæ¦‚å¿µï¼ŒåŠ æ·±è®¤è¯†ã€‚</p><h2 id="ä»€ä¹ˆæ˜¯monad">ä»€ä¹ˆæ˜¯monad</h2><p>æˆ‘ä»¬åœ¨è¯´functorçš„æ—¶å€™ï¼Œæœ‰ä¸€ä¸ªä¸é‚£ä¹ˆå‡†ç¡®çš„å®šä¹‰ï¼š<strong>æœ‰<code>map</code>çš„ï¼Œå°±æ˜¯functor</strong>ã€‚</p><p>å½“æˆ‘ä»¬è¿™æ ·å®šä¹‰çš„æ—¶å€™ï¼Œæˆ‘ä»¬å…¶å®æ˜¯åœ¨æ³›åŒ–<code>map</code>ï¼Œå°†å®ƒä»¬çš„å…±æ€§æŠ½è±¡å‡ºæ¥ï¼Œè¿™ä¸ªæŠ½è±¡å°±æ˜¯functorã€‚</p><p>åŒæ ·åœ°ï¼Œ<code>flatMap</code>ä¹Ÿå‡ºç°åœ¨å¾ˆå¤šåœ°æ–¹ï¼ˆæ¯”å¦‚<code>List</code>ï¼Œ<code>Option</code>ï¼Œ<code>Future</code>ï¼Œ<code>Either</code>ç­‰ç­‰ç­‰ï¼‰ï¼Œæˆ‘ä»¬è‡ªç„¶ä¹Ÿæƒ³æŠŠå…±æ€§æŠ½è±¡å‡ºæ¥ï¼Œè¿™ä¸ªæŠ½è±¡ï¼Œå°±æ˜¯monadã€‚æ‰€ä»¥å¯ä»¥ç±»ä¼¼åœ°è¯´ï¼š<strong>æœ‰<code>flatMap</code>çš„ï¼Œå°±æ˜¯monad</strong>ã€‚</p><p>å¥½å§ï¼Œå¦‚æœè¦æ­£å¼ä¸€ç‚¹ï¼Œå¼•ç”¨ä¸‹<em>scala with cats</em>é‡Œçš„å®šä¹‰ï¼š<strong>monadæ˜¯ä¸€ç§å°†è®¡ç®—æŒ‰é¡ºåºæ’åˆ—èµ·æ¥çš„æœºåˆ¶ï¼ˆa mechanism for sequencing computationsï¼‰</strong>ã€‚</p><a id="more"></a><h2 id="flatmapæ˜¯ä»€ä¹ˆ"><code>flatMap</code>æ˜¯ä»€ä¹ˆ</h2><p>å¦‚æœä½ ç†Ÿæ‚‰<code>flatMap</code>ï¼Œå¯ä»¥è·³è¿‡è¿™ä¸€å°èŠ‚ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span>(<span class="params">name: <span class="type">String</span>, friends: <span class="type">List</span>[<span class="type">String</span>]</span>)</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">val</span> <span class="title">bob</span> </span>= <span class="type">Person</span>(<span class="string">"Bob"</span>, <span class="type">List</span>(<span class="string">"Alice"</span>, <span class="string">"Pika"</span>))</span><br><span class="line"><span class="comment">// bob: Person = Person("Bob", List("Alice", "Pika"))</span></span><br><span class="line"><span class="keyword">val</span> harry = <span class="type">Person</span>(<span class="string">"Harry"</span>, <span class="type">List</span>(<span class="string">"Ron"</span>, <span class="string">"Hermione"</span>))</span><br><span class="line"><span class="comment">// harry: Person = Person("Harry", List("Ron", "Hermione"))</span></span><br><span class="line"><span class="keyword">val</span> ps = <span class="type">List</span>(bob, harry)</span><br><span class="line"><span class="comment">// ps: List[Person] = List(Person("Bob", List("Alice", "Pika")), Person("Harry", List("Ron", "Hermione")))</span></span><br><span class="line"></span><br><span class="line">ps.map(_.friends)</span><br><span class="line"><span class="comment">// res4: List[List[String]] = List(List("Alice", "Pika"), List("Ron", "Hermione"))</span></span><br><span class="line"></span><br><span class="line">ps.flatMap(_.friends)</span><br><span class="line"><span class="comment">// res5: List[String] = List("Alice", "Pika", "Ron", "Hermione")</span></span><br></pre></td></tr></table></figure><p>å¯¹äº<code>List[A]</code>æ¥è¯´ï¼Œ<code>map</code>å’Œ<code>flatMap</code>çš„ç­¾åï¼Œä»…ä»…æ˜¯ä¼ å…¥çš„<code>f</code>çš„è¿”å›ç±»å‹ä¸ä¸€æ ·ï¼š</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">map</span></span>[<span class="type">A</span>, <span class="type">B</span>](f: <span class="type">A</span> =&gt; <span class="type">B</span>): <span class="type">List</span>[<span class="type">B</span>]</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">flatMap</span></span>[<span class="type">A</span>, <span class="type">B</span>](f: <span class="type">A</span> =&gt; <span class="type">List</span>[<span class="type">B</span>]): <span class="type">List</span>[<span class="type">B</span>]</span><br></pre></td></tr></table></figure><p>ç›´è§‚æ¥è®²ï¼Œ<code>flatMap</code>å°†<code>List</code>å†…çš„æ¯ä¸€ä¸ªAï¼Œè½¬æ¢æˆäº†ä¸€ä¸ª<code>List[B]</code>ï¼Œç„¶åå°†æ‰€æœ‰çš„<code>List[B]</code>ï¼Œè¿äº†èµ·æ¥ã€‚</p><h2 id="ä¸¾ä¸ªæ —å­ğŸŒ°">ä¸¾ä¸ªæ —å­ğŸŒ°</h2><p>æˆ‘ä»¬çŸ¥é“ï¼Œ<code>Option</code>å¯ä»¥ç”¨æ¥è¡¨ç¤ºç»“æœæ˜¯å¦å­˜åœ¨ã€‚</p><p>è€ƒè™‘æ•´æ•°é™¤æ³•ï¼š</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// not pure, can throw exception</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">naiveDiv</span></span>(x: <span class="type">Int</span>, y: <span class="type">Int</span>): <span class="type">Int</span> = x / y</span><br><span class="line"></span><br><span class="line">naiveDiv(<span class="number">1</span>, <span class="number">0</span>)</span><br><span class="line"><span class="comment">// java.lang.ArithmeticException: / by zero</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// pure</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">div</span></span>(x: <span class="type">Int</span>, y: <span class="type">Int</span>): <span class="type">Option</span>[<span class="type">Int</span>] = </span><br><span class="line">  <span class="keyword">if</span> (y == <span class="number">0</span>) <span class="type">None</span> <span class="keyword">else</span> <span class="type">Some</span>(x / y)</span><br><span class="line"></span><br><span class="line">div(<span class="number">1</span>, <span class="number">0</span>)</span><br><span class="line"><span class="comment">// res13: Option[Int] = None</span></span><br><span class="line">div(<span class="number">8</span>, <span class="number">2</span>)</span><br><span class="line"><span class="comment">// res14: Option[Int] = Some(4)</span></span><br></pre></td></tr></table></figure><p>ç°åœ¨æˆ‘ä»¬ä¸ä»…è¦åšé™¤æ³•ï¼Œè¿˜è¦è®©ç”¨æˆ·è¾“å…¥è¿™ä¸¤ä¸ªå€¼ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ª<code>parseInt</code></p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">naiveParseInt</span></span>(s: <span class="type">String</span>): <span class="type">Int</span> = s.toInt</span><br><span class="line"></span><br><span class="line">naiveParseInt(<span class="string">"12"</span>)</span><br><span class="line"><span class="comment">// res17: Int = 42</span></span><br><span class="line">naiveParseInt(<span class="string">"aa"</span>)</span><br><span class="line"><span class="comment">// java.lang.NumberFormatException: For input string: "aa"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> scala.util.<span class="type">Try</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">parseInt</span></span>(s: <span class="type">String</span>): <span class="type">Option</span>[<span class="type">Int</span>] = <span class="type">Try</span>(s.toInt).toOption</span><br><span class="line"></span><br><span class="line">parseInt(<span class="string">"42"</span>)</span><br><span class="line"><span class="comment">// res24: Option[Int] = Some(42)</span></span><br><span class="line">parseInt(<span class="string">"aa"</span>)</span><br><span class="line"><span class="comment">// res25: Option[Int] = None</span></span><br></pre></td></tr></table></figure><p>ç°åœ¨æˆ‘ä»¬æŠŠä»–ä»¬ä¸²èµ·æ¥ï¼Œè‡ªç„¶åœ°ï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦è¿”å›ä¸€ä¸ª<code>Option[Int]</code>æ¥æ¶µç›–ç»“æœçš„æˆåŠŸå’Œå¤±è´¥ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">stringDiv</span></span>(a: <span class="type">String</span>, b: <span class="type">String</span>): <span class="type">Option</span>[<span class="type">Int</span>] = </span><br><span class="line">  parseInt(a).flatMap &#123; x =&gt; </span><br><span class="line">    parseInt(b).flatMap &#123; y =&gt; </span><br><span class="line">      div(x, y)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">stringDiv(<span class="string">"10"</span>, <span class="string">"2"</span>)</span><br><span class="line"><span class="comment">// res28: Option[Int] = Some(5)</span></span><br><span class="line">stringDiv(<span class="string">"a"</span>, <span class="string">"1"</span>)</span><br><span class="line"><span class="comment">// res29: Option[Int] = None</span></span><br><span class="line">stringDiv(<span class="string">"22"</span>, <span class="string">"0"</span>)</span><br><span class="line"><span class="comment">// res30: Option[Int] = None</span></span><br></pre></td></tr></table></figure><p><code>stringDiv</code>åšäº†è¿™äº›äº‹æƒ…ï¼š</p><ol><li><code>parseInt(a)</code>è¿”å›ä¸€ä¸ª<code>None</code>æˆ–è€…<code>Some(x)</code>ï¼›</li><li>å¦‚æœæ˜¯<code>Some</code>ï¼Œå°†<code>Some</code>å†…çš„å€¼<code>x</code>å–å‡ºæ¥ï¼Œä¼ é€’ç»™åé¢çš„å‡½æ•°ï¼›</li><li><code>parseInt(b)</code>è¿”å›ä¸€ä¸ª<code>None</code>æˆ–è€…<code>Some(y)</code>ï¼›</li><li>å¦‚æœæ˜¯<code>Some</code>ï¼Œå°†<code>Some</code>å†…çš„å€¼<code>y</code>å–å‡ºæ¥ï¼Œç»§ç»­ä¼ ç»™åé¢çš„å‡½æ•°ï¼›</li><li>è®¡ç®—<code>div(x, y)</code>ï¼Œè¿”å›æœ€ç»ˆç»“æœ<code>None</code>æˆ–è€…<code>Some(x)</code>ã€‚</li></ol><p>æ‰‹åŠ¨ä½¿ç”¨<code>flatMap</code>æ‹¼æ¥æ¯”è¾ƒç¹çï¼Œä¹Ÿä¸å¤ªå®¹æ˜“çœ‹å¾—æ¸…ã€‚Scalaä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªè¯­æ³•ç³–ï¼šfor-comprehensionã€‚</p><p>ä¸‹é¢çš„<code>stringDiv2</code>ä¸stringDivæ˜¯ç­‰ä»·çš„ï¼Œç¼–è¯‘å™¨ä¼šå¸®æˆ‘ä»¬æŠŠfor-comprehensionç¼–è¯‘æˆ<code>flatMap</code>ï¼ˆå’Œ<code>map</code>ï¼‰çš„è°ƒç”¨é“¾ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">stringDiv2</span></span>(a: <span class="type">String</span>, b: <span class="type">String</span>): <span class="type">Option</span>[<span class="type">Int</span>] = </span><br><span class="line">  <span class="keyword">for</span> &#123;</span><br><span class="line">    x &lt;- parseInt(a)</span><br><span class="line">    y &lt;- parseInt(b)</span><br><span class="line">    res &lt;- div(x, y)</span><br><span class="line">  &#125; <span class="keyword">yield</span> res</span><br></pre></td></tr></table></figure><p>å®¡è§†ä¸€ä¸‹ä¸Šé¢çš„ä¾‹å­ï¼Œæˆ‘ä»¬ç¡®ç¡®å®å®åœ°å°†è®¡ç®—ç»™ä¸²èµ·æ¥äº†ã€‚</p><p><code>flatMap</code>èµ·äº†ä»€ä¹ˆä½œç”¨å‘¢ï¼Ÿ</p><p><strong><code>flatMap</code>å°†ä¸Šæ¸¸<code>Option[Int]</code>ä¸­çš„å€¼æŠ½å‡ºæ¥ï¼Œæ‰§è¡Œè¿ç®—ï¼Œå†å¡è¿›<code>Option[Int]</code>ä¸­ï¼Œä¼ é€’ç»™ä¸‹æ¸¸ã€‚</strong></p><p>å› ä¸º<code>div</code>åªèƒ½æ¥å—<code>Int</code>ï¼Œè€Œä¼ ç»™<code>div</code>çš„æ˜¯<code>Option[Int]</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½ç”¨ç®€å•çš„å‡½æ•°ç»„åˆæ¥è§£å†³é—®é¢˜ã€‚</p><table><thead><tr><th>using <code>compose</code></th><th>using <code>flatMap</code></th></tr></thead><tbody><tr><td><code>naiveParseInt: String =&gt; Int</code></td><td><code>parseInt: String =&gt; Option[Int]</code></td></tr><tr><td><code>naiveDiv: (Int, Int) =&gt; Int</code></td><td><code>div: (Int, Int) =&gt; Option[Int]</code></td></tr><tr><td><code>(a, b) =&gt; naiveDiv(naiveParseInt(a),naiveParseInt(b))</code></td><td>see <code>stringDiv2</code></td></tr></tbody></table><h2 id="monadçš„å®šä¹‰"><code>Monad</code>çš„å®šä¹‰</h2><p>åœ¨ä¸Šè¿°çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨<code>flatMap</code>å°†<code>Option[Int]</code>ä¸²äº†èµ·æ¥ã€‚</p><p>å¦‚æœæˆ‘ä»¬åªæœ‰<code>Int</code>ï¼Œ<code>flatMap</code>å²‚ä¸æ˜¯æ¯«æ— ä½œç”¨ï¼Ÿ</p><p>æ²¡å…³ç³»ï¼Œæˆ‘ä»¬è¿˜æœ‰<code>unit</code>ï¼Œå¯ä»¥æŠŠä¸€ä¸ªå€¼<code>A</code>å˜æˆ<code>F[A]</code>ï¼Œå¯ä»¥è§†ä½œå°†ä¸€ä¸ªçº¯ç²¹çš„å€¼æå‡åˆ°äº†monadä¸Šä¸‹æ–‡ä¸­ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">trait</span> <span class="title">Monad</span>[<span class="type">F</span>[_]] </span>&#123;</span><br><span class="line">  <span class="comment">// `unit` is also known as `pure` or `return`</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">unit</span></span>[<span class="type">A</span>](value: <span class="type">A</span>): <span class="type">F</span>[<span class="type">A</span>]</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">flatMap</span></span>[<span class="type">A</span>, <span class="type">B</span>](ma: <span class="type">F</span>[<span class="type">A</span>])(f: <span class="type">A</span> =&gt; <span class="type">F</span>[<span class="type">B</span>]): <span class="type">F</span>[<span class="type">B</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬è¯´è¿‡ï¼Œmonadæ˜¯ç‰¹æ®Šçš„functorã€‚æ¢è¨€ä¹‹ï¼Œæ‰€æœ‰çš„monadéƒ½æ˜¯functorï¼Œä¸æ˜¯æ‰€æœ‰çš„functoréƒ½æ˜¯monadã€‚</p><p>å› ä¸ºæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>unit</code>å’Œ<code>flatMap</code>å®ç°<code>map</code>ï¼Œæœ‰äº†<code>map</code>ï¼Œè‡ªç„¶å°±æ˜¯functorã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">map</span></span>[<span class="type">A</span>, <span class="type">B</span>](ma: <span class="type">F</span>[<span class="type">A</span>])(f: <span class="type">A</span> =&gt; <span class="type">B</span>): <span class="type">F</span>[<span class="type">B</span>] = ???</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªå®ç°æ˜¯æ˜¾ç„¶ä¸”å”¯ä¸€çš„ï¼Œç­”æ¡ˆåœ¨æ–‡ç« æœ«å°¾ã€‚</p><h2 id="å°ç»“">å°ç»“</h2><p>è¿™æ¬¡æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªç®€å•çš„ä¾‹å­é˜è¿°äº†monadçš„ä½œç”¨ï¼Œå¹¶å†™ä¸‹äº†monadçš„ä¸€ç§å½¢å¼åŒ–å®šä¹‰ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¿˜ä¼šç ”ç©¶monadå®šå¾‹ï¼Œç ”ç©¶monadçš„ä¸åŒè¡¨ç°å½¢å¼ã€‚</p><p>æœ€åï¼Œæˆ‘ä»¬ä¼šç ”ç©¶å¤§é‡çš„monadå®ä¾‹ï¼Œæ¥åŠ æ·±ç†è§£ã€‚</p><h2 id="reference">Reference</h2><ol><li><a href="https://bartoszmilewski.com/2016/11/21/monads-programmers-definition/" target="_blank" rel="noopener">Monads: Programmerâ€™s Definition</a></li><li><a href="https://underscore.io/books/scala-with-cats/" target="_blank" rel="noopener">Monads â€“ Chapter 3 in <em>Scala with Cats</em></a></li><li><a href="https://www.manning.com/books/functional-programming-in-scala" target="_blank" rel="noopener">Monad â€“ Chapter 11 in <em>Functional Programming in Scala</em></a></li></ol><h2 id="ç­”æ¡ˆï¼šé€šè¿‡unitå’Œflatmapå®ç°map">ç­”æ¡ˆï¼šé€šè¿‡<code>unit</code>å’Œ<code>flatMap</code>å®ç°<code>map</code></h2><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">map</span></span>[<span class="type">A</span>, <span class="type">B</span>](ma: <span class="type">F</span>[<span class="type">A</span>])(f: <span class="type">A</span> =&gt; <span class="type">B</span>): <span class="type">F</span>[<span class="type">B</span>] = </span><br><span class="line">  flatMap(ma)(a =&gt; unit(f(a)))</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;&lt;em&gt;Monad ---- â€œthe m-wordâ€ï¼Œâ€œa monoid in the category of endofunctorsâ€.&lt;/em&gt;&lt;/strong&gt;&lt;br&gt;
&lt;em&gt;see &lt;a href=&quot;https://stackoverflow.com/questions/3870088/a-monad-is-just-a-monoid-in-the-category-of-endofunctors-whats-the-problem&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;A monad is just a monoid in the category of endofunctors, whatâ€™s the problem?&lt;/a&gt; for fun&lt;/em&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;åœ¨FPçš„è·¯ä¸Šï¼Œä¸å¯é¿å…åœ°ä¼šç¢°åˆ°monadè¿™ä¸ªæ‹¦è·¯è™ã€‚ç»•æ˜¯ç»•ä¸è¿‡å»çš„ï¼Œé‚£å°±å­¦å’¯ã€‚&lt;/p&gt;
&lt;p&gt;&lt;em&gt;â€œæˆ‘çœ‹äº†å‡ åç¯‡å…³äºmonadçš„æ–‡ç« ï¼Œè¿˜æ˜¯æ²¡æ‡‚ã€‚â€ â€“ æŸä¸çŸ¥åFPçˆ±å¥½è€…&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;è¿™ç¯‡æ–‡ç« ä¹Ÿä¸æ˜¯silver bulletï¼Œæˆ‘åªå¸Œæœ›è¯»è€…åœ¨è¯»è¿‡ä»¥åï¼Œå¯¹monadèƒ½æœ‰ä¸ªå¤§è‡´çš„ã€æ¨¡ç³Šçš„å°è±¡ï¼Œä»Šåèƒ½å¤ŸæŒç»­åœ°ä»å¤šä¸ªè§’åº¦å»å®¡è§†è¿™ä¸ªæ¦‚å¿µï¼ŒåŠ æ·±è®¤è¯†ã€‚&lt;/p&gt;
&lt;h2 id=&quot;ä»€ä¹ˆæ˜¯monad&quot;&gt;ä»€ä¹ˆæ˜¯monad&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬åœ¨è¯´functorçš„æ—¶å€™ï¼Œæœ‰ä¸€ä¸ªä¸é‚£ä¹ˆå‡†ç¡®çš„å®šä¹‰ï¼š&lt;strong&gt;æœ‰&lt;code&gt;map&lt;/code&gt;çš„ï¼Œå°±æ˜¯functor&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å½“æˆ‘ä»¬è¿™æ ·å®šä¹‰çš„æ—¶å€™ï¼Œæˆ‘ä»¬å…¶å®æ˜¯åœ¨æ³›åŒ–&lt;code&gt;map&lt;/code&gt;ï¼Œå°†å®ƒä»¬çš„å…±æ€§æŠ½è±¡å‡ºæ¥ï¼Œè¿™ä¸ªæŠ½è±¡å°±æ˜¯functorã€‚&lt;/p&gt;
&lt;p&gt;åŒæ ·åœ°ï¼Œ&lt;code&gt;flatMap&lt;/code&gt;ä¹Ÿå‡ºç°åœ¨å¾ˆå¤šåœ°æ–¹ï¼ˆæ¯”å¦‚&lt;code&gt;List&lt;/code&gt;ï¼Œ&lt;code&gt;Option&lt;/code&gt;ï¼Œ&lt;code&gt;Future&lt;/code&gt;ï¼Œ&lt;code&gt;Either&lt;/code&gt;ç­‰ç­‰ç­‰ï¼‰ï¼Œæˆ‘ä»¬è‡ªç„¶ä¹Ÿæƒ³æŠŠå…±æ€§æŠ½è±¡å‡ºæ¥ï¼Œè¿™ä¸ªæŠ½è±¡ï¼Œå°±æ˜¯monadã€‚æ‰€ä»¥å¯ä»¥ç±»ä¼¼åœ°è¯´ï¼š&lt;strong&gt;æœ‰&lt;code&gt;flatMap&lt;/code&gt;çš„ï¼Œå°±æ˜¯monad&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å¥½å§ï¼Œå¦‚æœè¦æ­£å¼ä¸€ç‚¹ï¼Œå¼•ç”¨ä¸‹&lt;em&gt;scala with cats&lt;/em&gt;é‡Œçš„å®šä¹‰ï¼š&lt;strong&gt;monadæ˜¯ä¸€ç§å°†è®¡ç®—æŒ‰é¡ºåºæ’åˆ—èµ·æ¥çš„æœºåˆ¶ï¼ˆa mechanism for sequencing computationsï¼‰&lt;/strong&gt;ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Programming" scheme="http://duanyifu.com/categories/Programming/"/>
    
    
      <category term="Scala" scheme="http://duanyifu.com/tags/Scala/"/>
    
      <category term="Functional Programming" scheme="http://duanyifu.com/tags/Functional-Programming/"/>
    
      <category term="Monad" scheme="http://duanyifu.com/tags/Monad/"/>
    
  </entry>
  
  <entry>
    <title>Functor in Functional Programming</title>
    <link href="http://duanyifu.com/2019/09/30/functor-in-FP/"/>
    <id>http://duanyifu.com/2019/09/30/functor-in-FP/</id>
    <published>2019-09-30T07:22:56.000Z</published>
    <updated>2019-10-31T10:15:17.972Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ä»€ä¹ˆæ˜¯functorï¼Ÿ">ä»€ä¹ˆæ˜¯Functorï¼Ÿ</h2><p>å…ˆçœ‹ä¸€æ®µä»£ç ï¼š</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// js</span></span><br><span class="line"><span class="built_in">Array</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>)</span><br><span class="line">  .map(<span class="function"><span class="params">i</span> =&gt;</span> i ** <span class="number">2</span>)</span><br><span class="line">  .map(<span class="function"><span class="params">i</span> =&gt;</span> i ** i)</span><br><span class="line"><span class="comment">// [1, 16, 81]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// scala</span></span><br><span class="line">Right(<span class="number">3</span>).map(<span class="function"><span class="params">n</span> =&gt;</span> n + <span class="string">" cats!"</span>)</span><br><span class="line"><span class="comment">// res2: Either[Nothing, String] = Right("3 cats!")</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// java</span></span><br><span class="line">Optional.empty().map(n -&gt; <span class="string">"hi, "</span> + n);</span><br><span class="line"><span class="comment">// Optional.empty</span></span><br></pre></td></tr></table></figure><p>è¿™äº›ç±»å‹éƒ½æœ‰<code>map</code>ï¼Œè€Œä¸”çœ‹ä¸Šå»<code>map</code>çš„ä½œç”¨å¥½åƒéƒ½ç›¸åŒã€‚</p><p>äº‹å®ä¸Šï¼Œå®ƒä»¬ç¡®å®ç›¸åŒã€‚</p><p>ä¸é‚£ä¹ˆå‡†ç¡®åœ°è¯´ï¼Œä»»ä½•ä¸œè¥¿åªè¦æœ‰<code>map</code>ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°†å®ƒè§†ä½œfunctorã€‚</p><p>è¦ç ”ç©¶functorï¼Œæˆ‘ä»¬éœ€è¦è½¬å˜ä¸€ä¸‹ï¼ˆå‘½ä»¤å¼ï¼‰æ€è·¯ã€‚</p><p>å¯ä»¥å°†functoræƒ³è±¡æˆä¸€ä¸ªå®¹å™¨ï¼Œå®¹å™¨é‡Œæ”¾äº†ä¸€äº›å…ƒç´ ã€‚</p><p><code>map</code>å¹¶ä¸æ˜¯å¯¹å®¹å™¨è¿›è¡Œä¸€æ¬¡éå†ï¼ˆtraverseï¼‰ï¼Œè€Œæ˜¯å¯¹å®¹å™¨å†…çš„å…ƒç´ åšä¸€ä¸ªå˜æ¢ï¼ˆtransformï¼‰ã€‚</p><p>å¦‚æœæœ‰å¤šä¸ª<code>map</code>è¢«ä¸²èµ·æ¥äº†ï¼Œåˆ™ä¼šæŒ‰ç…§å…ˆåé¡ºåºï¼Œè¿›è¡Œå˜æ¢ã€‚ï¼ˆè¿™é‡Œé¡ºåºæ˜¯å¾ˆé‡è¦çš„ï¼Œä¸‹é¢ä¼šç»†è¯´ï¼‰</p><a id="more"></a><h2 id="functorçš„å®šä¹‰">Functorçš„å®šä¹‰</h2><p>æˆ‘ä»¬å¯ä»¥å°†functorå®šä¹‰ä¸ºä¸€ä¸ªtraitï¼š</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">trait</span> <span class="title">Functor</span>[<span class="type">F</span>[_]] </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">map</span></span>[<span class="type">A</span>, <span class="type">B</span>](as: <span class="type">F</span>[<span class="type">A</span>])(f: <span class="type">A</span> =&gt; <span class="type">B</span>): <span class="type">F</span>[<span class="type">B</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯¹äºä¸€ä¸ªæ•°æ®ç»“æ„ï¼Œæˆ‘ä»¬åªéœ€è¦è®©å…¶ç»§æ‰¿è¿™ä¸ªtraitï¼Œå¹¶å®ç°<code>map</code>ï¼Œå°±å¯ä»¥æŠŠå®ƒå½“ä½œfunctoræ¥ç”¨äº†ã€‚</p><p>æ¯”å¦‚ï¼š</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> listFunctor: <span class="type">Functor</span>[<span class="type">List</span>] = <span class="keyword">new</span> <span class="type">Functor</span>[<span class="type">List</span>] &#123;</span><br><span class="line">  <span class="keyword">override</span> <span class="function"><span class="keyword">def</span> <span class="title">map</span></span>[<span class="type">A</span>, <span class="type">B</span>](as: <span class="type">List</span>[<span class="type">A</span>])(f: <span class="type">A</span> =&gt; <span class="type">B</span>): <span class="type">List</span>[<span class="type">B</span>] = as.map(f)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>functoræ³•åˆ™æ˜¯ä¸è¨€è‡ªæ˜çš„ï¼š</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">map(s)(a =&gt; a) == s</span><br></pre></td></tr></table></figure><p>å³ï¼Œç”¨identityå‡½æ•°æ˜ å°„ä¸€ä¸ªç»“æ„sï¼Œç»“æœä»ç„¶æ˜¯sã€‚</p><p>è§‚å¯Ÿä¸€ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°functorèƒ½åšçš„äº‹ä»…æœ‰ï¼š</p><ul><li>å°†å®¹å™¨å†…çš„å…ƒç´ è¿›è¡Œå˜æ¢ï¼ˆtransformï¼‰</li></ul><p>é™¤æ­¤ä¹‹å¤–ï¼Œéƒ½ä¸å¯ä»¥ã€‚</p><p>æ¯”å¦‚è¿™äº›äº‹æƒ…ï¼Œfunctoréƒ½æ˜¯åšä¸åˆ°çš„ï¼š</p><ol><li>æ”¹å˜å®¹å™¨æœ¬èº«ï¼š<code>List</code>å˜æˆä¸€ä¸ª<code>Set</code>ï¼Œ<code>Some</code>å˜æˆä¸€ä¸ª<code>None</code>ï¼›</li><li>å°†å…ƒç´ å–å‡ºæ¥ï¼šFunctor[A] å˜æˆ Aï¼›</li><li>æ”¹å˜å…ƒç´ ï¼šç§»é™¤<code>List</code>çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼›</li><li>å°†å…ƒç´ èšåˆæˆä¸€ä¸ªï¼šæ¯”å¦‚sumèµ·æ¥ï¼›</li><li>æŠ›å‡ºå¼‚å¸¸ã€‚</li></ol><h3 id="éå¸¸è§„functorçš„ä¾‹å­">éå¸¸è§„functorçš„ä¾‹å­</h3><h4 id="future">Future</h4><p><code>Future</code>ä¹Ÿæœ‰<code>map</code>æ–¹æ³•ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªfunctor ã€‚</p><p><code>map</code>ä¼šå°†<strong>å¼‚æ­¥</strong>è®¡ç®—åº”ç”¨äº<code>Future</code>å†…çš„å…ƒç´ ï¼Œå¤šä¸ª<code>map</code>ä¼šæŒ‰ç…§é¡ºåºå…ˆåæ‰§è¡Œã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> scala.concurrent.&#123;<span class="type">Await</span>, <span class="type">Future</span>&#125;</span><br><span class="line"><span class="keyword">import</span> scala.concurrent.<span class="type">ExecutionContext</span>.<span class="type">Implicits</span>.global</span><br><span class="line"><span class="keyword">import</span> scala.concurrent.duration._</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">FutureUsage</span> <span class="keyword">extends</span> <span class="title">App</span> </span>&#123;</span><br><span class="line">  <span class="keyword">val</span> future: <span class="type">Future</span>[<span class="type">String</span>] =</span><br><span class="line">    <span class="type">Future</span>(<span class="number">0</span>)</span><br><span class="line">      .map(_ + <span class="number">10</span>)</span><br><span class="line">      .map(_ * <span class="number">4</span>)</span><br><span class="line">      .map(_ + <span class="number">2</span>)</span><br><span class="line">      .map(<span class="string">"The Ultimate Answer to Life, The Universe and Everything is..."</span> + _ + <span class="string">"!"</span>)</span><br><span class="line">  <span class="type">Await</span>.result(future, <span class="number">1.</span>second)</span><br><span class="line">  <span class="comment">// "The Ultimate Answer to Life, The Universe and Everything is...42!"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å½“æˆ‘ä»¬ä½¿ç”¨<code>Future</code>çš„æ—¶å€™ï¼Œå…¶å®æˆ‘ä»¬å¹¶ä¸æ¸…æ¥š<code>Future</code>å†…éƒ¨çŠ¶æ€ã€‚</p><ul><li><p>å¦‚æœ<code>Future</code>å·²ç»å®Œæˆäº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„<code>map</code>å°±ä¼šç«‹åˆ»è¢«è°ƒç”¨ã€‚</p></li><li><p>å¦‚æœ<code>Future</code>å°šæœªå®Œæˆï¼Œæˆ‘ä»¬çš„<code>map</code>ä¼šè¢«æ”¾åˆ°é»˜è®¤çš„<code>ExecutionContext</code>é‡Œçš„é˜Ÿåˆ—ä¸­ï¼Œç­‰ç€ï¼Œä¹‹åå†æ‰§è¡Œã€‚</p></li></ul><p>å¯¹äº<code>Future</code>ä¸Šçš„<code>map</code>ï¼Œæˆ‘ä»¬å¹¶ä¸çŸ¥é“<code>map</code><strong>ä½•æ—¶</strong>ä¼šæ‰§è¡Œï¼Œæˆ‘ä»¬åªçŸ¥é“<code>map</code>æ‰§è¡Œçš„<strong>é¡ºåº</strong>ã€‚</p><h4 id="function-åˆ«æ€¥-å…ˆæ”¶èµ·ä½ å¤´ä¸Šçš„ï¼Ÿï¼Ÿï¼Ÿ">Functionï¼ˆåˆ«æ€¥ï¼Œå…ˆæ”¶èµ·ä½ å¤´ä¸Šçš„ï¼Ÿï¼Ÿï¼Ÿï¼‰</h4><p>è€ƒè™‘è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ª<code>f: T =&gt; A</code>å’Œä¸€ä¸ª<code>p: A =&gt; B</code>ï¼Œæƒ³è¦å¾—åˆ°ä¸€ä¸ª<code>g: T =&gt; B</code>ã€‚</p><p>ä½ ä¸€å®šä¼šè¯´ï¼Œè¿™ä¸ªç®€å•ï¼ŒåŸºæœ¬çš„function compositionå˜›ã€‚</p><p>è¿™é‡Œæˆ‘ä»¬éœ€è¦æ¢ä¸€ä¸ªè§†è§’ï¼š</p><ol><li>å°†<code>T =&gt; A</code>çœ‹ä½œ<code>SomeFunc[A]</code></li><li>ç»™<code>SomeFunc[A]</code>ä¸€ä¸ª<code>A =&gt; B</code></li><li>å¾—åˆ°ä¸€ä¸ª<code>SomeFunc[B]</code></li></ol><p>æ€ä¹ˆæ ·ï¼Œæˆ‘ä»¬æ˜¯ä¸æ˜¯å¯¹<code>SomeFunc</code>è¿›è¡Œäº†ä¸€æ¬¡<code>map</code>ã€‚<br>çœ‹ä¸€æ®µä¾‹å­ï¼Œè¿™é‡Œæˆ‘ä»¬ç”¨åˆ°äº†catsè¿™ä¸ªåº“ï¼Œcatsä¸ºScalaæä¾›äº†å¾ˆå¤šå‡½æ•°å¼çš„æŠ½è±¡ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> cats.instances.function._</span><br><span class="line"><span class="keyword">import</span> cats.syntax.functor._</span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> func1: <span class="type">Int</span> =&gt; <span class="type">String</span> =</span><br><span class="line">  (x: <span class="type">Int</span>) =&gt; x.toString</span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> func2: <span class="type">String</span> =&gt; <span class="type">String</span> =</span><br><span class="line">  (y: <span class="type">String</span>) =&gt; y + y</span><br><span class="line"></span><br><span class="line"><span class="comment">// three ways to compose functions</span></span><br><span class="line"><span class="comment">// 1. using map</span></span><br><span class="line">(func1.map(func2))(<span class="number">2</span>)</span><br><span class="line"><span class="comment">// 2. using andThen</span></span><br><span class="line">(func1.andThen(func2))(<span class="number">2</span>)</span><br><span class="line"><span class="comment">// 3. by hand</span></span><br><span class="line">func2(func1(<span class="number">2</span>))</span><br></pre></td></tr></table></figure><p>å½“æˆ‘ä»¬å†™ä¸‹<code>val f = f1.map(f2).map(f3).map(f4)</code>çš„æ—¶å€™ï¼Œè¿™ä¸€ä¸²<code>map</code>å°±æ˜¯å°†ä¸€ç³»åˆ—çš„è®¡ç®—â€™ä¸²â€™åœ¨äº†ä¸€èµ·ï¼Œç­‰åˆ°<code>f</code>è¢«è°ƒç”¨çš„æ—¶å€™å†æ‰§è¡Œï¼ˆå’Œ<code>Future</code>ä¸€æ ·ï¼‰ã€‚</p><p>PS: è¿™ä¸ªæˆ‘ä»¬å…¶å®å«å®ƒReader Functorï¼ˆè¯¦ç»†å†…å®¹å¯ä»¥çœ‹referencesä¸­ç¬¬ä¸€ç¯‡ï¼‰ã€‚</p><h2 id="å°ç»“">å°ç»“</h2><p>functoræ˜¯FPä¸­éå¸¸éå¸¸åŸºç¡€çš„æŠ½è±¡ï¼Œå°±åƒmonoidä¸€æ ·ï¼Œçœ‹ä¸Šå»å¯¹æˆ‘ä»¬æ—¥å¸¸çš„ç¼–ç¨‹å¹¶æ²¡æœ‰å¤ªå¤§çš„ä½œç”¨ï¼ˆå…¶å®æˆ‘ä»¬å¯ä»¥æ ¹æ®functoræ„å»ºé€šç”¨çš„<code>zip</code>å’Œ<code>unzip</code>ï¼‰ã€‚ä¸è¿‡æ²¡å…³ç³»ï¼Œä¹‹åæˆ‘ä»¬è¿˜ä¼šç ”ç©¶ä¸€äº›functorçš„ç‰¹ä¾‹ï¼Œmonadå’Œapplicative functorï¼Œè¿™äº›æ˜¯ååˆ†å®ç”¨ä¸”æ™®éçš„ã€‚</p><p>PSï¼šä½ å¯ä»¥åœ¨èŒƒç•´è®ºä¸­æ‰¾åˆ°functorçš„åŸå‹ï¼Œfunctoræ˜¯èŒƒç•´çš„æ€å°„ï¼ˆmorphism of categoriesï¼‰ï¼Œä¼šå°†ä¸€ä¸ªèŒƒç•´ä¸­çš„morphismå’Œobjectæ˜ å°„åˆ°å¦ä¸€ä¸ªèŒƒç•´ä¸­ã€‚</p><h2 id="references">References</h2><ol><li><a href="https://bartoszmilewski.com/2015/01/20/functors/" target="_blank" rel="noopener">Functors â€“ Chapter 8 in <em>the Category Theory for Programmers</em></a></li><li><a href="https://underscore.io/books/scala-with-cats/" target="_blank" rel="noopener">Functors â€“ Chapter 3 in <em>Scala with Cats</em></a></li><li><a href="https://www.manning.com/books/functional-programming-in-scala" target="_blank" rel="noopener">Monad â€“ Chapter 11 in <em>Functional Programming in Scala</em></a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;ä»€ä¹ˆæ˜¯functorï¼Ÿ&quot;&gt;ä»€ä¹ˆæ˜¯Functorï¼Ÿ&lt;/h2&gt;
&lt;p&gt;å…ˆçœ‹ä¸€æ®µä»£ç ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight typescript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// js&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;Array&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  .map(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;params&quot;&gt;i&lt;/span&gt; =&amp;gt;&lt;/span&gt; i ** &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  .map(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;params&quot;&gt;i&lt;/span&gt; =&amp;gt;&lt;/span&gt; i ** i)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// [1, 16, 81]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// scala&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Right(&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;).map(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;params&quot;&gt;n&lt;/span&gt; =&amp;gt;&lt;/span&gt; n + &lt;span class=&quot;string&quot;&gt;&quot; cats!&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// res2: Either[Nothing, String] = Right(&quot;3 cats!&quot;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// java&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Optional.empty().map(n -&amp;gt; &lt;span class=&quot;string&quot;&gt;&quot;hi, &quot;&lt;/span&gt; + n);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// Optional.empty&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;è¿™äº›ç±»å‹éƒ½æœ‰&lt;code&gt;map&lt;/code&gt;ï¼Œè€Œä¸”çœ‹ä¸Šå»&lt;code&gt;map&lt;/code&gt;çš„ä½œç”¨å¥½åƒéƒ½ç›¸åŒã€‚&lt;/p&gt;
&lt;p&gt;äº‹å®ä¸Šï¼Œå®ƒä»¬ç¡®å®ç›¸åŒã€‚&lt;/p&gt;
&lt;p&gt;ä¸é‚£ä¹ˆå‡†ç¡®åœ°è¯´ï¼Œä»»ä½•ä¸œè¥¿åªè¦æœ‰&lt;code&gt;map&lt;/code&gt;ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°†å®ƒè§†ä½œfunctorã€‚&lt;/p&gt;
&lt;p&gt;è¦ç ”ç©¶functorï¼Œæˆ‘ä»¬éœ€è¦è½¬å˜ä¸€ä¸‹ï¼ˆå‘½ä»¤å¼ï¼‰æ€è·¯ã€‚&lt;/p&gt;
&lt;p&gt;å¯ä»¥å°†functoræƒ³è±¡æˆä¸€ä¸ªå®¹å™¨ï¼Œå®¹å™¨é‡Œæ”¾äº†ä¸€äº›å…ƒç´ ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;map&lt;/code&gt;å¹¶ä¸æ˜¯å¯¹å®¹å™¨è¿›è¡Œä¸€æ¬¡éå†ï¼ˆtraverseï¼‰ï¼Œè€Œæ˜¯å¯¹å®¹å™¨å†…çš„å…ƒç´ åšä¸€ä¸ªå˜æ¢ï¼ˆtransformï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæœ‰å¤šä¸ª&lt;code&gt;map&lt;/code&gt;è¢«ä¸²èµ·æ¥äº†ï¼Œåˆ™ä¼šæŒ‰ç…§å…ˆåé¡ºåºï¼Œè¿›è¡Œå˜æ¢ã€‚ï¼ˆè¿™é‡Œé¡ºåºæ˜¯å¾ˆé‡è¦çš„ï¼Œä¸‹é¢ä¼šç»†è¯´ï¼‰&lt;/p&gt;
    
    </summary>
    
      <category term="Programming" scheme="http://duanyifu.com/categories/Programming/"/>
    
    
      <category term="Scala" scheme="http://duanyifu.com/tags/Scala/"/>
    
      <category term="Functional Programming" scheme="http://duanyifu.com/tags/Functional-Programming/"/>
    
      <category term="Functor" scheme="http://duanyifu.com/tags/Functor/"/>
    
  </entry>
  
  <entry>
    <title>æµ…è°ˆcovarianceå’Œcontravariance</title>
    <link href="http://duanyifu.com/2019/08/30/variance/"/>
    <id>http://duanyifu.com/2019/08/30/variance/</id>
    <published>2019-08-30T13:05:56.000Z</published>
    <updated>2019-09-01T10:51:11.298Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ä¸€äº›å®šä¹‰">ä¸€äº›å®šä¹‰</h2><p>è€ƒè™‘ç±»å‹<code>A</code>å’Œ<code>C</code>ï¼Œä»¥åŠæ³›å‹æ„é€ å™¨<code>F&lt;T&gt;</code>ï¼š</p><ul><li><strong>å¦‚æœæˆ‘ä»¬åœ¨ä¸€ä¸ªéœ€è¦<code>A</code>çš„åœ°æ–¹ï¼Œæ€»èƒ½ä½¿ç”¨<code>C</code>ï¼Œæˆ‘ä»¬å°±å¯ä»¥è¯´<code>C</code>æ˜¯<code>A</code>çš„å­ç±»å‹ï¼ˆsubtypeï¼‰<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup>ï¼Œè®°ä½œ<code>C &lt;: A</code>ã€‚</strong></li><li><strong>å¦‚æœFæ˜¯åå˜çš„ï¼ˆcovariantï¼‰ï¼Œä¸”<code>C &lt;: A</code>ï¼Œåˆ™æœ‰<code>F&lt;C&gt; &lt;: F&lt;A&gt;</code>ã€‚</strong></li><li><strong>å¦‚æœFæ˜¯é€†å˜çš„ï¼ˆcontravariantï¼‰ï¼Œä¸”<code>C &lt;: A</code>ï¼Œåˆ™æœ‰<code>F&lt;A&gt; &lt;: F&lt;C&gt;</code>ã€‚</strong></li><li><strong>å¦‚æœFæ˜¯ä¸å˜çš„ï¼ˆinvariantï¼‰ï¼Œæ— è®º<code>A</code>ä¸<code>C</code>æ˜¯ä»€ä¹ˆå…³ç³»ï¼Œ<code>F&lt;C&gt;</code> ä¸ <code>F&lt;A&gt;</code>éƒ½æ²¡æœ‰å…³ç³»ã€‚</strong></li></ul><h2 id="collectionè§†è§’">Collectionè§†è§’</h2><p>å…ˆä¸¾ç”¨ä¾‹å­æ¥çœ‹çœ‹Collectionçš„å‹å˜è§„åˆ™ã€‚</p><p><code>Duck</code>æ˜¯<code>Bird</code>çš„å­ç±»ï¼Œ<code>Bird</code>æ˜¯<code>Animal</code>çš„å­ç±»ï¼Œè®°ä½œ<code>Duck &lt;: Bird &lt;: Animal</code>ã€‚</p><p>TypeScriptä¸­çš„<code>Array</code>æ˜¯åå˜çš„ï¼ˆcovariantï¼‰ï¼š</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> Animal &#123; name: <span class="built_in">String</span> &#125;</span><br><span class="line"><span class="keyword">interface</span> Bird <span class="keyword">extends</span> Animal &#123;</span><br><span class="line">    <span class="comment">// not all animals can fly</span></span><br><span class="line">    fly: <span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">String</span> </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">interface</span> Duck <span class="keyword">extends</span> Bird &#123;</span><br><span class="line">    <span class="comment">// not all birds can swim</span></span><br><span class="line">    swim: <span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">String</span> </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> aDog: Animal = &#123;</span><br><span class="line">    name: <span class="string">""</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> aBird: Bird = &#123;</span><br><span class="line">    name: <span class="string">"Owl"</span>,</span><br><span class="line">    fly: <span class="function"><span class="params">()</span> =&gt;</span> name + <span class="string">" is flying!"</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> aDuck: Duck = &#123;</span><br><span class="line">    name: <span class="string">"Donald"</span>, </span><br><span class="line">    fly: <span class="function"><span class="params">()</span> =&gt;</span> name + <span class="string">" is flying!"</span>,</span><br><span class="line">    swim: <span class="function"><span class="params">()</span> =&gt;</span> name + <span class="string">" is swiming!"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Legal; Array is covariant, expecting an Array&lt;Animal&gt;, given an Array&lt;Bird&gt; </span></span><br><span class="line"><span class="keyword">const</span> animals: <span class="built_in">Array</span>&lt;Animal&gt; = [aDuck, aBird]; </span><br><span class="line"><span class="comment">// Illegal; expecting an Array&lt;Bird&gt;, given an Array&lt;Animal&gt;</span></span><br><span class="line"><span class="keyword">const</span> birds: <span class="built_in">Array</span>&lt;Bird&gt; = [aDuck, aDog];</span><br></pre></td></tr></table></figure><a id="more"></a><p>å‡½æ•°ä¼ å…¥å‚æ•°åŒæ ·éµå¾ªè¿™ä¸ªè§„åˆ™ï¼š</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">birdsFly</span>(<span class="params">birds: <span class="built_in">Array</span>&lt;Bird&gt;</span>) </span>&#123;</span><br><span class="line">    birds.forEach(<span class="function"><span class="params">b</span> =&gt;</span> b.fly())</span><br><span class="line">&#125;</span><br><span class="line">birdsFly(animals) <span class="comment">// Illegal</span></span><br><span class="line">birdsFly(birds) <span class="comment">// Legal, type matches</span></span><br><span class="line">birdsFly(ducks) <span class="comment">// Legal, Array&lt;Duck&gt; &lt;: Array&lt;Bird&gt;</span></span><br></pre></td></tr></table></figure><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒJavaçš„<code>List</code>æ˜¯ä¸å˜çš„ï¼ˆinvariantï¼‰ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Bird&gt; birds = <span class="keyword">new</span> ArrayList&lt;Duck&gt;(); <span class="comment">// Illegal</span></span><br><span class="line">List&lt;Bird&gt; birds = <span class="keyword">new</span> ArrayList&lt;Bird&gt;(); <span class="comment">// Legal</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">birdsFly</span><span class="params">(List&lt;Bird&gt; birds)</span> </span>&#123;...&#125;</span><br><span class="line"></span><br><span class="line">birdsFly(animals); <span class="comment">// Illegal</span></span><br><span class="line">birdsFly(birds); <span class="comment">// Legal</span></span><br><span class="line">birdsFly(ducks); <span class="comment">// Illegal</span></span><br></pre></td></tr></table></figure><p>å½“ç„¶ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨bounded wildcardsåœ¨ä½¿ç”¨æ—¶å»é™¤ä¸å˜æ€§ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">List&lt;? extends Bird&gt; coList = <span class="keyword">new</span> ArrayList&lt;Duck&gt;(); <span class="comment">// Legal; covariant</span></span><br><span class="line">List&lt;? <span class="keyword">super</span> Bird&gt; contraList = <span class="keyword">new</span> ArrayList&lt;Animal&gt;(); <span class="comment">// Legal; contravariant</span></span><br></pre></td></tr></table></figure><p><em>Effective Java</em>ä¸­æåˆ°çš„PECSï¼ˆproducer extendsï¼Œconsumer superï¼‰ï¼Œå°±æ˜¯è¯´ï¼Œå¦‚æœä½ æ¥æ”¶ä¸€ä¸ªCollectionï¼š</p><ul><li>åªè¯»å…¶ä¸­çš„å…ƒç´ ï¼ˆCollectionæ˜¯producerï¼‰ï¼Œé‚£ä¹ˆä½ æœ€å¥½æ¥å—ä¸€ä¸ªåå˜çš„Collectionï¼›</li><li>åä¹‹ï¼Œå¦‚æœä½ åªå†™å…¥<code>List</code>ï¼ˆCollectionæ˜¯consumerï¼‰ï¼Œé‚£ä¹ˆä½ æœ€å¥½æ¥å—ä¸€ä¸ªé€†å˜çš„Collectionã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">namesOfBirds</span><span class="params">(List&lt;? extends Bird&gt; birds)</span> </span>&#123;</span><br><span class="line">  birds.forEach(bird -&gt; System.out.println(bird.getName()));</span><br><span class="line">&#125;</span><br><span class="line">namesOfBird(ducks); <span class="comment">// Legal; covariant</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addAOwl</span><span class="params">(List&lt;? <span class="keyword">super</span> Bird&gt; birds)</span> </span>&#123;</span><br><span class="line">  Bird aOwl = <span class="keyword">new</span> Bird(<span class="string">"owl"</span>);</span><br><span class="line">  birds.add(aOwl);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// It is natural to add a owl into a List&lt;Animal&gt;</span></span><br><span class="line">addAOwl(animals) <span class="comment">// Legal; contravariant</span></span><br></pre></td></tr></table></figure><h2 id="function-type">Function Type</h2><p>å®¹å™¨ç±»å‹çš„å‹å˜å…¶å®æ˜¯æ¯”è¾ƒç¬¦åˆç›´è§‰çš„ï¼Œå‡½æ•°ç±»å‹å°±å¾ˆåç›´è§‰äº†ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">trait</span> <span class="title">Function1</span>[-<span class="type">T1</span>, +<span class="type">R</span>]</span></span><br></pre></td></tr></table></figure><p>è¿™æ˜¯Scalaæ ‡å‡†åº“å®šä¹‰çš„å•å‚å‡½æ•°çš„traitï¼ˆå¯ä»¥ç†è§£ä¸ºinterfaceï¼‰ï¼Œç±»å‹ä¸º<code>T1 -&gt; R</code>ï¼Œå…¶ä¸­<code>T1</code>æ˜¯é€†å˜çš„ï¼Œ<code>R</code>æ˜¯åå˜çš„<sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup>ã€‚</p><p>But whyï¼Ÿï¼Ÿï¼Ÿ</p><p>å›æƒ³ä¸€ä¸‹ï¼Œå‹å˜è§„åˆ™å†³å®šäº†æˆ‘ä»¬èƒ½ä½¿ç”¨ä»€ä¹ˆæ ·çš„å­ç±»å‹ï¼Œ<strong>å­ç±»å‹å†³å®šäº†æˆ‘ä»¬èƒ½åœ¨ä¸€ä¸ªæœŸæœ›Xçš„åœ°æ–¹ï¼Œå®‰å…¨åœ°ä½¿ç”¨å¦ä¸€ä¸ªç±»å‹Y</strong>ï¼ˆXçš„å­ç±»å‹ï¼‰ã€‚</p><p>Soï¼Œæ—¢ç„¶å‡½æ•°ç±»å‹ä¹Ÿæ˜¯ä¸€ç§ç±»å‹ï¼Œæˆ‘ä»¬å½“ç„¶ä¹Ÿè¦çŸ¥é“å‡½æ•°ç±»å‹çš„å­ç±»å‹å’¯ï¼Œå¯¹å§ï¼Ÿ</p><p>é‚£ä¹ˆå¯¹äºå‡½æ•°ç±»å‹<code>Bird -&gt; Bird</code>ï¼Œæ ¹æ®traitå®šä¹‰ï¼Œ<code>Animal -&gt; Duck</code>å°±æ˜¯å®ƒçš„å­ç±»å‹ã€‚</p><p>Weird, right?</p><p>å‡è®¾æˆ‘ä»¬æœ‰é«˜é˜¶å‡½æ•°<code>f: (Bird -&gt; Bird) -&gt; String</code>ï¼ˆè¿”å›ä»€ä¹ˆæˆ‘ä»¬å¹¶ä¸å…³å¿ƒï¼‰ã€‚</p><p>å°†ä¼ å…¥çš„å‡½æ•°è®°ä½œ<code>g</code>ï¼Œå°è¯•åœ¨<code>g</code>çš„å‚æ•°ä¸Šç”¨å­ï¼ˆè¶…ï¼‰ç±»å‹è¿›è¡Œæ›¿ä»£:</p><p><strong>1. å¦‚æœ<code>g: Duck -&gt; Bird</code>ï¼Œ<code>f(g)</code>ä¼šæ€æ ·ï¼Ÿ</strong></p><p><code>f</code>å·²çŸ¥<code>g</code>æ¥å—<code>Bird</code>ï¼Œäºæ˜¯<code>f</code>è°ƒç”¨<code>g</code>çš„æ—¶å€™ï¼Œä¼ ç»™<code>g</code>ä¸€ä¸ª<code>Bird</code>ã€‚</p><p>ç„¶è€Œï¼Œ<code>g</code>åªèƒ½å¤„ç†<code>Bird</code>çš„ä¸€ä¸ªå­ç±»å‹<code>Duck</code>ï¼Œå¦‚æœæ¥æ”¶åˆ°ä¸€ä¸ª<code>Swan</code>ï¼Œ<code>g</code>ä¼šå´©æºƒã€‚</p><p>æ‰€ä»¥å‚æ•°ç±»å‹ä¸å¯ä»¥ç”¨å­ç±»å‹æ›¿ä»£ã€‚</p><p><strong>2. å¦‚æœ<code>g: Bird -&gt; Animal</code>ï¼Œ<code>f(g)</code>ä¼šæ€æ ·ï¼Ÿ</strong></p><p><code>f</code>å·²çŸ¥<code>g</code>è¿”å›<code>Bird</code>ï¼Œäºæ˜¯<code>f</code>ä¼šå°†<code>g</code>çš„è¿”å›å€¼å½“ä½œ<code>Bird</code>æ¥ä½¿ç”¨ã€‚</p><p>ä½†æ˜¯ç°åœ¨<code>g</code>ä¼šè¿”å›ä¸€ä¸ªä¸æ˜¯<code>Bird</code>çš„<code>Animal</code>ï¼Œæ¯”å¦‚<code>Dog</code>ï¼Œé‚£ä¹ˆ<code>f</code>ä¼šå´©æºƒã€‚</p><p>æ‰€ä»¥è¿”å›ç±»å‹ä¸å¯ä»¥ç”¨è¶…ç±»å‹æ›¿ä»£ã€‚</p><p><strong>3. å¦‚æœ<code>g: Animal -&gt; Duck</code>ï¼Œ<code>f(g)</code>åˆå¦‚ä½•å‘¢ï¼Ÿ</strong></p><p><code>f</code>å·²çŸ¥<code>g</code>æ¥æ”¶<code>Bird</code>ï¼Œæ‰€ä»¥ä¼ ç»™<code>g</code>ä¸€ä¸ª<code>Bird</code>ï¼Œ<code>g</code>å¯ä»¥æ­£å¸¸å¤„ç†<code>Bird</code>å¹¶è¿”å›<code>Duck</code>ï¼Œæ²¡æœ‰é—®é¢˜ã€‚</p><p><code>f</code>å·²çŸ¥<code>g</code>è¿”å›<code>Bird</code>ï¼Œæ‰€ä»¥å°†<code>g</code>è¿”å›çš„<code>Duck</code>å½“ä½œ<code>Bird</code>æ¥ç”¨ï¼Œæ‰€æœ‰<code>Duck</code>éƒ½æ˜¯<code>Bird</code>ï¼Œä¹Ÿæ²¡é—®é¢˜ã€‚</p><p>æ‰€ä»¥ï¼Œåœ¨ä¸€ä¸ªæœŸæœ›<code>(Bird -&gt; Bird)</code>çš„åœ°æ–¹ï¼Œæˆ‘ä»¬æ€»æ˜¯å¯ä»¥ä½¿ç”¨<code>(Animal -&gt; Duck)</code>ã€‚</p><p>å³<code>(Animal -&gt; Duck)</code>æ˜¯<code>(Bird -&gt; Bird)</code>çš„å­ç±»å‹ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œ<strong>å‚æ•°ç±»å‹å¯ä»¥ç”¨è¶…ç±»å‹æ›¿ä»£ï¼Œè¿”å›ç±»å‹å¯ä»¥ç”¨å­ç±»å‹æ›¿ä»£</strong>ã€‚</p><p>å½¢å¼åŒ–ä¸€ç‚¹ï¼Œå°±æ˜¯å¯¹äºå‡½æ•°ç±»å‹æ„é€ å™¨<code>-&gt;</code>ï¼Œæ¥æ”¶å‚æ•°é€†å˜ä¸”è¿”å›å‚æ•°åå˜æ—¶ï¼Œä»ç„¶å¯ä»¥ä¿è¯ç±»å‹å®‰å…¨ã€‚</p><p>æˆ–è€…è¯´ï¼š<strong>å¯¹äºå‡½æ•°på’Œqï¼Œå½“pçš„å‚æ•°æ›´generalï¼Œè¿”å›å€¼æ›´specificæ—¶ï¼Œpå¯ä»¥å®‰å…¨åœ°æ›¿ä»£q</strong>ã€‚</p><p>å…¶å®ï¼ŒJava8çš„<code>Function</code>æ¥å£çš„å‹å˜è§„åˆ™ä¹Ÿæ˜¯è¿™æ ·çš„ï¼Œ<code>compose</code>å’Œ<code>andThen</code>éƒ½æ˜¯æ¥æ”¶äº†ä¸€ä¸ª<code>Function&lt;? super V, ? extends T&gt;</code>ï¼Œæ°æ°æ­£æ˜¯<strong>å‚æ•°é€†å˜ï¼Œè¿”å›å€¼åå˜</strong>ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// see http://hg.openjdk.java.net/jdk8/jdk8/jdk/file/687fd7c7986d/src/share/classes/java/util/function/Function.java</span></span><br><span class="line"><span class="meta">@FunctionalInterface</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Function</span>&lt;<span class="title">T</span>, <span class="title">R</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">default</span> &lt;V&gt; <span class="function">Function&lt;V, R&gt; <span class="title">compose</span><span class="params">(Function&lt;? <span class="keyword">super</span> V, ? extends T&gt; before)</span> </span>&#123;</span><br><span class="line">        Objects.requireNonNull(before);</span><br><span class="line">        <span class="keyword">return</span> (V v) -&gt; apply(before.apply(v));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">default</span> &lt;V&gt; <span class="function">Function&lt;T, V&gt; <span class="title">andThen</span><span class="params">(Function&lt;? <span class="keyword">super</span> R, ? extends V&gt; after)</span> </span>&#123;</span><br><span class="line">        Objects.requireNonNull(after);</span><br><span class="line">        <span class="keyword">return</span> (T t) -&gt; after.apply(apply(t));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="references">References</h2><ol><li><a href="https://www.stephanboyer.com/post/132/what-are-covariance-and-contravariance" target="_blank" rel="noopener">What are covariance and contravariance?</a></li><li><a href="https://en.wikipedia.org/wiki/Covariance_and_contravariance_(computer_science)" target="_blank" rel="noopener">Covariance and contravariance (computer science)</a></li><li><a href="https://medium.com/@michalskoczylas/covariance-contravariance-and-a-little-bit-of-typescript-2e61f41f6f68" target="_blank" rel="noopener">Covariance, contravariance and a little bit of TypeScript</a></li><li><a href="https://briangordon.github.io/2014/09/covariance-and-contravariance.html" target="_blank" rel="noopener">Covariance and contravariance rules in Java</a></li><li><a href="https://docs.scala-lang.org/tour/variances.html" target="_blank" rel="noopener">Variances - <em>Tour of Scala</em></a></li><li><a href="https://bartoszmilewski.com/2015/02/03/functoriality/" target="_blank" rel="noopener">Functoriality - <em>Categories for Programmers</em></a></li></ol><hr class="footnotes-sep"><section class="footnotes"><ol class="footnotes-list"><li id="fn1" class="footnote-item"><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå­ç±»ï¼ˆsubclassï¼‰å’Œå­ç±»å‹ï¼ˆsubtypeï¼‰ä¸æ˜¯ä¸€å›äº‹ã€‚ <a href="#fnref1" class="footnote-backref">â†©</a></p></li><li id="fn2" class="footnote-item"><p>Scalaä¸­ï¼Œ<code>F[+A]</code>ä»£è¡¨åå˜ï¼Œ<code>F[-A]</code>ä»£è¡¨é€†å˜ï¼Œ<code>F[A]</code>ä»£è¡¨ä¸å˜ã€‚ <a href="#fnref2" class="footnote-backref">â†©</a></p></li></ol></section>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;ä¸€äº›å®šä¹‰&quot;&gt;ä¸€äº›å®šä¹‰&lt;/h2&gt;
&lt;p&gt;è€ƒè™‘ç±»å‹&lt;code&gt;A&lt;/code&gt;å’Œ&lt;code&gt;C&lt;/code&gt;ï¼Œä»¥åŠæ³›å‹æ„é€ å™¨&lt;code&gt;F&amp;lt;T&amp;gt;&lt;/code&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¦‚æœæˆ‘ä»¬åœ¨ä¸€ä¸ªéœ€è¦&lt;code&gt;A&lt;/code&gt;çš„åœ°æ–¹ï¼Œæ€»èƒ½ä½¿ç”¨&lt;code&gt;C&lt;/code&gt;ï¼Œæˆ‘ä»¬å°±å¯ä»¥è¯´&lt;code&gt;C&lt;/code&gt;æ˜¯&lt;code&gt;A&lt;/code&gt;çš„å­ç±»å‹ï¼ˆsubtypeï¼‰&lt;sup class=&quot;footnote-ref&quot;&gt;&lt;a href=&quot;#fn1&quot; id=&quot;fnref1&quot;&gt;[1]&lt;/a&gt;&lt;/sup&gt;ï¼Œè®°ä½œ&lt;code&gt;C &amp;lt;: A&lt;/code&gt;ã€‚&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¦‚æœFæ˜¯åå˜çš„ï¼ˆcovariantï¼‰ï¼Œä¸”&lt;code&gt;C &amp;lt;: A&lt;/code&gt;ï¼Œåˆ™æœ‰&lt;code&gt;F&amp;lt;C&amp;gt; &amp;lt;: F&amp;lt;A&amp;gt;&lt;/code&gt;ã€‚&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¦‚æœFæ˜¯é€†å˜çš„ï¼ˆcontravariantï¼‰ï¼Œä¸”&lt;code&gt;C &amp;lt;: A&lt;/code&gt;ï¼Œåˆ™æœ‰&lt;code&gt;F&amp;lt;A&amp;gt; &amp;lt;: F&amp;lt;C&amp;gt;&lt;/code&gt;ã€‚&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¦‚æœFæ˜¯ä¸å˜çš„ï¼ˆinvariantï¼‰ï¼Œæ— è®º&lt;code&gt;A&lt;/code&gt;ä¸&lt;code&gt;C&lt;/code&gt;æ˜¯ä»€ä¹ˆå…³ç³»ï¼Œ&lt;code&gt;F&amp;lt;C&amp;gt;&lt;/code&gt; ä¸ &lt;code&gt;F&amp;lt;A&amp;gt;&lt;/code&gt;éƒ½æ²¡æœ‰å…³ç³»ã€‚&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;collectionè§†è§’&quot;&gt;Collectionè§†è§’&lt;/h2&gt;
&lt;p&gt;å…ˆä¸¾ç”¨ä¾‹å­æ¥çœ‹çœ‹Collectionçš„å‹å˜è§„åˆ™ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Duck&lt;/code&gt;æ˜¯&lt;code&gt;Bird&lt;/code&gt;çš„å­ç±»ï¼Œ&lt;code&gt;Bird&lt;/code&gt;æ˜¯&lt;code&gt;Animal&lt;/code&gt;çš„å­ç±»ï¼Œè®°ä½œ&lt;code&gt;Duck &amp;lt;: Bird &amp;lt;: Animal&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;TypeScriptä¸­çš„&lt;code&gt;Array&lt;/code&gt;æ˜¯åå˜çš„ï¼ˆcovariantï¼‰ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight typescript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;interface&lt;/span&gt; Animal &amp;#123; name: &lt;span class=&quot;built_in&quot;&gt;String&lt;/span&gt; &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;interface&lt;/span&gt; Bird &lt;span class=&quot;keyword&quot;&gt;extends&lt;/span&gt; Animal &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// not all animals can fly&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    fly: &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; =&amp;gt;&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;String&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;interface&lt;/span&gt; Duck &lt;span class=&quot;keyword&quot;&gt;extends&lt;/span&gt; Bird &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// not all birds can swim&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    swim: &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; =&amp;gt;&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;String&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; aDog: Animal = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    name: &lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; aBird: Bird = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    name: &lt;span class=&quot;string&quot;&gt;&quot;Owl&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    fly: &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; =&amp;gt;&lt;/span&gt; name + &lt;span class=&quot;string&quot;&gt;&quot; is flying!&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; aDuck: Duck = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    name: &lt;span class=&quot;string&quot;&gt;&quot;Donald&quot;&lt;/span&gt;, &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    fly: &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; =&amp;gt;&lt;/span&gt; name + &lt;span class=&quot;string&quot;&gt;&quot; is flying!&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    swim: &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; =&amp;gt;&lt;/span&gt; name + &lt;span class=&quot;string&quot;&gt;&quot; is swiming!&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// Legal; Array is covariant, expecting an Array&amp;lt;Animal&amp;gt;, given an Array&amp;lt;Bird&amp;gt; &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; animals: &lt;span class=&quot;built_in&quot;&gt;Array&lt;/span&gt;&amp;lt;Animal&amp;gt; = [aDuck, aBird]; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// Illegal; expecting an Array&amp;lt;Bird&amp;gt;, given an Array&amp;lt;Animal&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; birds: &lt;span class=&quot;built_in&quot;&gt;Array&lt;/span&gt;&amp;lt;Bird&amp;gt; = [aDuck, aDog];&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="Programming" scheme="http://duanyifu.com/categories/Programming/"/>
    
    
      <category term="Java" scheme="http://duanyifu.com/tags/Java/"/>
    
      <category term="Functional Programming" scheme="http://duanyifu.com/tags/Functional-Programming/"/>
    
      <category term="TypeScript" scheme="http://duanyifu.com/tags/TypeScript/"/>
    
  </entry>
  
  <entry>
    <title>Monoid in Functional Programming</title>
    <link href="http://duanyifu.com/2019/07/28/monoid-in-FP/"/>
    <id>http://duanyifu.com/2019/07/28/monoid-in-FP/</id>
    <published>2019-07-28T11:31:56.000Z</published>
    <updated>2020-01-04T07:10:09.955Z</updated>
    
    <content type="html"><![CDATA[<h2 id="monoid-æ˜¯ä»€ä¹ˆï¼Ÿ">Monoid æ˜¯ä»€ä¹ˆï¼Ÿ</h2><p>æˆ‘ä»¬å…ˆçœ‹ä¸¤ç»„ä¾‹å­ï¼š</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// string concatenation</span></span><br><span class="line">concat(<span class="string">"foo"</span>,<span class="string">"bar"</span>) == <span class="string">"foobar"</span></span><br><span class="line">concat(<span class="string">""</span>, <span class="string">"latte"</span>) == concat(<span class="string">"latte"</span>, <span class="string">""</span>) == <span class="string">"latte"</span></span><br><span class="line">concat(<span class="string">"a"</span>, concat(<span class="string">"b"</span>, <span class="string">"c"</span>)) == concat(concat(<span class="string">"a"</span>, <span class="string">"b"</span>), <span class="string">"c"</span>) == <span class="string">"abc"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// integer addition</span></span><br><span class="line"><span class="number">3</span> + <span class="number">5</span> == <span class="number">8</span></span><br><span class="line"><span class="number">0</span> + <span class="number">42</span> == <span class="number">42</span> + <span class="number">0</span> == <span class="number">42</span></span><br><span class="line"><span class="number">1</span> + (<span class="number">2</span> + <span class="number">3</span>) == (<span class="number">1</span> + <span class="number">2</span>) + <span class="number">3</span> == <span class="number">6</span></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œè¿™ä¸¤ç»„æ“ä½œå…¶å®æœ‰ç€ç›¸åŒçš„æ¨¡å¼ï¼š</p><ul><li>æœ‰ä¸€ä¸ªâ€œé›¶å€¼â€ï¼Œè®°ä½œ<code>zero</code>ï¼Œä¾‹å­ä¸­åˆ†åˆ«æ˜¯<code>ç©ºä¸²</code>å’Œ<code>0</code></li><li>æœ‰ä¸€ä¸ªäºŒå…ƒæ“ä½œç¬¦ï¼Œè®°ä½œ<code>op</code>ï¼Œä¾‹å­ä¸­åˆ†åˆ«æ˜¯<code>concat</code>å’Œ<code>+</code></li><li><code>op</code>æ»¡è¶³ç»“åˆå¾‹ï¼ˆassociativityï¼‰ï¼Œå³<code>op(x, op(y, z)) == op(op(x, y), z)</code></li><li>é›¶å€¼æ˜¯å•ä½å…ƒï¼Œå³<code>op(zero, x) == op(x, zero) == x</code></li></ul><a id="more"></a><p>é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è¿™æ ·è¡¨ç¤ºmonoidï¼š</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">trait</span> <span class="title">Monoid</span>[<span class="type">A</span>] </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">op</span></span>(m: <span class="type">A</span>, n: <span class="type">A</span>): <span class="type">A</span> <span class="comment">// æ»¡è¶³ op(x, op(y, z)) == op(op(x, y), z)</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">zero</span></span>: <span class="type">A</span> <span class="comment">// æ»¡è¶³ op(zero, x) == op(x, zero) == x</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>äº‹å®ä¸Šï¼Œmonoidæ˜¯ååˆ†æ™®éçš„ï¼Œæ¯”å¦‚ï¼š</p><ol><li>ä¹˜æ³•ï¼Œå•ä½å…ƒæ˜¯1</li><li>å¸ƒå°”è¿ç®—<code>&amp;&amp;</code>ï¼Œå•ä½å…ƒæ˜¯<code>true</code></li><li>æ±‚<code>Integer</code>çš„æœ€å¤§å€¼<code>max</code>ï¼Œå•ä½å…ƒæ˜¯<code>Integer.MIN_VALUE</code></li><li><code>List</code>çš„è¿æ¥ï¼Œå•ä½å…ƒæ˜¯<code>Nilï¼ˆç©ºåˆ—è¡¨ï¼‰</code></li><li>è‡ªå‡½æ•°ï¼ˆå‚æ•°ä¸è¿”å›å€¼çš„ç±»å‹ç›¸åŒï¼Œå³ç±»å‹ä¸º<code>A =&gt; A</code>çš„å‡½æ•°ï¼‰çš„ç»„åˆ<code>compose</code>ï¼Œå•ä½å…ƒæ˜¯<code>id</code></li></ol><p>ç¬¬5ä¸ªå¹¶ä¸æ˜¯é‚£ä¹ˆæ˜¾è€Œæ˜“è§ï¼Œå®ç°å¦‚ä¸‹ï¼š</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">endoMonoid</span></span>[<span class="type">A</span>]: <span class="type">Monoid</span>[<span class="type">A</span> =&gt; <span class="type">A</span>] = <span class="keyword">new</span> <span class="type">Monoid</span>[<span class="type">A</span> =&gt; <span class="type">A</span>] &#123;</span><br><span class="line">  <span class="keyword">override</span> <span class="function"><span class="keyword">def</span> <span class="title">op</span></span>(f: <span class="type">A</span> =&gt; <span class="type">A</span>, g: <span class="type">A</span> =&gt; <span class="type">A</span>): <span class="type">A</span> =&gt; <span class="type">A</span> = </span><br><span class="line">    g compose f <span class="comment">// you can choose (g compose f) or (f compose g)</span></span><br><span class="line">  <span class="keyword">override</span> <span class="function"><span class="keyword">def</span> <span class="title">zero</span></span>: <span class="type">A</span> =&gt; <span class="type">A</span> = </span><br><span class="line">    (x =&gt; x) <span class="comment">// aka. id</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆmonoidæ˜¯ä»€ä¹ˆï¼Ÿ</p><p><strong>ä¸€ä¸ªå¯ç»“åˆçš„äºŒå…ƒæ“ä½œç¬¦å’Œä¸€ä¸ªå•ä½å…ƒå…ƒç´ ï¼Œæ„æˆä¸€ä¸ªmonoidã€‚</strong></p><h2 id="monoid-æœ‰ä»€ä¹ˆç”¨ï¼Ÿ">Monoid æœ‰ä»€ä¹ˆç”¨ï¼Ÿ</h2><p>Monoidæ˜¯ä¸€ç§æŠ½è±¡ï¼Œæˆ‘ä»¬æ€»æ˜¯å¯ä»¥é€šè¿‡æŠ½è±¡æ¥å†™å‡º<strong>æ›´åŠ é€šç”¨çš„ä»£ç </strong>ï¼šäº‹å®ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥ä¸å…³å¿ƒmonoidé‡Œçš„å…·ä½“ç±»å‹ï¼Œç›´æ¥å†™å‡ºå¯ä»¥å¯¹ä»»ä½•monoidéƒ½æœ‰æ•ˆçš„ä»£ç ã€‚</p><h3 id="è®¡ç®—çš„çµæ´»æ€§">è®¡ç®—çš„çµæ´»æ€§</h3><p>äº‹å®ä¸Šï¼Œå¯¹äºmonoidï¼Œæˆ‘ä»¬å¹¶ä¸å…³å¿ƒè®¡ç®—å‘ç”Ÿçš„é¡ºåºï¼Œç»“åˆå¾‹ä¿è¯äº†ç»“æœçš„ä¸€è‡´ï¼š</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. foldRight</span></span><br><span class="line">a + (b + (c + (d + (e + (f + (g + h))))))</span><br><span class="line"><span class="comment">// 2. foldLeft</span></span><br><span class="line">((((((a + b) + c) + d) + e) + f) + g) + h</span><br><span class="line"><span class="comment">// 3. run in parallel</span></span><br><span class="line">(a + b + c) + (d + e + f) + (g + h + <span class="number">0</span>)</span><br><span class="line"><span class="comment">// 4. fold like a binary tree</span></span><br><span class="line">((a + b) + (c + d)) + ((e + f) + (g + h))</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥ç”¨ä»»ä½•é¡ºåºè¿›è¡Œè®¡ç®—ï¼Œç”šè‡³ç›´æ¥å°†æ¯ä¸ªä»»åŠ¡åˆ†æ´¾ç»™ä¸åŒèŠ‚ç‚¹å¼€å§‹å¹¶è¡Œè®¡ç®—ï¼</p><h3 id="listçš„æŠ˜å ">Listçš„æŠ˜å </h3><p>ä»”ç»†è§‚å¯Ÿï¼Œä½ ä¼šå‘ç°å½“æˆ‘ä»¬å¯¹ä¸€ä¸ª<code>List</code>è¿›è¡Œ<code>fold</code>æ“ä½œï¼ˆaka <code>reduce</code> in JavaScript/Pythonï¼‰æ—¶ï¼Œä¼ ç»™foldçš„æ“ä½œï¼Œæ°å¥½æ˜¯monoidçš„<code>op</code>å’Œ<code>zero</code>ï¼š</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">List</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>).foldLeft(<span class="number">0</span>)((x, y) =&gt; x + y) == </span><br><span class="line"><span class="type">List</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>).foldLeft(intAddtion.zero)(intAddtion.op)</span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> intAddtionMonoid: <span class="type">Monoid</span>[<span class="type">Int</span>] = <span class="keyword">new</span> <span class="type">Monoid</span>[<span class="type">Int</span>] &#123;</span><br><span class="line">  <span class="keyword">override</span> <span class="function"><span class="keyword">def</span> <span class="title">op</span></span>(x: <span class="type">Int</span>, y: <span class="type">Int</span>): <span class="type">Int</span> = x + y</span><br><span class="line">  <span class="keyword">override</span> <span class="keyword">val</span> zero: <span class="type">Int</span> = <span class="number">0</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥å¯ä»¥å†™ä¸€ä¸ªæ›´åŠ é€šç”¨çš„å‡½æ•°ï¼Œæ¥æ”¶ä¸€ä¸ª<code>List[A]</code>å’Œä¸€ä¸ª<code>Monoid[A]</code>ï¼Œå¹¶ç”¨è¿™ä¸ªmonoidå»æŠ˜å ï¼š</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">concatenate</span></span>[<span class="type">A</span>](as: <span class="type">List</span>[<span class="type">A</span>], m: <span class="type">Monoid</span>[<span class="type">A</span>]): <span class="type">A</span> = </span><br><span class="line">  as.foldLeft(m.zero)(m.op)</span><br></pre></td></tr></table></figure><p>ç”šè‡³å¯ä»¥å°†<code>List[A]</code> map æˆ<code>List[B]</code>ï¼š</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foldMap</span></span>[<span class="type">A</span>, <span class="type">B</span>](as: <span class="type">List</span>[<span class="type">A</span>], m: <span class="type">Monoid</span>[<span class="type">B</span>])(f: <span class="type">A</span> =&gt; <span class="type">B</span>): <span class="type">B</span> = </span><br><span class="line">  as.foldLeft(m.zero)(b =&gt; a =&gt; m.op(b, f(a)))</span><br></pre></td></tr></table></figure><h3 id="é€šç”¨æŠ˜å ">é€šç”¨æŠ˜å </h3><p>äº‹å®ä¸Šï¼Œå¯¹äºæ‰€æœ‰çš„å¯æŠ˜å æ•°æ®ç»“æ„ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥å¿½ç•¥å…¶å…·ä½“ç»“æ„ï¼Œç›´æ¥ç”¨monoidè¿›è¡ŒæŠ˜å ã€‚</p><p>æ¯”å¦‚ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªå­˜æ”¾äº†<code>Int</code>çš„å¯æŠ˜å ç»“æ„ï¼Œè®¡ç®—å…¶æ€»å’Œï¼š</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ints.foldRight(intAddtionMonoid.zero)(intAddtionMonoid.op)</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¹¶ä¸å…³å¿ƒï¼Œè¿™ä¸ªintsï¼Œç©¶ç«Ÿæ˜¯<code>List</code>è¿˜æ˜¯<code>Array</code>è¿˜æ˜¯<code>Vector</code>ï¼Œç”šè‡³å¯èƒ½æ˜¯<code>Tree</code>æˆ–è€…<code>Stream</code>ï¼</p><p>å¯¹äºè¿™äº›ç»“æ„ï¼Œæˆ‘ä»¬ç»™å®ƒèµ·ä¸ªåå­—ï¼Œå«åš<code>Foldable</code>ï¼Œæˆ‘ä»¬å¯ä»¥æŠ½è±¡æˆè¿™æ ·ï¼š</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">trait</span> <span class="title">Foldable</span>[<span class="type">F</span>[_]] </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">foldRight</span></span>[<span class="type">A</span>, <span class="type">B</span>](as: <span class="type">F</span>[<span class="type">A</span>])(z: <span class="type">B</span>)(f: (<span class="type">A</span>, <span class="type">B</span>) =&gt; <span class="type">B</span>): <span class="type">B</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">foldLeft</span></span>[<span class="type">A</span>, <span class="type">B</span>](as: <span class="type">F</span>[<span class="type">A</span>])(z: <span class="type">B</span>)(f: (<span class="type">B</span>, <span class="type">A</span>) =&gt; <span class="type">B</span>): <span class="type">B</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">foldMap</span></span>[<span class="type">A</span>, <span class="type">B</span>](as: <span class="type">F</span>[<span class="type">A</span>])(f: <span class="type">A</span> =&gt; <span class="type">B</span>)(mb: <span class="type">Monoid</span>[<span class="type">B</span>]): <span class="type">B</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">concatenate</span></span>[<span class="type">A</span>](as: <span class="type">F</span>[<span class="type">A</span>])(m: <span class="type">Monoid</span>[<span class="type">A</span>]): <span class="type">A</span> = </span><br><span class="line">    foldLeft(as)(m.zero)(m.op)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>PSï¼š<code>F[_]</code>ä»£è¡¨ä¸€ä¸ªFæ˜¯ä¸€ä¸ªç±»å‹æ„é€ å™¨ï¼Œæ¥æ”¶ä¸€ä¸ªç±»å‹å‚æ•°ã€‚æ¯”å¦‚ï¼Œ<code>F[A]</code>å¯ä»¥å…·è±¡æˆ<code>List[Int]</code>ï¼Œ<code>Stream[String]</code>ç­‰ç­‰ã€‚</p><h3 id="monoidçš„ç»„åˆ">Monoidçš„ç»„åˆ</h3><p><strong>è‹¥ç±»å‹<code>A</code>å’Œ<code>B</code>æ˜¯monoidï¼Œé‚£ä¹ˆtupleç±»å‹<code>(A, B)</code>åŒæ ·ä¹Ÿæ˜¯monoidã€‚</strong></p><p>æˆ‘ä»¬åªéœ€è¦å°†Aå’ŒBçš„<code>op</code>å’Œ<code>zero</code>ç»„åˆæˆ<code>tuple</code>å°±å¯ä»¥äº†ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// am: Monoid[A], bm: Monoid[B]</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">tupleMonoid</span></span>[<span class="type">A</span>, <span class="type">B</span>]: <span class="type">Monoid</span>[(<span class="type">A</span>, <span class="type">B</span>)] = <span class="keyword">new</span> <span class="type">Monoid</span>[(<span class="type">A</span>, <span class="type">B</span>)] &#123;</span><br><span class="line">  <span class="keyword">override</span> <span class="function"><span class="keyword">def</span> <span class="title">op</span></span>(t1: (<span class="type">A</span>, <span class="type">B</span>), t2: (<span class="type">A</span>, <span class="type">B</span>)): (<span class="type">A</span>, <span class="type">B</span>) = (t1, t2) <span class="keyword">match</span> &#123;</span><br><span class="line">    <span class="keyword">case</span> ((a1, b1), (a2, b2)) =&gt; (am.op(a1, a2), bm.op(b1, b2))</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">override</span> <span class="keyword">val</span> zero: (<span class="type">A</span>, <span class="type">B</span>) = (am.zero, bm.zero)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ä¸€äº›monoidçš„ä¾‹å­">ä¸€äº›Monoidçš„ä¾‹å­</h2><blockquote><p>There are monoids for all the following:<br>Â· approximate sets such as the Bloom filter;<br>Â· set cardinality estimators, such as the HyperLogLog algorithm;<br>Â· vectors and vector operations like stochastic gradient descent;<br>Â· quantile estimators such as the t-digest<br>to name but a few.</p><p>â€“ <em>Chapter 9, Scala with Cats</em></p></blockquote><h2 id="é—²è°ˆ">é—²è°ˆ</h2><ul><li>Monoidå¯ä»¥ç®—ä½œFPä¸­æœ€ç®€å•çš„çº¯ä»£æ•°ï¼ˆpurely algebraicï¼‰ç»“æ„ã€‚</li><li>è¿™ç§æŠ½è±¡çš„æ„ä¹‰åœ¨äºâ€”â€”å’Œç¼–ç¨‹ä¸­çš„ä»»ä½•æŠ½è±¡ä¸€æ ·â€”â€”<strong>æ¶ˆé™¤é‡å¤ä»£ç </strong>ï¼šæŠ½å‡ºé€šç”¨çš„ç»“æ„ï¼Œè¡¨è¾¾ä¸ºæŠ½è±¡çš„ç±»å‹å’Œæ¥å£ï¼Œä»è€Œæ¶ˆé™¤é‡å¤ã€‚å¦å¤–ï¼Œè¿™ç§æŠ½è±¡è¿˜èƒ½é™ä½æ²Ÿé€šæˆæœ¬ã€‚</li><li>Monoidä¸­æ–‡åç§°å«åšå¹ºåŠç¾¤ï¼Œååˆ†æ‹—å£ï¼Œæ‰€ä»¥å…¨æ–‡éƒ½æ²¡æœ‰å‡ºç°è¿™ä¸ªåå­—ã€‚</li><li>Monoidåç§°å‡ºè‡ªäºæŠ½è±¡ä»£æ•°ï¼Œæˆ‘ä»¬ä¹Ÿå®Œå…¨å¯ä»¥å«ä½œAssociateWithIdentityï¼Œå¯¹æˆ‘ä»¬ç¼–ç¨‹ä¹Ÿæ˜¯æ¯«æ— å½±å“çš„ã€‚</li></ul><h2 id="references">References</h2><ol><li><p><a href="https://deque.blog/2017/09/13/monoids-what-they-are-why-they-are-useful-and-what-they-teach-us-about-software/" target="_blank" rel="noopener">What monoids teach us about software</a></p></li><li><p><a href="http://comonad.com/reader/wp-content/uploads/2009/07/AllAboutMonoids.pdf" target="_blank" rel="noopener">All about monoids</a></p></li><li><p><a href="https://bartoszmilewski.com/2014/12/05/categories-great-and-small/" target="_blank" rel="noopener">Categories Great and Small</a></p></li><li><p>Chapter 10 of <a href="https://www.manning.com/books/functional-programming-in-scala" target="_blank" rel="noopener">Functional Programming in Scala</a></p></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;monoid-æ˜¯ä»€ä¹ˆï¼Ÿ&quot;&gt;Monoid æ˜¯ä»€ä¹ˆï¼Ÿ&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬å…ˆçœ‹ä¸¤ç»„ä¾‹å­ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight scala&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// string concatenation&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;concat(&lt;span class=&quot;string&quot;&gt;&quot;foo&quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&quot;bar&quot;&lt;/span&gt;) == &lt;span class=&quot;string&quot;&gt;&quot;foobar&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;concat(&lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;latte&quot;&lt;/span&gt;) == concat(&lt;span class=&quot;string&quot;&gt;&quot;latte&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;) == &lt;span class=&quot;string&quot;&gt;&quot;latte&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;concat(&lt;span class=&quot;string&quot;&gt;&quot;a&quot;&lt;/span&gt;, concat(&lt;span class=&quot;string&quot;&gt;&quot;b&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;c&quot;&lt;/span&gt;)) == concat(concat(&lt;span class=&quot;string&quot;&gt;&quot;a&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;b&quot;&lt;/span&gt;), &lt;span class=&quot;string&quot;&gt;&quot;c&quot;&lt;/span&gt;) == &lt;span class=&quot;string&quot;&gt;&quot;abc&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// integer addition&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt; + &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt; == &lt;span class=&quot;number&quot;&gt;8&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; + &lt;span class=&quot;number&quot;&gt;42&lt;/span&gt; == &lt;span class=&quot;number&quot;&gt;42&lt;/span&gt; + &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; == &lt;span class=&quot;number&quot;&gt;42&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; + (&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; + &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;) == (&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; + &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;) + &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt; == &lt;span class=&quot;number&quot;&gt;6&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œè¿™ä¸¤ç»„æ“ä½œå…¶å®æœ‰ç€ç›¸åŒçš„æ¨¡å¼ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æœ‰ä¸€ä¸ªâ€œé›¶å€¼â€ï¼Œè®°ä½œ&lt;code&gt;zero&lt;/code&gt;ï¼Œä¾‹å­ä¸­åˆ†åˆ«æ˜¯&lt;code&gt;ç©ºä¸²&lt;/code&gt;å’Œ&lt;code&gt;0&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;æœ‰ä¸€ä¸ªäºŒå…ƒæ“ä½œç¬¦ï¼Œè®°ä½œ&lt;code&gt;op&lt;/code&gt;ï¼Œä¾‹å­ä¸­åˆ†åˆ«æ˜¯&lt;code&gt;concat&lt;/code&gt;å’Œ&lt;code&gt;+&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;op&lt;/code&gt;æ»¡è¶³ç»“åˆå¾‹ï¼ˆassociativityï¼‰ï¼Œå³&lt;code&gt;op(x, op(y, z)) == op(op(x, y), z)&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;é›¶å€¼æ˜¯å•ä½å…ƒï¼Œå³&lt;code&gt;op(zero, x) == op(x, zero) == x&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="Programming" scheme="http://duanyifu.com/categories/Programming/"/>
    
    
      <category term="Scala" scheme="http://duanyifu.com/tags/Scala/"/>
    
      <category term="Functional Programming" scheme="http://duanyifu.com/tags/Functional-Programming/"/>
    
      <category term="Monoid" scheme="http://duanyifu.com/tags/Monoid/"/>
    
  </entry>
  
  <entry>
    <title>Yet Another a Introduction to Y Combinator in Scheme</title>
    <link href="http://duanyifu.com/2017/05/02/ycombinator-in-scheme/"/>
    <id>http://duanyifu.com/2017/05/02/ycombinator-in-scheme/</id>
    <published>2017-05-02T07:31:56.000Z</published>
    <updated>2019-07-28T14:08:22.075Z</updated>
    
    <content type="html"><![CDATA[<h3 id="å‰è¨€">å‰è¨€</h3><p>åœ¨Lambdaæ¼”ç®—ä¸­ï¼Œå‡½æ•°æ˜¯æ²¡æœ‰åå­—çš„ï¼ˆéƒ½æ˜¯åŒ¿åå‡½æ•°ï¼‰ï¼Œé‚£ä¹ˆå¦‚æœå‡½æ•°æ²¡æœ‰åå­—ï¼Œä¹Ÿå°±æ— æ³•åœ¨å‡½æ•°ä½“å†…æ˜¾å¼åœ°è°ƒç”¨è‡ªèº«ï¼Œä¹Ÿå°±æ— æ³•å®šä¹‰é€’å½’å‡½æ•°ï¼ŒY combinatorå°±æ˜¯ç”¨æ¥è§£å†³è¿™ä¸ªé—®é¢˜çš„ã€‚<br>è¿™ç¯‡æ–‡ç« æƒ³æŠ›å¼€é‚£äº›æ•°å­¦æ¦‚å¿µï¼Œç”¨ç¨‹åºè¯­è¨€ï¼ˆSchemeï¼‰çš„å½¢å¼æ¥è®²è§£æˆ‘ä»¬æ˜¯å¦‚ä½•æ¨å¯¼å‡ºY combinatorçš„ã€‚</p><p>è¿è¡Œç¯å¢ƒï¼š<br>IDEï¼š<a href="https://racket-lang.org/" target="_blank" rel="noopener">DrRacket</a></p><a id="more"></a><h3 id="ä»€ä¹ˆæ˜¯é€’å½’å‡½æ•°ï¼Ÿ">ä»€ä¹ˆæ˜¯é€’å½’å‡½æ•°ï¼Ÿ</h3><p>æˆ‘ä»¬ä»¥é€’å½’å‡½æ•°<code>length</code>ä¸ºä¾‹ï¼Œ<code>length</code>å‡½æ•°æ¥å—ä¸€ä¸ªlistï¼Œè¿”å›listçš„å…ƒç´ æ•°ç›®ã€‚</p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">define</span></span> length</span><br><span class="line">  (<span class="name"><span class="builtin-name">lambda</span></span> (lst)</span><br><span class="line">    (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">null?</span></span> lst)</span><br><span class="line">        <span class="number">0</span></span><br><span class="line">        (<span class="name">add1</span> (<span class="name"><span class="builtin-name">length</span></span> (<span class="name">rest</span> lst))))))</span><br></pre></td></tr></table></figure><p><strong>è‹¥ä½ ç†Ÿæ‚‰Schemeå‡½æ•°å®šä¹‰ï¼Œå¯ä»¥è·³è¿‡æœ¬å°ç»“åé¢éƒ¨åˆ†ã€‚</strong></p><p><code>(define length</code>ï¼Œ<code>define</code>è¡¨è¾¾å¼å°†ä¸€ä¸ªè¡¨è¾¾å¼ï¼ˆè¡¨è¾¾å¼å³å¯èƒ½æ˜¯å‡½æ•°ä¹Ÿå¯èƒ½æ˜¯å€¼ï¼Œåœ¨Schemeä¸­å¹¶ä¸åŒºåˆ†è¿™ä¸¤ç‚¹ï¼‰ç»‘å®šè‡³ä¸€ä¸ªåå­—ï¼Œå½¢å¼å¦‚åŒ<code>(define name func)</code>ï¼Œä¹‹åä¾¿å¯ä»¥ä½¿ç”¨<code>name</code>è°ƒç”¨<code>func</code>è¿™ä¸ªå‡½æ•°ã€‚åœ¨æœ¬å®šä¹‰ä¸­ï¼Œ<code>func</code>æ˜¯åé¢æ•´ä¸ªç”¨æ‹¬å·åŒ…å›´çš„<code>lambda</code>è¡¨è¾¾å¼ï¼Œä¹Ÿå°±æ˜¯2-4è¡Œã€‚<br><code>(lambda args body)</code>ï¼Œ<code>lambda</code>è¡¨è¾¾å¼å®šä¹‰äº†ä¸€ä¸ªåŒ¿åå‡½æ•°ï¼Œè¡¨è¾¾å¼ä¸­ç¬¬äºŒä¸ªå…ƒç´ æ˜¯å‚æ•°åˆ—è¡¨ï¼Œç¬¬ä¸‰ä¸ªå…ƒç´ æ˜¯å‡½æ•°ä½“ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸ªåŒ¿åå‡½æ•°æ¥å—ä¸€ä¸ªå‚æ•°<code>lst</code>ï¼Œç„¶åå¯¹å‡½æ•°ä½“è¿›è¡Œæ±‚å€¼ã€‚<br><code>(if condition then else)</code>,<code>if</code>è¡¨è¾¾å¼ï¼Œè‹¥<code>condition</code>ä¸ºçœŸï¼Œåˆ™æ±‚å€¼<code>then</code>ï¼Œè‹¥<code>condition</code>ä¸ºå‡ï¼Œåˆ™æ±‚å€¼<code>else</code>ã€‚<br><code>null?</code>æ¥å—ä¸€ä¸ªlistï¼Œåˆ¤æ–­æ˜¯å¦ä¸ºç©ºã€‚<br><code>add1</code>æ¥å—ä¸€ä¸ªå€¼ï¼Œå°†å…¶åŠ 1åè¿”å›ï¼Œå®šä¹‰å¦‚ä¸‹ï¼š</p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">define</span></span> add1</span><br><span class="line">  (<span class="name"><span class="builtin-name">lambda</span></span> (n)</span><br><span class="line">    (<span class="name"><span class="builtin-name">+</span></span> <span class="number">1</span> n)))</span><br><span class="line"></span><br><span class="line">&gt; (add1 3)</span><br><span class="line"><span class="number">4</span></span><br></pre></td></tr></table></figure><p><code>rest</code>è¿”å›<code>lst</code>å»æ‰ç¬¬ä¸€ä¸ªå…ƒç´ çš„å‰©ä½™éƒ¨åˆ†ï¼Œå…¶å®å°±æ˜¯<code>(define rest cdr)</code>ã€‚<br>ä¹Ÿå°±æ˜¯è¯´ï¼Œ<code>length</code>å‡½æ•°æ¥å—ä¸€ä¸ªlistï¼Œè‹¥listä¸ºç©ºï¼Œåˆ™è¿”å›<code>0</code>ï¼Œè‹¥listéç©ºï¼Œåˆ™æ±‚å»æ‰ç¬¬ä¸€ä¸ªå…ƒç´ çš„listé•¿åº¦ï¼Œå¹¶å°†å…¶åŠ ä¸€ã€‚æ±‚å€¼è¿‡ç¨‹å¦‚ä¸‹ï¼š</p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">length</span></span> `(<span class="number">1</span> <span class="number">2</span>)) <span class="comment">; `(1 2) is a list has two elements</span></span><br><span class="line">(<span class="name">add1</span> (<span class="name"><span class="builtin-name">length</span></span> `(<span class="number">2</span>))) <span class="comment">; `(2) is (rest `(1 2))</span></span><br><span class="line">(<span class="name">add1</span> (<span class="name">add1</span> (<span class="name"><span class="builtin-name">length</span></span> `()))) <span class="comment">; `() is empty list</span></span><br><span class="line">(<span class="name">add1</span> (<span class="name">add1</span> <span class="number">0</span>))</span><br><span class="line">(<span class="name">add1</span> <span class="number">1</span>)</span><br><span class="line"><span class="number">2</span></span><br></pre></td></tr></table></figure><h3 id="å‡å¦‚lengthæ²¡æœ‰åå­—ï¼Ÿ">å‡å¦‚lengthæ²¡æœ‰åå­—ï¼Ÿ</h3><p>å¦‚æœæˆ‘ä»¬å»æ‰<code>define</code>ï¼Œæ‹¿å‡ºå…¶ä¸­çš„å‡½æ•°å®šä¹‰ï¼Œæ˜¯è¿™æ ·ã€‚</p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">lambda</span></span> (lst)</span><br><span class="line">    (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">null?</span></span> lst)</span><br><span class="line">        <span class="number">0</span></span><br><span class="line">        (<span class="name">add1</span> (<span class="name"><span class="builtin-name">length</span></span> (<span class="name">rest</span> lst))))) <span class="comment">; length is undefined</span></span><br></pre></td></tr></table></figure><p>**WAITï¼ï¼**æ—¢ç„¶ç°åœ¨æ²¡æœ‰äº†<code>length</code>,æ˜¾ç„¶æˆ‘ä»¬ä¹Ÿæ— æ³•åœ¨å‡½æ•°ä½“å†…è°ƒç”¨<code>length</code>äº†ã€‚<br>é‚£ä¹ˆæˆ‘ä»¬åº”è¯¥æŠŠ<code>length</code>æ¢æˆä»€ä¹ˆå‘¢ï¼Ÿ<br>æˆ‘ä¹Ÿä¸çŸ¥é“ã€‚<br>é‚£ä¹ˆæˆ‘ä»¬å…ˆè¯•ä¸€è¯•æ¢æˆåˆ«çš„å§ã€‚<br>å‡è®¾æˆ‘ä»¬ç°åœ¨æœ‰ä¸€ä¸ªå‡½æ•°<code>id</code>,è¿™ä¸ªå‡½æ•°ä»€ä¹ˆéƒ½ä¸åšï¼Œåªæ¥å—ä¸€ä¸ªå‚æ•°å¹¶å°†å…¶è¿”å›ï¼Œå®šä¹‰å¦‚ä¸‹ã€‚</p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">define</span></span> id</span><br><span class="line">  (<span class="name"><span class="builtin-name">lambda</span></span> (x) x))</span><br><span class="line"></span><br><span class="line">&gt; (id 1)</span><br><span class="line"><span class="number">1</span></span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆï¼Œæˆ‘ä»¬æŠŠ<code>id</code>ä¸¢è¿›<code>length</code>å®šä¹‰é‡Œé¢è¯•è¯•ï¼š</p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">; length0</span></span><br><span class="line">(<span class="name"><span class="builtin-name">lambda</span></span> (lst)</span><br><span class="line">    (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">null?</span></span> lst)</span><br><span class="line">        <span class="number">0</span></span><br><span class="line">        (<span class="name">add1</span> (<span class="name">id</span> (<span class="name">rest</span> lst)))))</span><br></pre></td></tr></table></figure><p>çœ‹ä¸Šå»æ˜¯ä¸ªå¥‡æ€ªçš„å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°èƒ½å·¥ä½œå—ï¼Ÿ<br>æˆ‘ä»¬å¯ä»¥è¯•ä¸€è¯•ã€‚</p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt; ((lambda (lst)</span><br><span class="line">   (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">null?</span></span> lst)</span><br><span class="line">       <span class="number">0</span></span><br><span class="line">       (add1 (id (rest lst)))))</span><br><span class="line"> `())</span><br><span class="line"></span><br><span class="line"><span class="number">0</span></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å–‚ç»™è¿™ä¸ªå¥‡æ€ªçš„å‡½æ•°ä¸€ä¸ªç©ºlistï¼Œå®ƒå±…ç„¶èƒ½è¿”å›æ­£ç¡®çš„å€¼ï¼<br>å…·ä½“åŸå› ï¼Œè¯·è¯»è€…å…ˆè‡ªå·±æ€è€ƒä¸€ä¸‹ï¼ˆç¬‘<br>ã€‚<br>ã€‚<br>ã€‚<br>å¾ˆç®€å•ï¼Œå› ä¸º<code>(null? lst)</code>ä¸ºçœŸï¼Œæ‰€ä»¥<code>if</code>è¡¨è¾¾å¼ç›´æ¥è¿”å›äº†<code>0</code>ï¼Œå‹æ ¹æ²¡æœ‰å¯¹<code>(add1 (id (rest lst)))</code>è¿›è¡Œæ±‚å€¼ã€‚<br>é‚£ä¹ˆæˆ‘ä»¬å¦‚æœå–‚<code>(apple)</code>å‘¢ï¼Œæ˜¾ç„¶è¿™ä¸ªå¥‡æ€ªçš„å‡½æ•°å¹¶ä¸èƒ½è¿”å›æ­£ç¡®çš„é•¿åº¦ï¼Œå› ä¸º<code>(id (rest lst))</code>æ— æ³•ç»™å‡ºâ€œå»æ‰ç¬¬ä¸€ä¸ªå€¼çš„listçš„é•¿åº¦â€ã€‚<br>æ€»ç»“ä¸€ä¸‹ï¼Œè¿™ä¸ªå¥‡æ€ªçš„å‡½æ•°ï¼š</p><ul><li>è‹¥listé•¿åº¦ä¸º0ï¼Œå¯ä»¥æ­£å¸¸å·¥ä½œ</li><li>è‹¥listé•¿åº¦å¤§äº0ï¼Œæ— æ³•å·¥ä½œ</li></ul><p>é‚£ä¹ˆï¼Œæˆ‘ä»¬å°†è¿™ä¸ªå‡½æ•°å«åš<code>length0</code>,ä»£è¡¨å®ƒå¯¹é•¿åº¦ä¸º0åŠ0ä»¥ä¸‹ï¼ˆå¹¶ä¸å­˜åœ¨ï¼‰çš„listå¯ä»¥æ­£å¸¸å·¥ä½œã€‚</p><h3 id="length1-length2-and">length1, length2, and â€¦</h3><p>å¥½äº†ï¼Œæˆ‘ä»¬ç°åœ¨æœ‰ä¸€ä¸ª<code>length0</code>ï¼Œå¯ä»¥æ±‚å‡ºç©ºè¡¨çš„é•¿åº¦ã€‚<br>é‚£ä¹ˆä¸‹é¢è¿™ä¸ªå‡½æ•°æœ‰ä»€ä¹ˆä½œç”¨å‘¢ï¼Ÿ</p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">; length1</span></span><br><span class="line">(<span class="name"><span class="builtin-name">lambda</span></span> (lst)</span><br><span class="line">    (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">null?</span></span> lst)</span><br><span class="line">        <span class="number">0</span></span><br><span class="line">        (<span class="name">add1</span> (<span class="name">length0</span> (<span class="name">rest</span> lst)))))</span><br></pre></td></tr></table></figure><p>ç”±äº<code>(length0 (rest lst))</code>æ˜¯å¯ä»¥æ­£ç¡®è®¡ç®—çš„ï¼Œæ‰€ä»¥ä¸Šé¢è¿™ä¸ªå‡½æ•°ï¼Œå¯ä»¥è®¡ç®—é•¿åº¦å°äºç­‰äº1çš„listçš„é•¿åº¦ã€‚<br>ä½ å¯èƒ½ä¼šé—®ï¼Œä½†æ˜¯æˆ‘ä»¬æ²¡æœ‰<code>length0</code>è¿™ä¸ªåå­—å‘€ï¼Ÿ<br>æ²¡å…³ç³»ï¼Œæˆ‘ä»¬å°†<code>length0</code>ä»£æ¢æˆä¸Šä¸€å°ç»“çš„åŒ¿åå‡½æ•°å½¢å¼ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">; length1</span></span><br><span class="line">(<span class="name"><span class="builtin-name">lambda</span></span> (lst)</span><br><span class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">null?</span></span> lst)</span><br><span class="line">      <span class="number">0</span></span><br><span class="line">      (<span class="name">add1</span> ((<span class="name"><span class="builtin-name">lambda</span></span> (lst)</span><br><span class="line">               (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">null?</span></span> lst)</span><br><span class="line">                   <span class="number">0</span></span><br><span class="line">                   (<span class="name">add1</span> (<span class="name">id</span> (<span class="name">rest</span> lst)))))</span><br><span class="line">             (<span class="name">rest</span> lst)))))</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆè¿™ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬å°±å¯ä»¥æŠŠå®ƒå«ä½œ<code>length1</code>äº†ï¼Œå› ä¸ºå®ƒå¯ä»¥æ­£ç¡®æ±‚å‡ºé•¿åº¦å°äºç­‰äº1çš„listçš„é•¿åº¦ï¼<br>é‚£ä¹ˆï¼Œ<code>length2</code>å°±å†æ¥ä¸€æ¬¡å•¦ï¼ŒæŠŠ<code>length1</code>ä¸¢è¿›é‚£ä¸ªå®šä¹‰ï¼Œä¹Ÿä¸éœ€è¦æ˜¾å¼ä½¿ç”¨<code>length2</code>å•¦ï¼</p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">; length2</span></span><br><span class="line">(<span class="name"><span class="builtin-name">lambda</span></span> (lst)</span><br><span class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">null?</span></span> lst)</span><br><span class="line">      <span class="number">0</span></span><br><span class="line">      (<span class="name">add1</span> ((<span class="name"><span class="builtin-name">lambda</span></span> (lst)</span><br><span class="line">               (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">null?</span></span> lst)</span><br><span class="line">                   <span class="number">0</span></span><br><span class="line">                   (<span class="name">add1</span> ((<span class="name"><span class="builtin-name">lambda</span></span> (lst)</span><br><span class="line">                            (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">null?</span></span> lst)</span><br><span class="line">                                <span class="number">0</span></span><br><span class="line">                                (<span class="name">add1</span> (<span class="name">id</span> (<span class="name">rest</span> lst)))))</span><br><span class="line">                          (<span class="name">rest</span> lst)))))</span><br><span class="line">             (<span class="name">rest</span> lst)))))</span><br></pre></td></tr></table></figure><p>è¯•ä¸€è¯•<code>length2</code>ï¼</p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&gt; ((lambda (lst)</span><br><span class="line">   (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">null?</span></span> lst)</span><br><span class="line">       <span class="number">0</span></span><br><span class="line">       (<span class="name">add1</span> ((<span class="name"><span class="builtin-name">lambda</span></span> (lst)</span><br><span class="line">                (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">null?</span></span> lst)</span><br><span class="line">                    <span class="number">0</span></span><br><span class="line">                    (<span class="name">add1</span> ((<span class="name"><span class="builtin-name">lambda</span></span> (lst)</span><br><span class="line">                             (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">null?</span></span> lst)</span><br><span class="line">                                 <span class="number">0</span></span><br><span class="line">                                 (<span class="name">add1</span> (<span class="name">id</span> (<span class="name">rest</span> lst)))))</span><br><span class="line">                           (<span class="name">rest</span> lst)))))</span><br><span class="line">              (rest lst)))))</span><br><span class="line"> `(two apple))</span><br><span class="line"></span><br><span class="line"><span class="number">2</span></span><br></pre></td></tr></table></figure><p>çœŸæ£’ï¼ç°åœ¨èƒ½è§£å†³é•¿åº¦å°äºç­‰äº2çš„listäº†ï¼<br>ä¾æ­¤ç±»æ¨ï¼Œæˆ‘ä»¬èƒ½å®šä¹‰å‡º<code>length3</code>ã€<code>length4</code>ã€<code>length5</code>,ç”šè‡³<code>length100</code>ã€<code>length1000</code>ã€<code>length10000</code>äº†ï¼<br>é‚£ä¹ˆå¦‚æœæˆ‘ä»¬èƒ½å†™å‡º<code>lengthâˆ</code>ï¼Œä¸å°±å¾—åˆ°äº†æˆ‘ä»¬çš„åŸå§‹<code>length</code>å‡½æ•°äº†å—ï¼Œå› ä¸º<code>length</code>æ˜¯å¯ä»¥å¤„ç†ä»»æ„é•¿åº¦çš„listçš„å‡½æ•°ï¼<br>ä½†æ˜¯ï¼Œæˆ‘ä»¬æ²¡åŠæ³•å†™å‡º<code>lengthâˆ</code>ï¼Œå› ä¸ºæ— ç©·è¡Œä»£ç å“ªé‡Œä¹Ÿæ”¾ä¸ä¸‹å•Šï¼ï¼ˆç¬‘</p><h3 id="è¯•ç€è¿›è¡ŒæŠ½è±¡">è¯•ç€è¿›è¡ŒæŠ½è±¡</h3><p>è¯•ç€è§‚å¯Ÿ<code>length0</code> <code>length1</code> <code>length2</code>ï¼Œæˆ‘ä»¬ä¼šå‘ç°ï¼Œè¿™ä¸‰ä¸ªå‡½æ•°éƒ½éµå¾ªç›¸åŒçš„å½¢å¼ï¼Œåªæœ‰<code>last-length</code>è¿™ä¸ªåœ°æ–¹æ˜¯éœ€è¦æ”¹å˜çš„ï¼š</p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">; same pattern</span></span><br><span class="line">(<span class="name"><span class="builtin-name">lambda</span></span> (lst)</span><br><span class="line">    (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">null?</span></span> lst)</span><br><span class="line">        <span class="number">0</span></span><br><span class="line">        (<span class="name">add1</span> (<span class="name">last-length</span> (<span class="name">rest</span> lst)))))</span><br></pre></td></tr></table></figure><p>æ ¹æ®DRYåŸåˆ™ï¼Œæˆ‘ä»¬ä¸ºä»€ä¹ˆä¸æŠŠç›¸åŒçš„å½¢å¼ç»™æŠ½è±¡å‡ºæ¥å‘¢ï¼Ÿ<br>æˆ‘ä»¬å¯ä»¥å†™å‡ºä¸€ä¸ªå‡½æ•°ï¼Œæ¥å—ä¸€ä¸ªå‚æ•°<code>last-length</code>ï¼Œç„¶åå°±å¯ä»¥åˆ©ç”¨è¿™ä¸ªå‡½æ•°ç”Ÿæˆä¹‹åçš„<code>length[i]</code>äº†ã€‚<br>å°±åƒè¿™æ ·ï¼š</p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">; abstract-length</span></span><br><span class="line">(<span class="name"><span class="builtin-name">lambda</span></span> (last-length)</span><br><span class="line">  (<span class="name"><span class="builtin-name">lambda</span></span> (lst)</span><br><span class="line">    (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">null?</span></span> lst)</span><br><span class="line">        <span class="number">0</span></span><br><span class="line">        (<span class="name">add1</span> (<span class="name">last-length</span> (<span class="name">rest</span> lst))))))</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªå‡½æ•°æ¥å—å‚æ•°<code>last-length</code>,ç„¶åå°±ä¼šè¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œå¯ä»¥æ¯”<code>last-length</code>å¤šå¤„ç†ä¸€ä¸ªé•¿åº¦çš„listã€‚<br>é‚£ä¹ˆï¼Œ<code>length0</code>å¯ä»¥è¡¨ç¤ºä¸ºï¼š</p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">; length0</span></span><br><span class="line">((<span class="name"><span class="builtin-name">lambda</span></span> (last-length)</span><br><span class="line">   (<span class="name"><span class="builtin-name">lambda</span></span> (lst)</span><br><span class="line">     (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">null?</span></span> lst)</span><br><span class="line">         <span class="number">0</span></span><br><span class="line">         (<span class="name">add1</span> (<span class="name">last-length</span> (<span class="name">rest</span> lst))))))</span><br><span class="line"> (<span class="name">id</span>))</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆåŒç†ï¼Œ<code>length1</code>å¯ä»¥è¡¨ç¤ºä¸ºï¼š</p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">; length1</span></span><br><span class="line">((<span class="name"><span class="builtin-name">lambda</span></span> (last-length)</span><br><span class="line">   (<span class="name"><span class="builtin-name">lambda</span></span> (lst)</span><br><span class="line">     (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">null?</span></span> lst)</span><br><span class="line">         <span class="number">0</span></span><br><span class="line">         (<span class="name">add1</span> (<span class="name">last-length</span> (<span class="name">rest</span> lst))))))</span><br><span class="line"> (<span class="name">length0</span>))</span><br></pre></td></tr></table></figure><p>å½“ç„¶ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰<code>length0</code>,éœ€è¦å°†å…¶è½¬æ¢ä¸ºåŒ¿åå½¢å¼ï¼Œä¹Ÿå°±æ˜¯è¿™æ ·ï¼š</p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">; length1</span></span><br><span class="line">((<span class="name"><span class="builtin-name">lambda</span></span> (last-length)</span><br><span class="line">   (<span class="name"><span class="builtin-name">lambda</span></span> (lst)</span><br><span class="line">     (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">null?</span></span> lst)</span><br><span class="line">         <span class="number">0</span></span><br><span class="line">         (<span class="name">add1</span> (<span class="name">last-length</span> (<span class="name">rest</span> lst))))))</span><br><span class="line"> ((<span class="name"><span class="builtin-name">lambda</span></span> (last-length)</span><br><span class="line">   (<span class="name"><span class="builtin-name">lambda</span></span> (lst)</span><br><span class="line">     (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">null?</span></span> lst)</span><br><span class="line">         <span class="number">0</span></span><br><span class="line">         (<span class="name">add1</span> (<span class="name">last-length</span> (<span class="name">rest</span> lst))))))</span><br><span class="line"> (<span class="name">id</span>)))</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆ<code>length2</code>ï¼Ÿ<br>å®¹æ˜“ï¼Œå†æ¥ä¸€æ¬¡ï¼š</p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">; length2</span></span><br><span class="line">((<span class="name"><span class="builtin-name">lambda</span></span> (last-length)</span><br><span class="line">   (<span class="name"><span class="builtin-name">lambda</span></span> (lst)</span><br><span class="line">     (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">null?</span></span> lst)</span><br><span class="line">         <span class="number">0</span></span><br><span class="line">         (<span class="name">add1</span> (<span class="name">last-length</span> (<span class="name">rest</span> lst))))))</span><br><span class="line"> ((<span class="name"><span class="builtin-name">lambda</span></span> (last-length)</span><br><span class="line">   (<span class="name"><span class="builtin-name">lambda</span></span> (lst)</span><br><span class="line">     (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">null?</span></span> lst)</span><br><span class="line">         <span class="number">0</span></span><br><span class="line">         (<span class="name">add1</span> (<span class="name">last-length</span> (<span class="name">rest</span> lst))))))</span><br><span class="line"> ((<span class="name"><span class="builtin-name">lambda</span></span> (last-length)</span><br><span class="line">   (<span class="name"><span class="builtin-name">lambda</span></span> (lst)</span><br><span class="line">     (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">null?</span></span> lst)</span><br><span class="line">         <span class="number">0</span></span><br><span class="line">         (<span class="name">add1</span> (<span class="name">last-length</span> (<span class="name">rest</span> lst))))))</span><br><span class="line"> (<span class="name">id</span>))))</span><br></pre></td></tr></table></figure><p>**WAIT!!!**è¿™éš¾é“ä¸æ˜¯ä¾ç„¶åœ¨é‡å¤å¢åŠ ä»£ç å—ï¼Ÿ<br>å¥½å§ï¼Œå…¶å®æˆ‘ä»¬è¿˜æ˜¯æœ‰æ‰€æ¨è¿›ï¼Œåˆ«æ€¥ï¼Œæ…¢æ…¢æ¥ã€‚</p><h3 id="è¿”å›lengthå‡½æ•°çš„å‡½æ•°ï¼šmake-length">è¿”å›lengthå‡½æ•°çš„å‡½æ•°ï¼šmake-length</h3><p>æŒ‰ç…§æˆ‘ä»¬åˆšåˆšçš„æŠ½è±¡ï¼Œ<code>abstract-length</code>ï¼š</p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">; abstract-length</span></span><br><span class="line">(<span class="name"><span class="builtin-name">lambda</span></span> (last-length)</span><br><span class="line">  (<span class="name"><span class="builtin-name">lambda</span></span> (lst)</span><br><span class="line">    (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">null?</span></span> lst)</span><br><span class="line">        <span class="number">0</span></span><br><span class="line">        (<span class="name">add1</span> (<span class="name">last-length</span> (<span class="name">rest</span> lst))))))</span><br></pre></td></tr></table></figure><p>å¯¹äºè¿™ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬å¦‚æœï¼š</p><ul><li>å–‚ç»™å®ƒ<code>id</code>,å³<code>(abstract-length id)</code>ï¼Œé‚£ä¹ˆå®ƒä¼šè¿”å›<code>length0</code></li><li>å–‚ç»™å®ƒ<code>length[i]</code>ï¼Œå³<code>(abstract-length length[i])</code>ï¼Œé‚£ä¹ˆå®ƒä¼šè¿”å›<code>length[i+1]</code><br>æ—¢ç„¶è¿™ä¸ªå‡½æ•°èƒ½å¤Ÿè¿”å›æˆ‘ä»¬éœ€è¦çš„<code>length[i]</code>,ä¸å¦¨å°†å…¶ç§°ä¹‹ä¸º<code>make-length</code>å‡½æ•°ã€‚<br>é‚£å°±å¯ä»¥å†™æˆå‡½æ•°åº”ç”¨çš„å½¢å¼ï¼Œå°±åƒæˆ‘ä»¬å¯¹<code>last-length</code>çš„æŠ½è±¡ï¼š</li></ul><figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">; length0</span></span><br><span class="line">((<span class="name"><span class="builtin-name">lambda</span></span> (make-length)</span><br><span class="line">   (<span class="name">make-length</span> id))</span><br><span class="line"> abstract-length)</span><br></pre></td></tr></table></figure><p>ä¾ç„¶è¿ç”¨æˆ‘ä»¬çš„old trickï¼Œå°†<code>abstract-length</code>å†™æˆåŒ¿åå½¢å¼ï¼š</p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">; length0</span></span><br><span class="line">((<span class="name"><span class="builtin-name">lambda</span></span> (make-length)</span><br><span class="line">   (<span class="name">make-length</span> id))</span><br><span class="line"> (<span class="name"><span class="builtin-name">lambda</span></span> (last-length)</span><br><span class="line">   (<span class="name"><span class="builtin-name">lambda</span></span> (lst)</span><br><span class="line">     (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">null?</span></span> lst)</span><br><span class="line">         <span class="number">0</span></span><br><span class="line">         (<span class="name">add1</span> (<span class="name">last-length</span> (<span class="name">rest</span> lst)))))))</span><br></pre></td></tr></table></figure><p>å¥½äº†ï¼Œè™½ç„¶è¿™ä¸ªå½¢å¼çœ‹ä¸Šå»å¾ˆå¤æ‚ï¼Œä½†æ˜¯å®ƒå°±æ˜¯æˆ‘ä»¬ç†Ÿæ‚‰çš„<code>length0</code>!<br>é‚£ä¹ˆï¼Œ<code>length1</code>å‘¢ï¼Ÿ<br>å¾ˆç®€å•ï¼Œæˆ‘ä»¬åªéœ€è¦å°†<code>length0</code>å–‚ç»™æˆ‘ä»¬çš„<code>abstract-length</code>ï¼Œå°±ä¼šå¾—åˆ°<code>length1</code>ã€‚ä¹Ÿå°±æ˜¯å°†<code>length0</code>ä¸­çš„<code>id</code>æ›¿æ¢æˆ<code>length0</code>ï¼š</p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">; length1</span></span><br><span class="line">((<span class="name"><span class="builtin-name">lambda</span></span> (make-length)</span><br><span class="line">   (<span class="name">make-length</span> length0))</span><br><span class="line"> abstract-length)</span><br></pre></td></tr></table></figure><p>æ¢æˆåŒ¿åè¡¨è¾¾ï¼š</p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">; length1</span></span><br><span class="line">((<span class="name"><span class="builtin-name">lambda</span></span> (make-length)</span><br><span class="line">   (<span class="name">make-length</span> (<span class="name">make-length</span> id)))</span><br><span class="line"> (<span class="name"><span class="builtin-name">lambda</span></span> (last-length)</span><br><span class="line">   (<span class="name"><span class="builtin-name">lambda</span></span> (lst)</span><br><span class="line">     (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">null?</span></span> lst)</span><br><span class="line">         <span class="number">0</span></span><br><span class="line">         (<span class="name">add1</span> (<span class="name">last-length</span> (<span class="name">rest</span> lst)))))))</span><br></pre></td></tr></table></figure><p>å†è¿›ä¸€æ­¥ï¼Œ<code>length2</code>ï¼š</p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">; length2</span></span><br><span class="line">((<span class="name"><span class="builtin-name">lambda</span></span> (make-length)</span><br><span class="line">   (<span class="name">make-length</span> (<span class="name">make-length</span> (<span class="name">make-length</span> id))))</span><br><span class="line"> (<span class="name"><span class="builtin-name">lambda</span></span> (last-length)</span><br><span class="line">   (<span class="name"><span class="builtin-name">lambda</span></span> (lst)</span><br><span class="line">     (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">null?</span></span> lst)</span><br><span class="line">         <span class="number">0</span></span><br><span class="line">         (<span class="name">add1</span> (<span class="name">last-length</span> (<span class="name">rest</span> lst)))))))</span><br></pre></td></tr></table></figure><p>é‚£ï¼Œ<code>length3</code>ï¼Ÿ</p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">; length3</span></span><br><span class="line">((<span class="name"><span class="builtin-name">lambda</span></span> (make-length)</span><br><span class="line">   (<span class="name">make-length</span> (<span class="name">make-length</span> (<span class="name">make-length</span> (<span class="name">make-length</span> id)))))</span><br><span class="line"> (<span class="name"><span class="builtin-name">lambda</span></span> (last-length)</span><br><span class="line">   (<span class="name"><span class="builtin-name">lambda</span></span> (lst)</span><br><span class="line">     (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">null?</span></span> lst)</span><br><span class="line">         <span class="number">0</span></span><br><span class="line">         (<span class="name">add1</span> (<span class="name">last-length</span> (<span class="name">rest</span> lst)))))))</span><br></pre></td></tr></table></figure><p>å¥½äº†å¥½äº†ï¼Œå°±ä¸å†ç»§ç»­æ¼”ç¤ºäº†ã€‚<br>é‚£ä¹ˆå›é¡¾ä¸€ä¸‹æˆ‘ä»¬çš„æ–°è¡¨ç¤ºæ–¹æ³•ï¼Œå¥½åƒå®ƒä»¬ä¹‹é—´çš„å·®åˆ«ï¼Œä»…ä»…åœ¨äºå¯¹å‚æ•°<code>id</code>åº”ç”¨äº†å¤šå°‘æ¬¡<code>make-length</code>å‡½æ•°ï¼š</p><ul><li><code>length0</code>: (make-length id)</li><li><code>length1</code>: (make-length (make-length id))</li><li><code>length2</code>: (make-length (make-length (make-length id)))</li><li><code>length3</code>: (make-length (make-length (make-length (make-length id))))</li></ul><p>æ˜¯ä¸æ˜¯æœ‰ç‚¹ç±»ä¼¼æ±‰è¯ºå¡”ï¼Ÿ</p><h3 id="å¿«åˆ°ç»ˆç‚¹äº†">å¿«åˆ°ç»ˆç‚¹äº†</h3><p>äº‹å®ä¸Šï¼Œæ¯å½“æˆ‘ä»¬ä½¿ç”¨<code>length</code>å‡½æ•°ï¼Œæˆ‘ä»¬å¹¶ä¸ä¼šç»™å®ƒä¸€ä¸ªæ— é™é•¿çš„listã€‚<br>é‚£ä¹ˆï¼Œåªè¦æˆ‘ä»¬ç”¨ä¸€ä¸ªè¶³å¤Ÿå¤§çš„<code>length[i]</code>ï¼Œå¯ä¸å¯è¡Œå‘¢ï¼ŸæŒ‰ç…§æˆ‘ä»¬ä¸Šä¸€å°èŠ‚çš„æŠ½è±¡ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ˜“åœ°å†™å‡º<code>length100</code>ï¼Œç”šè‡³<code>length10000000000000000</code>ã€‚<br>é—®é¢˜åœ¨äºï¼Œè¿™ä¸ªè¶³å¤Ÿå¤§çš„æ•°ï¼Œä»ç„¶å¯èƒ½ä¸å¤Ÿå¤§ã€‚</p><p>é‚£ä¹ˆä»€ä¹ˆæ—¶å€™æˆ‘ä»¬ä¼šçŸ¥é“ï¼Œè¿™ä¸ªæ•°ä¸å¤Ÿå¤§å‘¢ï¼Ÿ<br>æ˜¾ç„¶ï¼Œå½“æˆ‘ä»¬éœ€è¦ç”¨åˆ°æœ€æœ€æœ€æœ€å†…å±‚çš„å‡½æ•°<code>id</code>ï¼Œä¹Ÿå°±æ˜¯è®¡ç®—<code>(id (rest lst))</code>çš„æ—¶å€™ï¼Œå°±ä»£è¡¨ï¼Œè¿™ä¸ªæ•°ä¸å¤Ÿå¤§äº†ã€‚</p><p>**æ³¨æ„ï¼š**æˆ‘ä»¬å–‚ç»™<code>length2</code>ä¸€ä¸ªé•¿åº¦å°äºç­‰äº2çš„listæ—¶ï¼Œ<code>id</code>çš„å‡½æ•°åº”ç”¨æ˜¯æ²¡æœ‰æ±‚å€¼çš„ã€‚</p><p>é‚£ä¹ˆï¼Œå¦‚æœæ¯å½“æˆ‘ä»¬éœ€è¦å¯¹<code>id</code>çš„å‡½æ•°åº”ç”¨æ±‚å€¼çš„æ—¶å€™ï¼Œæˆ‘ä»¬å†å¯¹å…¶åº”ç”¨ä¸€æ¬¡<code>make-length</code>ï¼Œä¸å°±å¯ä»¥é¿å…å¯¹<code>id</code>çš„å‡½æ•°åº”ç”¨æ±‚å€¼äº†å—ï¼Ÿ</p><p>é‚£ä¹ˆï¼Œå¦‚æœæˆ‘ä»¬ä»ä¸å¯¹<code>id</code>çš„å‡½æ•°åº”ç”¨æ±‚å€¼ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œ<code>id</code>æ ¹æœ¬æ²¡ä»€ä¹ˆç”¨ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠ<strong>ä»»æ„å‡½æ•°</strong>ä¼ é€’ç»™æœ€å†…å±‚çš„<code>make-length</code>ã€‚</p><p>é‚£ä¹ˆï¼Œä¸ºä½•ä¸è¯•ä¸€è¯•æŠŠ<code>make-length</code>ä½œä¸ºæœ€å†…å±‚çš„å‚æ•°ä¼ ç»™<code>make-length</code>å‘¢ã€‚<br>é‚£ä¹ˆï¼Œ<code>length0</code>:</p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">; length0</span></span><br><span class="line">((<span class="name"><span class="builtin-name">lambda</span></span> (make-length)</span><br><span class="line">   (<span class="name">make-length</span> make-length))</span><br><span class="line"> (<span class="name"><span class="builtin-name">lambda</span></span> (last-length)</span><br><span class="line">   (<span class="name"><span class="builtin-name">lambda</span></span> (lst)</span><br><span class="line">     (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">null?</span></span> lst)</span><br><span class="line">         <span class="number">0</span></span><br><span class="line">         (<span class="name">add1</span> (<span class="name">last-length</span> (<span class="name">rest</span> lst)))))))</span><br></pre></td></tr></table></figure><p>å›è¿‡å¤´æ¥çœ‹ï¼Œå…¶å®<code>last-length</code>ä¹Ÿæ˜¯æ¥å—ä¸€ä¸ªå‚æ•°<code>length[i]</code>ï¼Œç„¶åè¿”å›æ–°çš„å‡½æ•°<code>length[i+1]</code>ã€‚</p><p>é‚£ä¸æ˜¯å’Œ<code>make-length</code>ä¸€æ ·äº†ï¼Ÿ<br>æ˜¯è¿™æ ·ã€‚<br>é‚£æˆ‘ä»¬å°†<code>last-length</code>æ”¹åä¸º<code>make-length</code>ä¹Ÿå¯ä»¥å—ï¼Ÿ<br>å¯ä»¥ã€‚åªè¦ä¿æŒå‡½æ•°å‚æ•°å’Œå‡½æ•°ä½“å†…çš„åå­—ä¸€è‡´å³å¯ã€‚<br>é‚£æˆ‘ä»¬æ”¹åå§ï¼š</p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">; length0</span></span><br><span class="line">((<span class="name"><span class="builtin-name">lambda</span></span> (make-length)</span><br><span class="line">   (<span class="name">make-length</span> make-length))</span><br><span class="line"> (<span class="name"><span class="builtin-name">lambda</span></span> (make-length)</span><br><span class="line">   (<span class="name"><span class="builtin-name">lambda</span></span> (lst)</span><br><span class="line">     (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">null?</span></span> lst)</span><br><span class="line">         <span class="number">0</span></span><br><span class="line">         (<span class="name">add1</span> (<span class="name">make-length</span> (<span class="name">rest</span> lst)))))))</span><br></pre></td></tr></table></figure><p>è¿›ä¸€æ­¥ï¼Œä¾ç…§åˆšåˆšæ‰€è¯´ï¼Œæˆ‘ä»¬åªéœ€è¦å°†<code>length1</code>ä¸­æœ€å†…å±‚çš„å‡½æ•°åº”ç”¨æ·»åŠ ä¸€å±‚</p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">; length1</span></span><br><span class="line">((<span class="name"><span class="builtin-name">lambda</span></span> (make-length)</span><br><span class="line">   (<span class="name">make-length</span> make-length))</span><br><span class="line"> (<span class="name"><span class="builtin-name">lambda</span></span> (make-length)</span><br><span class="line">   (<span class="name"><span class="builtin-name">lambda</span></span> (lst)</span><br><span class="line">     (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">null?</span></span> lst)</span><br><span class="line">         <span class="number">0</span></span><br><span class="line">         (<span class="name">add1</span> ((<span class="name">make-length</span> id) (<span class="name">rest</span> lst)))))))</span><br></pre></td></tr></table></figure><p>ç­‰ç­‰ï¼Ÿä¸ºä»€ä¹ˆ<code>id</code>åˆå‡ºç°äº†ï¼Ÿ<br>å› ä¸ºæˆ‘ä»¬åªèƒ½å¤„ç†é•¿åº¦å°äºç­‰äº1çš„listã€‚<br>å¦‚ä½•è§£å†³æ­¤å›°å¢ƒï¼Ÿ<br>å†æ¬¡å°†<code>make-length</code>ä¼ é€’ç»™è‡ªèº«ï¼Œè¿™æ ·æ¯å½“æˆ‘ä»¬éœ€è¦æ›´é•¿çš„<code>length[i]</code>çš„æ—¶å€™ï¼Œå°±ä¼šè‡ªåŠ¨å°†å‡½æ•°çš„å¤„ç†èƒ½åŠ›+1ã€‚<br>å°±åƒè¿™æ ·ï¼š</p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">; length1</span></span><br><span class="line">((<span class="name"><span class="builtin-name">lambda</span></span> (make-length)</span><br><span class="line">   (<span class="name">make-length</span> make-length))</span><br><span class="line"> (<span class="name"><span class="builtin-name">lambda</span></span> (make-length)</span><br><span class="line">   (<span class="name"><span class="builtin-name">lambda</span></span> (lst)</span><br><span class="line">     (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">null?</span></span> lst)</span><br><span class="line">         <span class="number">0</span></span><br><span class="line">         (<span class="name">add1</span> ((<span class="name">make-length</span> make-length) (<span class="name">rest</span> lst)))))))</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªå‡½æ•°çš„å·¥ä½œæœºç†æ˜¯ï¼Œå®ƒå±•å¼€çš„å±‚æ•°æ€»æ˜¯å’Œå–‚ç»™å®ƒçš„<code>list</code>é•¿åº¦ä¸€æ ·å¤šã€‚å› ä¸ºä¸€æ—¦å±‚æ•°ä¸å¤Ÿé•¿ï¼Œä»–å°±ä¼šå°†<code>make-length</code>åº”ç”¨äºè‡ªèº«ï¼Œå¢åŠ å¤šä¸€æ¬¡çš„å¤„ç†ã€‚</p><p>è¯•ä¸€è¯•<code>length1</code>èƒ½å¦å·¥ä½œ:</p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&gt; (((lambda (make-length)</span><br><span class="line">    (make-length make-length))</span><br><span class="line">  (<span class="name"><span class="builtin-name">lambda</span></span> (make-length)</span><br><span class="line">    (<span class="name"><span class="builtin-name">lambda</span></span> (lst)</span><br><span class="line">      (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">null?</span></span> lst)</span><br><span class="line">          <span class="number">0</span></span><br><span class="line">          (add1 ((make-length make-length) (rest lst)))))))</span><br><span class="line"> `(apple))</span><br><span class="line"></span><br><span class="line"> <span class="number">1</span></span><br><span class="line"></span><br><span class="line"> &gt; (((lambda (make-length)</span><br><span class="line">    (make-length make-length))</span><br><span class="line">  (<span class="name"><span class="builtin-name">lambda</span></span> (make-length)</span><br><span class="line">    (<span class="name"><span class="builtin-name">lambda</span></span> (lst)</span><br><span class="line">      (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">null?</span></span> lst)</span><br><span class="line">          <span class="number">0</span></span><br><span class="line">          (add1 ((make-length make-length) (rest lst)))))))</span><br><span class="line"> `(two apple))</span><br><span class="line"></span><br><span class="line"> <span class="number">2</span></span><br></pre></td></tr></table></figure><p>å¾ˆå¥½ï¼Œæˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ªèƒ½å·¥ä½œçš„<code>length1</code>ï¼Œäº‹å®ä¸Šï¼Œè¿™å·²ç»ä¸å†æ˜¯<code>length1</code>äº†ï¼Œå› ä¸ºå®ƒèƒ½å¤„ç†é•¿åº¦ä¸º2çš„listï¼ç”šè‡³æ›´é•¿çš„ï¼<br>è¿™å°±å’Œæˆ‘ä»¬æœ€åˆçš„<code>length</code>ä¸€æ ·äº†ï¼</p><p>ï¼ˆå¦‚æœä½ ä¸æ˜ç™½è¿™é‡Œçš„<code>length1</code>ä¸ºä½•èƒ½å·¥ä½œï¼Œå¯ä»¥è¯•ç€å†è¯»ä¸€è¯»è¿™ä¸¤ä¸ªå°èŠ‚ï¼Œæˆ–è€…æ‰‹åŠ¨æ¨æ¼”ä¸€ä¸‹è¿™ä¸ªlambdaå¼å­ï¼‰</p><h3 id="ä¸æ­¢åº”ç”¨äºlength">ä¸æ­¢åº”ç”¨äºlength</h3><p>å¯¹æ¯”ä¸€ä¸‹æˆ‘ä»¬çš„æ˜¾å¼é€’å½’<code>length</code>å’Œ<code>newlength</code>:</p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">; length</span></span><br><span class="line">(<span class="name"><span class="builtin-name">define</span></span> length</span><br><span class="line">  (<span class="name"><span class="builtin-name">lambda</span></span> (lst)</span><br><span class="line">    (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">null?</span></span> lst)</span><br><span class="line">        <span class="number">0</span></span><br><span class="line">        (<span class="name">add1</span> (<span class="name"><span class="builtin-name">length</span></span> (<span class="name">rest</span> lst))))))</span><br><span class="line"></span><br><span class="line"><span class="comment">; newlength</span></span><br><span class="line">((<span class="name"><span class="builtin-name">lambda</span></span> (make-length)</span><br><span class="line">   (<span class="name">make-length</span> make-length))</span><br><span class="line"> (<span class="name"><span class="builtin-name">lambda</span></span> (make-length)</span><br><span class="line">   (<span class="name"><span class="builtin-name">lambda</span></span> (lst)</span><br><span class="line">     (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">null?</span></span> lst)</span><br><span class="line">         <span class="number">0</span></span><br><span class="line">         (<span class="name">add1</span> ((<span class="name">make-length</span> make-length) (<span class="name">rest</span> lst)))))))</span><br></pre></td></tr></table></figure><p>è¿™ä¸¤ä¸ªå®šä¹‰åœ¨å½¢å¼ä¸Šè¿˜æ˜¯æœ‰å·®åˆ«ï¼Œå› ä¸ºå‰è€…å®šä¹‰ä¸­çš„<code>(length (rest lst))</code>ï¼Œåœ¨åè€…å®šä¹‰ä¸­å˜æˆäº†<code>((make-length make-length) (rest lst))</code>ã€‚</p><p>ä¸ºäº†ä½¿å®ƒä»¬è¡¨ç°çš„ä¸€è‡´ï¼Œæˆ‘ä»¬å°†<code>(make-length make-length)</code>æŠ½è±¡å‡ºæ¥å°±å¥½äº†ï¼Œç„¶åä½œä¸ºå‚æ•°ä¼ è¿›å»ï¼Œè€Œä¸”æˆ‘ä»¬å°†å‚æ•°å–åä¸º<code>length</code>ï¼</p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">; length</span></span><br><span class="line">(<span class="name"><span class="builtin-name">define</span></span> length</span><br><span class="line">  (<span class="name"><span class="builtin-name">lambda</span></span> (lst)</span><br><span class="line">    (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">null?</span></span> lst)</span><br><span class="line">        <span class="number">0</span></span><br><span class="line">        (<span class="name">add1</span> (<span class="name"><span class="builtin-name">length</span></span> (<span class="name">rest</span> lst))))))</span><br><span class="line"></span><br><span class="line"><span class="comment">; newlength</span></span><br><span class="line">((<span class="name"><span class="builtin-name">lambda</span></span> (make-length)</span><br><span class="line">   (<span class="name">make-length</span> make-length))</span><br><span class="line"> (<span class="name"><span class="builtin-name">lambda</span></span> (make-length)</span><br><span class="line">   ((<span class="name"><span class="builtin-name">lambda</span></span> (length)</span><br><span class="line">    <span class="comment">;;;;;;;</span></span><br><span class="line">     (<span class="name"><span class="builtin-name">lambda</span></span> (lst)</span><br><span class="line">       (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">null?</span></span> lst)</span><br><span class="line">           <span class="number">0</span></span><br><span class="line">           (<span class="name">add1</span> (<span class="name"><span class="builtin-name">length</span></span> (<span class="name">rest</span> lst))))))</span><br><span class="line">    <span class="comment">;;;;;;;</span></span><br><span class="line">   (<span class="name">make-length</span> make-length))))</span><br></pre></td></tr></table></figure><p>å¥½äº†ï¼Œçœ‹ä¸Šå»å¤§åŠŸå‘Šæˆï¼Œå¯ä»¥æŠŠä¸¤ä¸ªå®šä¹‰åœ¨å½¢å¼ä¸Šç›¸åŒçš„åœ°æ–¹æŠ½è±¡å‡ºæ¥ï¼Œè¿™æ ·å°±å¯ä»¥ç”¨åœ¨åˆ«çš„é€’å½’å‡½æ•°å®šä¹‰ä¸­äº†ã€‚</p><p>WAITï¼è¿˜æ²¡å®Œï¼Œæˆ‘ä»¬è¯•ç€ç”¨ä¸€ç”¨<code>newlength</code>ï¼Œè¯•ç€å¯¹<code>(apple)</code>æ±‚å€¼ï¼š</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&gt; (((lambda (make-length)</span><br><span class="line">    (make-length make-length))</span><br><span class="line">  (<span class="name"><span class="builtin-name">lambda</span></span> (make-length)</span><br><span class="line">    ((<span class="name"><span class="builtin-name">lambda</span></span> (length)</span><br><span class="line">       (<span class="name"><span class="builtin-name">lambda</span></span> (lst)</span><br><span class="line">         (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">null?</span></span> lst)</span><br><span class="line">             <span class="number">0</span></span><br><span class="line">             (<span class="name">add1</span> (<span class="name"><span class="builtin-name">length</span></span> (<span class="name">rest</span> lst))))))</span><br><span class="line">     (make-length make-length))))</span><br><span class="line"> `(apple))</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬éœ€è¦å°†è¿™ä¸ªè¡¨è¾¾å¼çš„å€¼æ±‚å‡ºæ¥ï¼Œç„¶ååº”ç”¨åˆ°<code>(apple)</code>ä¸Š</p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">((<span class="name"><span class="builtin-name">lambda</span></span> (make-length)</span><br><span class="line">   (<span class="name">make-length</span> make-length))</span><br><span class="line"> <span class="comment">; A-start</span></span><br><span class="line"> (<span class="name"><span class="builtin-name">lambda</span></span> (make-length)</span><br><span class="line">   ((<span class="name"><span class="builtin-name">lambda</span></span> (length)</span><br><span class="line">      (<span class="name"><span class="builtin-name">lambda</span></span> (lst)</span><br><span class="line">        (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">null?</span></span> lst)</span><br><span class="line">            <span class="number">0</span></span><br><span class="line">            (<span class="name">add1</span> (<span class="name"><span class="builtin-name">length</span></span> (<span class="name">rest</span> lst))))))</span><br><span class="line">    (<span class="name">make-length</span> make-length)))</span><br><span class="line"> <span class="comment">; A-end</span></span><br><span class="line"> )</span><br><span class="line"> </span><br></pre></td></tr></table></figure><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦å°†<code>(lambda (make-length) (make-length make-length))</code>åº”ç”¨äºåé¢é‚£ä¸ªå¼å­(è®°ä½œA)ä¸Šï¼Œå¾—åˆ°<code>(A A)</code>ï¼Œå³ï¼š</p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">(</span><br><span class="line"> <span class="comment">; B-start</span></span><br><span class="line"> (<span class="name"><span class="builtin-name">lambda</span></span> (make-length)</span><br><span class="line">   ((<span class="name"><span class="builtin-name">lambda</span></span> (length)</span><br><span class="line">      (<span class="name"><span class="builtin-name">lambda</span></span> (lst)</span><br><span class="line">        (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">null?</span></span> lst)</span><br><span class="line">            <span class="number">0</span></span><br><span class="line">            (<span class="name">add1</span> (<span class="name"><span class="builtin-name">length</span></span> (<span class="name">rest</span> lst))))))</span><br><span class="line">    (<span class="name">make-length</span> make-length)))</span><br><span class="line"> <span class="comment">; B-end</span></span><br><span class="line"> <span class="comment">; C-start</span></span><br><span class="line"> (<span class="name"><span class="builtin-name">lambda</span></span> (make-length)</span><br><span class="line">   ((<span class="name"><span class="builtin-name">lambda</span></span> (length)</span><br><span class="line">      (<span class="name"><span class="builtin-name">lambda</span></span> (lst)</span><br><span class="line">        (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">null?</span></span> lst)</span><br><span class="line">            <span class="number">0</span></span><br><span class="line">            (<span class="name">add1</span> (<span class="name"><span class="builtin-name">length</span></span> (<span class="name">rest</span> lst))))))</span><br><span class="line">    (<span class="name">make-length</span> make-length)))</span><br><span class="line"> <span class="comment">; C-end</span></span><br><span class="line"> )</span><br></pre></td></tr></table></figure><p>ç„¶åç»§ç»­æ±‚å€¼ï¼Œå°†Båº”ç”¨äºCï¼Œä¹Ÿå°±æ˜¯å°†Bçš„å‚æ•°<code>make-length</code>ç”¨Cè¿›è¡Œä»£æ¢ï¼Œå¾—åˆ°ï¼š</p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">(</span><br><span class="line"> <span class="comment">; D-start</span></span><br><span class="line"> (<span class="name"><span class="builtin-name">lambda</span></span> (length)</span><br><span class="line">   (<span class="name"><span class="builtin-name">lambda</span></span> (lst)</span><br><span class="line">     (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">null?</span></span> lst)</span><br><span class="line">         <span class="number">0</span></span><br><span class="line">         (<span class="name">add1</span> (<span class="name"><span class="builtin-name">length</span></span> (<span class="name">rest</span> lst))))))</span><br><span class="line"> <span class="comment">; D-end</span></span><br><span class="line"> <span class="comment">; E-start</span></span><br><span class="line"> ((<span class="name"><span class="builtin-name">lambda</span></span> (make-length)</span><br><span class="line">    ((<span class="name"><span class="builtin-name">lambda</span></span> (length)</span><br><span class="line">       (<span class="name"><span class="builtin-name">lambda</span></span> (lst)</span><br><span class="line">         (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">null?</span></span> lst)</span><br><span class="line">             <span class="number">0</span></span><br><span class="line">             (<span class="name">add1</span> (<span class="name"><span class="builtin-name">length</span></span> (<span class="name">rest</span> lst))))))</span><br><span class="line">     (<span class="name">make-length</span> make-length)))</span><br><span class="line">  (<span class="name"><span class="builtin-name">lambda</span></span> (make-length)</span><br><span class="line">    ((<span class="name"><span class="builtin-name">lambda</span></span> (length)</span><br><span class="line">       (<span class="name"><span class="builtin-name">lambda</span></span> (lst)</span><br><span class="line">         (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">null?</span></span> lst)</span><br><span class="line">             <span class="number">0</span></span><br><span class="line">             (<span class="name">add1</span> (<span class="name"><span class="builtin-name">length</span></span> (<span class="name">rest</span> lst))))))</span><br><span class="line">     (<span class="name">make-length</span> make-length))))</span><br><span class="line"> <span class="comment">; E-end</span></span><br><span class="line"> )</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç°åœ¨æˆ‘ä»¬å¾—åˆ°äº†å½¢å¦‚<code>(D E)</code>çš„å¼å­ï¼Œç„¶åæˆ‘ä»¬ç»§ç»­æ±‚å€¼ï¼Œä½ ä¼šæ³¨æ„åˆ°ï¼ŒEçš„å½¢çŠ¶å’Œåˆšåˆšæˆ‘ä»¬å¾—åˆ°çš„<code>(A A)</code>å½¢çŠ¶æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼šåœ¨è¿™é‡Œä¸€ç›´å¾ªç¯ä¸‹å»ã€‚</p><p>è¿™å°±å¾ˆå¥‡æ€ªäº†ï¼Œæˆ‘ä»¬åœ¨æŠŠ<code>(make-length make-length)</code>æŠ½è±¡å‡ºæ¥ä¹‹å‰å‡½æ•°éƒ½æ˜¯å¥½çš„å‘€ï¼Ÿ</p><p>å›æƒ³ä¸€ä¸‹ï¼Œ<code>make-length</code>çš„ä½œç”¨æ˜¯ç”Ÿæˆä¸€ä¸ªæ–°çš„<code>length[i+1]</code>å‡½æ•°ï¼Œç„¶åå°†å…¶åº”ç”¨äºä¸€ä¸ªlistã€‚<br>ä½†æ˜¯æˆ‘ä»¬æŠŠ<code>(make-length make-length)</code>æŠ½è±¡å‡ºæ¥ä¹‹åï¼Œæˆ‘ä»¬æ— æ³•å¾—åˆ°è¿™ä¸ª<code>length[i+1]</code>å‡½æ•°ï¼Œå› ä¸ºSchemeæ˜¯åº”ç”¨åºæ±‚å€¼ç­–ç•¥ï¼Œ<code>make-length</code>åå¤å¯¹è‡ªèº«è¿›è¡Œåº”ç”¨ã€‚<br>å› æ­¤ï¼Œæˆ‘ä»¬è¦æƒ³ä¸€ä¸ªåŠæ³•ï¼Œå…ˆè®©<code>make-length</code>çš„åº”ç”¨åœä¸€åœï¼Œç­‰åˆ°éœ€è¦å®ƒå¯¹è‡ªèº«è¿›è¡Œåº”ç”¨çš„æ—¶å€™ï¼Œå†ç»§ç»­ã€‚<br>è¿™ä¸ªæ–¹æ³•å¹¶ä¸å¤æ‚ï¼Œå°±æ˜¯å°†<code>(make-length make-length)</code>åŒ…è£¹åœ¨ä¸€ä¸ª<code>lambda</code>è¡¨è¾¾å¼ä¹‹ä¸­ï¼Œå³<code>(lambda (x) ((make-length make-length) x))</code>ã€‚</p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">; newlength</span></span><br><span class="line">((<span class="name"><span class="builtin-name">lambda</span></span> (make-length)</span><br><span class="line">   (<span class="name">make-length</span> make-length))</span><br><span class="line"> (<span class="name"><span class="builtin-name">lambda</span></span> (make-length)</span><br><span class="line">   (<span class="name"><span class="builtin-name">lambda</span></span> (lst)</span><br><span class="line">     (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">null?</span></span> lst)</span><br><span class="line">         <span class="number">0</span></span><br><span class="line">         (<span class="name">add1</span> ((<span class="name"><span class="builtin-name">lambda</span></span> (x) ((<span class="name">make-length</span> make-length) x))</span><br><span class="line">                (<span class="name">rest</span> lst)))))))</span><br></pre></td></tr></table></figure><p>ç„¶åæˆ‘ä»¬å†æŠŠå®ƒæŠ½è±¡å‡ºæ¥ã€‚</p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">; new newlength</span></span><br><span class="line">((<span class="name"><span class="builtin-name">lambda</span></span> (make-length)</span><br><span class="line">   (<span class="name">make-length</span> make-length))</span><br><span class="line"> (<span class="name"><span class="builtin-name">lambda</span></span> (make-length)</span><br><span class="line">   (</span><br><span class="line">    <span class="comment">;;;;;;</span></span><br><span class="line">    (<span class="name"><span class="builtin-name">lambda</span></span> (length)</span><br><span class="line">      (<span class="name"><span class="builtin-name">lambda</span></span> (lst)</span><br><span class="line">        (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">null?</span></span> lst)</span><br><span class="line">            <span class="number">0</span></span><br><span class="line">            (<span class="name">add1</span> (<span class="name"><span class="builtin-name">length</span></span> (<span class="name">rest</span> lst))))))</span><br><span class="line">    <span class="comment">;;;;;;</span></span><br><span class="line">    (<span class="name"><span class="builtin-name">lambda</span></span> (x) ((<span class="name">make-length</span> make-length) x)))))</span><br><span class="line"></span><br><span class="line"><span class="comment">; length</span></span><br><span class="line">(<span class="name"><span class="builtin-name">define</span></span> length</span><br><span class="line">  (<span class="name"><span class="builtin-name">lambda</span></span> (lst)</span><br><span class="line">    (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">null?</span></span> lst)</span><br><span class="line">        <span class="number">0</span></span><br><span class="line">        (<span class="name">add1</span> (<span class="name"><span class="builtin-name">length</span></span> (<span class="name">rest</span> lst))))))</span><br></pre></td></tr></table></figure><p>è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¾—èƒ½æ­£ç¡®ä½¿ç”¨çš„<code>newlength</code>äº†ï¼Œå°±èƒ½ç»§ç»­æˆ‘ä»¬çš„æŠ½è±¡å·¥ä½œäº†ã€‚</p><p>å¯¹æ¯”ä¸€ä¸‹<code>newlength</code>å’ŒåŸå§‹<code>length</code>ï¼Œä½¿ç”¨â€œ;;;;;;â€åˆ†éš”å¼€çš„éƒ¨åˆ†ï¼Œå®Œå…¨å°±æ˜¯åŸå§‹<code>length</code>çš„å®šä¹‰ï¼Œé™¤äº†å°†åŸå§‹<code>length</code>å®šä¹‰ä¸­çš„<code>define</code>æ›¿æ¢æˆ<code>lambda</code>ã€‚è€Œä¸”è¿™éƒ¨åˆ†ï¼Œå’Œ<code>make-length</code>å®Œå…¨æ— å…³ï¼</p><p>é‚£ä¹ˆï¼Œæˆ‘ä»¬å°†è¿™éƒ¨åˆ†æŠ½è±¡å‡ºæ¥ï¼Œä½¿å…¶å˜æˆä¸€ä¸ªå‡½æ•°åº”ç”¨ã€‚</p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">(</span><br><span class="line"> <span class="comment">; Y-start</span></span><br><span class="line"> (<span class="name"><span class="builtin-name">lambda</span></span> (a-func)</span><br><span class="line">   ((<span class="name"><span class="builtin-name">lambda</span></span> (make-length)</span><br><span class="line">      (<span class="name">make-length</span> make-length))</span><br><span class="line">    (<span class="name"><span class="builtin-name">lambda</span></span> (make-length)</span><br><span class="line">      (<span class="name">a-func</span> (<span class="name"><span class="builtin-name">lambda</span></span> (x)</span><br><span class="line">                ((<span class="name">make-length</span> make-length) x))))))</span><br><span class="line"> <span class="comment">; Y-end</span></span><br><span class="line"> <span class="comment">; F-start</span></span><br><span class="line"> (<span class="name"><span class="builtin-name">lambda</span></span> (length)</span><br><span class="line">   (<span class="name"><span class="builtin-name">lambda</span></span> (lst)</span><br><span class="line">     (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">null?</span></span> lst)</span><br><span class="line">         <span class="number">0</span></span><br><span class="line">         (<span class="name">add1</span> (<span class="name"><span class="builtin-name">length</span></span> (<span class="name">rest</span> lst))))))</span><br><span class="line"> <span class="comment">; F-end</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>ç°åœ¨æˆ‘ä»¬æœ‰äº†ä¸¤éƒ¨åˆ†ï¼ŒYå’ŒFï¼š</p><ul><li>Yéƒ¨åˆ†æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒæ¥å—ä¸€ä¸ªå’ŒåŸå§‹<code>length</code>å…·æœ‰ç›¸åŒå½¢å¼çš„å‡½æ•°ï¼Œç„¶åè¿”å›ä¸€ä¸ªé€’å½’å‡½æ•°<code>length</code>ï¼›</li><li>Féƒ¨åˆ†ï¼Œå°±æ˜¯å’ŒåŸå§‹<code>length</code>å½¢å¼ç›¸åŒçš„åŒ¿åå‡½æ•°å•¦ã€‚</li></ul><p>é‚£ä¹ˆè¿™ä¸ªYéƒ¨åˆ†ï¼Œå°±æ˜¯æˆ‘ä»¬çš„Y combinatorï¼ä¸€èˆ¬è¢«ç§°ä½œåº”ç”¨åºY combinatorã€‚<br>åŒ–ç®€ä¸€ä¸‹ï¼š</p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">; applicative-order Y combinator</span></span><br><span class="line">(<span class="name"><span class="builtin-name">lambda</span></span> (func)</span><br><span class="line">  ((<span class="name"><span class="builtin-name">lambda</span></span> (f)</span><br><span class="line">     (<span class="name">f</span> f))</span><br><span class="line">   (<span class="name"><span class="builtin-name">lambda</span></span> (f)</span><br><span class="line">     (<span class="name">func</span> (<span class="name"><span class="builtin-name">lambda</span></span> (x)</span><br><span class="line">             ((<span class="name">f</span> f) x))))))</span><br></pre></td></tr></table></figure><p>æœ‰äº†Y combinatorï¼Œæˆ‘ä»¬å°±èƒ½ä»åŒ¿åå‡½æ•°ä¸­å®šä¹‰é€’å½’å‡½æ•°äº†ï¼</p><h3 id="ç»ƒä¹ ">ç»ƒä¹ </h3><p>ä½ èƒ½å†™å‡ºä¸€ä¸ªç®€å•çš„é˜¶ä¹˜å‡½æ•°<code>factorial</code>ï¼Œç„¶åç”¨Y combinatorå°†å…¶å˜æˆåŒ¿åé€’å½’å‡½æ•°å—ï¼Ÿ</p><h3 id="å‚è€ƒ">å‚è€ƒ</h3><ol><li><a href="https://www.amazon.com/Little-Schemer-Daniel-P-Friedman/dp/0262560992" target="_blank" rel="noopener"><em>The Little Schemer</em></a></li><li><a href="https://en.wikipedia.org/wiki/Fixed-point_combinator" target="_blank" rel="noopener">Fixed-point combinator - Wikipidia</a></li><li><a href="https://mitpress.mit.edu/sicp/full-text/sicp/book/node85.html" target="_blank" rel="noopener">Normal Order and Applicative Order - <em>SICP</em></a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;å‰è¨€&quot;&gt;å‰è¨€&lt;/h3&gt;
&lt;p&gt;åœ¨Lambdaæ¼”ç®—ä¸­ï¼Œå‡½æ•°æ˜¯æ²¡æœ‰åå­—çš„ï¼ˆéƒ½æ˜¯åŒ¿åå‡½æ•°ï¼‰ï¼Œé‚£ä¹ˆå¦‚æœå‡½æ•°æ²¡æœ‰åå­—ï¼Œä¹Ÿå°±æ— æ³•åœ¨å‡½æ•°ä½“å†…æ˜¾å¼åœ°è°ƒç”¨è‡ªèº«ï¼Œä¹Ÿå°±æ— æ³•å®šä¹‰é€’å½’å‡½æ•°ï¼ŒY combinatorå°±æ˜¯ç”¨æ¥è§£å†³è¿™ä¸ªé—®é¢˜çš„ã€‚&lt;br&gt;
è¿™ç¯‡æ–‡ç« æƒ³æŠ›å¼€é‚£äº›æ•°å­¦æ¦‚å¿µï¼Œç”¨ç¨‹åºè¯­è¨€ï¼ˆSchemeï¼‰çš„å½¢å¼æ¥è®²è§£æˆ‘ä»¬æ˜¯å¦‚ä½•æ¨å¯¼å‡ºY combinatorçš„ã€‚&lt;/p&gt;
&lt;p&gt;è¿è¡Œç¯å¢ƒï¼š&lt;br&gt;
IDEï¼š&lt;a href=&quot;https://racket-lang.org/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;DrRacket&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="Programming" scheme="http://duanyifu.com/categories/Programming/"/>
    
    
      <category term="Scheme" scheme="http://duanyifu.com/tags/Scheme/"/>
    
      <category term="Y combinator" scheme="http://duanyifu.com/tags/Y-combinator/"/>
    
  </entry>
  
  <entry>
    <title>Programming in Haskell Chapter10 Exercises Solutions</title>
    <link href="http://duanyifu.com/2016/09/13/PIHex10/"/>
    <id>http://duanyifu.com/2016/09/13/PIHex10/</id>
    <published>2016-09-13T13:11:45.000Z</published>
    <updated>2016-09-13T19:49:22.000Z</updated>
    
    <content type="html"><![CDATA[<p><em>Programming in Haskell</em>æ˜¯ä¸€æœ¬å…¥é—¨Haskellçš„å¥½ä¹¦ï¼Œä»‹ç»é¡µé¢ä»¥åŠé…å¥—çš„slides, vedios, codeséƒ½åœ¨<a href="http://www.cs.nott.ac.uk/~pszgmh/book.html" target="_blank" rel="noopener">è¿™é‡Œ</a>ã€‚</p><hr><p>ç¬¬ä¹ç« çš„ä¹ é¢˜æš‚æ—¶è·³è¿‡äº†ï¼Œå…ˆæ›´ç¬¬åç« ã€‚<br>å¼€å­¦äº†ï¼Œäº‹æƒ…å¤šäº†èµ·æ¥ï¼Œè¿˜è¦æ‰¾å·¥ä½œï¼ŒåŠ æŠŠåŠ²æœ€è¿‘æŠŠè¿™æœ¬ä¹¦åˆ·å®Œå§ï¼:P</p><p>å…¶å®ä»ç¬¬8ç« å¼€å§‹ï¼Œè¿™æœ¬ä¹¦å¯¹äºmonadå°±è®²çš„å¤ªå°‘ï¼Œè¿‡å‡ å¤©è¿™æœ¬ä¹¦è¦å‡ºç¬¬äºŒç‰ˆï¼Œå¸Œæœ›èƒ½åœ¨è¿™æ–¹é¢æ”¹è¿›æ”¹è¿›ã€‚ã€‚ã€‚<br>æˆ‘ä¸‹å•äº†ä¸€æœ¬ã€ŠHaskellè¶£å­¦æŒ‡å—ã€‹ï¼Œæ‰“ç®—ç»“åˆèµ·æ¥çœ‹ï¼Œç„¶åå†è¡¥ä¸Šè·³è¿‡çš„ä¹ é¢˜ã€‚</p><hr><h4 id="å®šä¹‰å‡½æ•°-mult-nat-nat-nat">å®šä¹‰å‡½æ•° mult :: Nat -&gt; Nat -&gt; Nat</h4><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">data</span> <span class="type">Nat</span> = <span class="type">Zero</span> | <span class="type">Succ</span> <span class="type">Nat</span></span></span><br><span class="line"><span class="title">nat2int</span> :: <span class="type">Nat</span> -&gt; <span class="type">Int</span></span><br><span class="line"><span class="title">nat2int</span> <span class="type">Zero</span> = <span class="number">0</span></span><br><span class="line"><span class="title">nat2int</span> (<span class="type">Succ</span> n) = <span class="number">1</span> + nat2int n</span><br><span class="line"></span><br><span class="line"><span class="title">int2nat</span> :: <span class="type">Int</span> -&gt; <span class="type">Nat</span></span><br><span class="line"><span class="title">int2nat</span> <span class="number">0</span> = <span class="type">Zero</span></span><br><span class="line"><span class="title">int2nat</span> n = <span class="type">Succ</span> (int2nat (n - <span class="number">1</span>))</span><br><span class="line"></span><br><span class="line"><span class="title">add</span> :: <span class="type">Nat</span> -&gt; <span class="type">Nat</span> -&gt; <span class="type">Nat</span></span><br><span class="line"><span class="title">add</span> <span class="type">Zero</span> n = n</span><br><span class="line"><span class="title">add</span> (<span class="type">Succ</span> m) n = <span class="type">Succ</span> (add m n)</span><br><span class="line"></span><br><span class="line"><span class="title">mult</span> :: <span class="type">Nat</span> -&gt; <span class="type">Nat</span> -&gt; <span class="type">Nat</span></span><br><span class="line"><span class="title">mult</span> <span class="type">Zero</span> _ = <span class="type">Zero</span></span><br><span class="line"><span class="title">mult</span> (<span class="type">Succ</span> m) n = add (mult m n) n</span><br><span class="line"></span><br><span class="line"><span class="comment">-- *Main&gt; nat2int(mult (int2nat 2) (int2nat 3))</span></span><br><span class="line"><span class="comment">-- 6</span></span><br><span class="line"><span class="comment">-- *Main&gt; nat2int(mult (int2nat 0) (int2nat 3))</span></span><br><span class="line"><span class="comment">-- 0</span></span><br><span class="line"><span class="comment">-- *Main&gt; nat2int(mult (int2nat 1) (int2nat 3))</span></span><br><span class="line"><span class="comment">-- 3</span></span><br><span class="line"><span class="comment">-- *Main&gt; nat2int(mult (int2nat 10) (int2nat 13))</span></span><br><span class="line"><span class="comment">-- 130</span></span><br></pre></td></tr></table></figure><h4 id="é‡æ–°å®šä¹‰occurs-int-tree-bool">é‡æ–°å®šä¹‰<code>occurs :: Int -&gt; Tree -&gt; Bool</code></h4><p>éœ€è¦ä½¿ç”¨æ ‡å‡†åº“<code>data Ordering = LT | EQ | GT</code>, ä»¥åŠ<br><code>compare :: Ord =&gt; a -&gt; a -&gt; Ordering</code>ã€‚</p><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">data</span> <span class="type">Tree</span> = <span class="type">Leaf</span> <span class="type">Int</span> | <span class="type">Node</span> <span class="type">Tree</span> <span class="type">Int</span> <span class="type">Tree</span></span></span><br><span class="line"><span class="title">tr</span> :: <span class="type">Tree</span></span><br><span class="line"><span class="title">tr</span> = <span class="type">Node</span> (<span class="type">Node</span> (<span class="type">Leaf</span> <span class="number">1</span>) <span class="number">3</span> (<span class="type">Leaf</span> <span class="number">4</span>)) <span class="number">5</span> (<span class="type">Node</span> (<span class="type">Leaf</span> <span class="number">6</span>) <span class="number">7</span> (<span class="type">Leaf</span> <span class="number">9</span>))</span><br><span class="line"><span class="title">occurs</span> :: <span class="type">Int</span> -&gt; <span class="type">Tree</span> -&gt; <span class="type">Bool</span></span><br><span class="line"><span class="title">occurs</span> m (<span class="type">Leaf</span> n) = m == n</span><br><span class="line"><span class="title">occurs</span> m (<span class="type">Node</span> l n r) = <span class="keyword">case</span> compare m n <span class="keyword">of</span></span><br><span class="line">                            <span class="type">LT</span> -&gt; occurs m l</span><br><span class="line">                            <span class="type">EQ</span> -&gt; <span class="type">True</span></span><br><span class="line">                            <span class="type">GT</span> -&gt; occurs m r</span><br></pre></td></tr></table></figure><a id="more"></a><h4 id="åˆ¤æ–­å¹³è¡¡æ ‘balanced-tree-bool">åˆ¤æ–­å¹³è¡¡æ ‘<code>balanced :: Tree -&gt; Bool</code></h4><p>å¹³è¡¡æ ‘ï¼šå·¦ã€å³å­æ ‘çš„å¶å­æ•°é‡ç›¸å·®ä¸è¶…è¿‡ä¸€ä¸ª</p><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">data</span> <span class="type">Tree1</span> = <span class="type">Leaf1</span> <span class="type">Int</span> | <span class="type">Node1</span> <span class="type">Tree1</span> <span class="type">Tree1</span></span></span><br><span class="line"></span><br><span class="line"><span class="title">t1</span> :: <span class="type">Tree1</span></span><br><span class="line"><span class="title">t1</span> = <span class="type">Node1</span> (<span class="type">Node1</span> (<span class="type">Leaf1</span> <span class="number">1</span>) (<span class="type">Leaf1</span> <span class="number">4</span>)) (<span class="type">Node1</span> (<span class="type">Leaf1</span> <span class="number">6</span>) (<span class="type">Leaf1</span> <span class="number">9</span>))</span><br><span class="line"></span><br><span class="line"><span class="title">t2</span> :: <span class="type">Tree1</span></span><br><span class="line"><span class="title">t2</span> = <span class="type">Node1</span> (<span class="type">Node1</span> (<span class="type">Leaf1</span> <span class="number">1</span>) (<span class="type">Node1</span> (<span class="type">Leaf1</span> <span class="number">1</span>) (<span class="type">Leaf1</span> <span class="number">4</span>))) (<span class="type">Node1</span> (<span class="type">Leaf1</span> <span class="number">6</span>) (<span class="type">Leaf1</span> <span class="number">9</span>))</span><br><span class="line"></span><br><span class="line"><span class="title">t3</span> :: <span class="type">Tree1</span></span><br><span class="line"><span class="title">t3</span> = <span class="type">Node1</span> (<span class="type">Node1</span> (<span class="type">Leaf1</span> <span class="number">1</span>) (<span class="type">Node1</span> (<span class="type">Leaf1</span> <span class="number">1</span>) (<span class="type">Leaf1</span> <span class="number">4</span>))) (<span class="type">Leaf1</span> <span class="number">6</span>)</span><br><span class="line"><span class="title">leafs</span> :: <span class="type">Tree1</span> -&gt; <span class="type">Int</span></span><br><span class="line"><span class="title">leafs</span> (<span class="type">Leaf1</span> _) = <span class="number">1</span></span><br><span class="line"><span class="title">leafs</span> (<span class="type">Node1</span> l r) = leafs l + leafs r</span><br><span class="line"></span><br><span class="line"><span class="title">balanced</span> :: <span class="type">Tree1</span> -&gt; <span class="type">Bool</span></span><br><span class="line"><span class="title">balanced</span> (<span class="type">Leaf1</span> _) = <span class="type">True</span></span><br><span class="line"><span class="title">balanced</span> (<span class="type">Node1</span> l r) = abs (leafs l - leafs r) &lt;= <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- *Main&gt; balanced t1</span></span><br><span class="line"><span class="comment">-- True</span></span><br><span class="line"><span class="comment">-- *Main&gt; balanced t2</span></span><br><span class="line"><span class="comment">-- True</span></span><br><span class="line"><span class="comment">-- *Main&gt; balanced t3</span></span><br><span class="line"><span class="comment">-- False</span></span><br></pre></td></tr></table></figure><h4 id="æ ¹æ®listç”Ÿæˆä¸€ä¸ªå¹³è¡¡æ ‘">æ ¹æ®listç”Ÿæˆä¸€ä¸ªå¹³è¡¡æ ‘</h4><p>æ€è·¯ä¹Ÿè›®ç®€å•ï¼ŒæŠŠliståˆ†æˆä¸¤åŠï¼Œç„¶åé€’å½’å°±æˆäº†ã€‚</p><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">balance</span> :: [<span class="type">Int</span>] -&gt; <span class="type">Tree1</span></span><br><span class="line"><span class="title">balance</span> xs</span><br><span class="line">    | null xs = error <span class="string">""</span></span><br><span class="line">    | length xs == <span class="number">1</span> = <span class="type">Leaf1</span> (head xs)</span><br><span class="line">    | otherwise = <span class="type">Node1</span> (balance x) (balance y)</span><br><span class="line">                    <span class="keyword">where</span> n = length xs `div` <span class="number">2</span></span><br><span class="line">                          x = take n xs</span><br><span class="line">                          y = drop n xs</span><br><span class="line"></span><br><span class="line"><span class="title">flatten</span> :: <span class="type">Tree1</span> -&gt; [<span class="type">Int</span>]</span><br><span class="line"><span class="title">flatten</span> (<span class="type">Leaf1</span> n) = [n]</span><br><span class="line"><span class="title">flatten</span> (<span class="type">Node1</span> l r) = flatten l ++ flatten r</span><br><span class="line"></span><br><span class="line"><span class="comment">-- *Main&gt; flatten (balance [])</span></span><br><span class="line"><span class="comment">-- *** Exception:</span></span><br><span class="line"><span class="comment">-- CallStack (from HasCallStack):</span></span><br><span class="line"><span class="comment">--   error, called at ch10ex.hs:71:24 in main:Main</span></span><br><span class="line"><span class="comment">-- *Main&gt; flatten (balance [1])</span></span><br><span class="line"><span class="comment">-- [1]</span></span><br><span class="line"><span class="comment">-- *Main&gt; flatten (balance [1,2,3,4])</span></span><br><span class="line"><span class="comment">-- [1,2,3,4]</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="ä¿®æ”¹tautology-checkerä½¿ä¹‹æ”¯æŒ-disjunction-å’Œ-equivalence-è¿ç®—ç¬¦">ä¿®æ”¹Tautology checkerä½¿ä¹‹æ”¯æŒ<code>\/</code>(disjunction)å’Œ<code>&lt;=&gt;</code>(equivalence)è¿ç®—ç¬¦</h4><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">type</span> <span class="type">Assoc</span> k v = [(<span class="title">k</span>, <span class="title">v</span>)]</span></span><br><span class="line"><span class="title">find</span> :: <span class="type">Eq</span> k =&gt; k -&gt; <span class="type">Assoc</span> k v -&gt; v</span><br><span class="line"><span class="title">find</span> k t = head [v | (k', v) &lt;- t, k == k']</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">data</span> <span class="type">Prop</span> = <span class="type">Const</span> <span class="type">Bool</span></span></span><br><span class="line">          | <span class="type">Var</span> <span class="type">Char</span></span><br><span class="line">          | <span class="type">Not</span> <span class="type">Prop</span></span><br><span class="line">          | <span class="type">And</span> <span class="type">Prop</span> <span class="type">Prop</span></span><br><span class="line">          | <span class="type">Disj</span> <span class="type">Prop</span> <span class="type">Prop</span> <span class="comment">-- disjunction</span></span><br><span class="line">          | <span class="type">Equi</span> <span class="type">Prop</span> <span class="type">Prop</span> <span class="comment">-- equivalence</span></span><br><span class="line">          | <span class="type">Imply</span> <span class="type">Prop</span> <span class="type">Prop</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">type</span> <span class="type">Subst</span> = <span class="type">Assoc</span> <span class="type">Char</span> <span class="type">Bool</span></span></span><br><span class="line"><span class="comment">-- [('A', True), ('B', False)]</span></span><br><span class="line"></span><br><span class="line"><span class="title">eval</span> :: <span class="type">Subst</span> -&gt; <span class="type">Prop</span> -&gt; <span class="type">Bool</span></span><br><span class="line"><span class="title">eval</span> _ (<span class="type">Const</span> b) = b</span><br><span class="line"><span class="title">eval</span> s (<span class="type">Var</span> x) = find x s</span><br><span class="line"><span class="title">eval</span> s (<span class="type">Not</span> p) = not (eval s p)</span><br><span class="line"><span class="title">eval</span> s (<span class="type">And</span> p q) = eval s p &amp;&amp; eval s q</span><br><span class="line"><span class="title">eval</span> s (<span class="type">Disj</span> p q) = eval s p || eval s q</span><br><span class="line"><span class="title">eval</span> s (<span class="type">Equi</span> p q) = eval s p == eval s q</span><br><span class="line"><span class="title">eval</span> s (<span class="type">Imply</span> p q) = eval s p &lt;= eval s q</span><br><span class="line"></span><br><span class="line"><span class="title">vars</span> :: <span class="type">Prop</span> -&gt; <span class="type">String</span></span><br><span class="line"><span class="title">vars</span> (<span class="type">Const</span> _) = []</span><br><span class="line"><span class="title">vars</span> (<span class="type">Var</span> x) = [x]</span><br><span class="line"><span class="title">vars</span> (<span class="type">Not</span> p) = vars p</span><br><span class="line"><span class="title">vars</span> (<span class="type">And</span> p q) = vars p ++ vars q</span><br><span class="line"><span class="title">vars</span> (<span class="type">Disj</span> p q) = vars p ++ vars q</span><br><span class="line"><span class="title">vars</span> (<span class="type">Equi</span> p q) = vars p ++ vars q</span><br><span class="line"><span class="title">vars</span> (<span class="type">Imply</span> p q) = vars p ++ vars q</span><br><span class="line"></span><br><span class="line"><span class="title">bools</span> :: <span class="type">Int</span> -&gt; [[<span class="type">Bool</span>]]</span><br><span class="line"><span class="title">bools</span> <span class="number">0</span> = [[]]</span><br><span class="line"><span class="title">bools</span> n = map (<span class="type">False</span>:) bss ++ map (<span class="type">True</span>:) bss</span><br><span class="line">                    <span class="keyword">where</span> bss = bools (n - <span class="number">1</span>)</span><br><span class="line"><span class="title">rmdups</span> :: <span class="type">Eq</span> a =&gt; [a] -&gt; [a]</span><br><span class="line"><span class="title">rmdups</span> [] = []</span><br><span class="line"><span class="title">rmdups</span> (x : xs) = x : rmdups (filter (/= x) xs)</span><br><span class="line"></span><br><span class="line"><span class="title">substs</span> :: <span class="type">Prop</span> -&gt; [<span class="type">Subst</span>]</span><br><span class="line"><span class="title">substs</span> p = map (zip us) (bools (length us))</span><br><span class="line">            <span class="keyword">where</span> us = rmdups (vars p)</span><br><span class="line"><span class="title">isTaut</span> :: <span class="type">Prop</span> -&gt; <span class="type">Bool</span></span><br><span class="line"><span class="title">isTaut</span> p = and [eval s p | s &lt;- substs p]</span><br><span class="line"></span><br><span class="line"><span class="title">p1</span> :: <span class="type">Prop</span></span><br><span class="line"><span class="title">p1</span> = <span class="type">Equi</span> (<span class="type">Var</span> '<span class="type">A'</span>) (<span class="type">Not</span> (<span class="type">Var</span> '<span class="type">A'</span>))</span><br><span class="line"><span class="title">p2</span> :: <span class="type">Prop</span></span><br><span class="line"><span class="title">p2</span> = <span class="type">Equi</span> (<span class="type">Var</span> '<span class="type">A'</span>) (<span class="type">Var</span> '<span class="type">A'</span>)</span><br><span class="line"><span class="title">p3</span> :: <span class="type">Prop</span></span><br><span class="line"><span class="title">p3</span> = <span class="type">Equi</span> (<span class="type">Disj</span> (<span class="type">Not</span> (<span class="type">Var</span> '<span class="type">B'</span>)) (<span class="type">Var</span> '<span class="type">A'</span>)) (<span class="type">Disj</span> (<span class="type">Var</span> '<span class="type">A'</span>) (<span class="type">Var</span> '<span class="type">B'</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">-- p4 : (!(!(!P \/ Q) \/ P) \/ P)</span></span><br><span class="line"><span class="title">p4</span> :: <span class="type">Prop</span></span><br><span class="line"><span class="title">p4</span> = <span class="type">Disj</span> (<span class="type">Not</span> (<span class="type">Disj</span> (<span class="type">Not</span> (<span class="type">Disj</span> (<span class="type">Not</span> (<span class="type">Var</span> '<span class="type">A'</span>)) (<span class="type">Var</span> '<span class="type">B'</span>))) (<span class="type">Var</span> '<span class="type">A'</span>))) (<span class="type">Var</span> '<span class="type">A'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- *Main&gt; isTaut p1</span></span><br><span class="line"><span class="comment">-- False</span></span><br><span class="line"><span class="comment">-- *Main&gt; isTaut p2</span></span><br><span class="line"><span class="comment">-- True</span></span><br><span class="line"><span class="comment">-- *Main&gt; isTaut p3</span></span><br><span class="line"><span class="comment">-- False</span></span><br><span class="line"><span class="comment">-- *Main&gt; isTaut p4</span></span><br><span class="line"><span class="comment">-- True</span></span><br></pre></td></tr></table></figure><h4 id="æ‰©å±•abstract-machineä½¿ä¹‹æ”¯æŒä¹˜æ³•">æ‰©å±•Abstract machineä½¿ä¹‹æ”¯æŒä¹˜æ³•</h4><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 7 abstract machine</span></span><br><span class="line"><span class="class"><span class="keyword">data</span> <span class="type">Expr</span> = <span class="type">Val</span> <span class="type">Int</span> | <span class="type">Add</span> <span class="type">Expr</span> <span class="type">Expr</span> | <span class="type">Mul</span> <span class="type">Expr</span> <span class="type">Expr</span></span></span><br><span class="line"><span class="comment">-- value :: Expr -&gt; Int</span></span><br><span class="line"><span class="comment">-- value (Val n) = n</span></span><br><span class="line"><span class="comment">-- value (Add x y) = value x + value y</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">type</span> <span class="type">Cont</span> = [<span class="type">Op</span>]</span></span><br><span class="line"><span class="class"><span class="keyword">data</span> <span class="type">Op</span> = <span class="type">EVALADD</span> <span class="type">Expr</span> | <span class="type">EVALMUL</span> <span class="type">Expr</span> | <span class="type">ADD</span> <span class="type">Int</span> | <span class="type">MUL</span> <span class="type">Int</span></span></span><br><span class="line"></span><br><span class="line"><span class="title">eval</span> :: <span class="type">Expr</span> -&gt; <span class="type">Cont</span> -&gt; <span class="type">Int</span></span><br><span class="line"><span class="title">eval</span> (<span class="type">Val</span> n) c = exec c n</span><br><span class="line"><span class="title">eval</span> (<span class="type">Add</span> x y) c = eval x (<span class="type">EVALADD</span> y : c)</span><br><span class="line"><span class="title">eval</span> (<span class="type">Mul</span> x y) c = eval x (<span class="type">EVALMUL</span> y : c)</span><br><span class="line"></span><br><span class="line"><span class="title">exec</span> :: <span class="type">Cont</span> -&gt; <span class="type">Int</span> -&gt; <span class="type">Int</span></span><br><span class="line"><span class="title">exec</span> [] n = n</span><br><span class="line"><span class="title">exec</span> (<span class="type">EVALADD</span> y : c) n = eval y (<span class="type">ADD</span> n : c)</span><br><span class="line"><span class="title">exec</span> (<span class="type">EVALMUL</span> y : c) n = eval y (<span class="type">MUL</span> n : c)</span><br><span class="line"><span class="title">exec</span> (<span class="type">ADD</span> n : c) m = exec c (n + m)</span><br><span class="line"><span class="title">exec</span> (<span class="type">MUL</span> n : c) m = exec c (n * m)</span><br><span class="line"></span><br><span class="line"><span class="title">value</span> :: <span class="type">Expr</span> -&gt; <span class="type">Int</span></span><br><span class="line"><span class="title">value</span> e = eval e []</span><br><span class="line"></span><br><span class="line"><span class="title">p1</span> :: <span class="type">Expr</span></span><br><span class="line"><span class="title">p1</span> = <span class="type">Add</span> (<span class="type">Mul</span> (<span class="type">Val</span> <span class="number">3</span>) (<span class="type">Val</span> <span class="number">2</span>)) (<span class="type">Val</span> <span class="number">5</span>) <span class="comment">-- 3 * 2 + 5</span></span><br><span class="line"></span><br><span class="line"><span class="title">p2</span> :: <span class="type">Expr</span></span><br><span class="line"><span class="title">p2</span> = <span class="type">Add</span> (<span class="type">Mul</span> (<span class="type">Val</span> <span class="number">3</span>) (<span class="type">Add</span> (<span class="type">Val</span> <span class="number">3</span>) (<span class="type">Val</span> <span class="number">2</span>))) (<span class="type">Val</span> <span class="number">1</span>) <span class="comment">-- 3 * (3 + 2) + 1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- *Main&gt; value p2</span></span><br><span class="line"><span class="comment">-- 16</span></span><br><span class="line"><span class="comment">-- *Main&gt; value p1</span></span><br><span class="line"><span class="comment">-- 11</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;em&gt;Programming in Haskell&lt;/em&gt;æ˜¯ä¸€æœ¬å…¥é—¨Haskellçš„å¥½ä¹¦ï¼Œä»‹ç»é¡µé¢ä»¥åŠé…å¥—çš„slides, vedios, codeséƒ½åœ¨&lt;a href=&quot;http://www.cs.nott.ac.uk/~pszgmh/book.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;è¿™é‡Œ&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;ç¬¬ä¹ç« çš„ä¹ é¢˜æš‚æ—¶è·³è¿‡äº†ï¼Œå…ˆæ›´ç¬¬åç« ã€‚&lt;br&gt;
å¼€å­¦äº†ï¼Œäº‹æƒ…å¤šäº†èµ·æ¥ï¼Œè¿˜è¦æ‰¾å·¥ä½œï¼ŒåŠ æŠŠåŠ²æœ€è¿‘æŠŠè¿™æœ¬ä¹¦åˆ·å®Œå§ï¼:P&lt;/p&gt;
&lt;p&gt;å…¶å®ä»ç¬¬8ç« å¼€å§‹ï¼Œè¿™æœ¬ä¹¦å¯¹äºmonadå°±è®²çš„å¤ªå°‘ï¼Œè¿‡å‡ å¤©è¿™æœ¬ä¹¦è¦å‡ºç¬¬äºŒç‰ˆï¼Œå¸Œæœ›èƒ½åœ¨è¿™æ–¹é¢æ”¹è¿›æ”¹è¿›ã€‚ã€‚ã€‚&lt;br&gt;
æˆ‘ä¸‹å•äº†ä¸€æœ¬ã€ŠHaskellè¶£å­¦æŒ‡å—ã€‹ï¼Œæ‰“ç®—ç»“åˆèµ·æ¥çœ‹ï¼Œç„¶åå†è¡¥ä¸Šè·³è¿‡çš„ä¹ é¢˜ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h4 id=&quot;å®šä¹‰å‡½æ•°-mult-nat-nat-nat&quot;&gt;å®šä¹‰å‡½æ•° mult :: Nat -&amp;gt; Nat -&amp;gt; Nat&lt;/h4&gt;
&lt;figure class=&quot;highlight haskell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;type&quot;&gt;Nat&lt;/span&gt; = &lt;span class=&quot;type&quot;&gt;Zero&lt;/span&gt; | &lt;span class=&quot;type&quot;&gt;Succ&lt;/span&gt; &lt;span class=&quot;type&quot;&gt;Nat&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;nat2int&lt;/span&gt; :: &lt;span class=&quot;type&quot;&gt;Nat&lt;/span&gt; -&amp;gt; &lt;span class=&quot;type&quot;&gt;Int&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;nat2int&lt;/span&gt; &lt;span class=&quot;type&quot;&gt;Zero&lt;/span&gt; = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;nat2int&lt;/span&gt; (&lt;span class=&quot;type&quot;&gt;Succ&lt;/span&gt; n) = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; + nat2int n&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;int2nat&lt;/span&gt; :: &lt;span class=&quot;type&quot;&gt;Int&lt;/span&gt; -&amp;gt; &lt;span class=&quot;type&quot;&gt;Nat&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;int2nat&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; = &lt;span class=&quot;type&quot;&gt;Zero&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;int2nat&lt;/span&gt; n = &lt;span class=&quot;type&quot;&gt;Succ&lt;/span&gt; (int2nat (n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;add&lt;/span&gt; :: &lt;span class=&quot;type&quot;&gt;Nat&lt;/span&gt; -&amp;gt; &lt;span class=&quot;type&quot;&gt;Nat&lt;/span&gt; -&amp;gt; &lt;span class=&quot;type&quot;&gt;Nat&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;add&lt;/span&gt; &lt;span class=&quot;type&quot;&gt;Zero&lt;/span&gt; n = n&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;add&lt;/span&gt; (&lt;span class=&quot;type&quot;&gt;Succ&lt;/span&gt; m) n = &lt;span class=&quot;type&quot;&gt;Succ&lt;/span&gt; (add m n)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;mult&lt;/span&gt; :: &lt;span class=&quot;type&quot;&gt;Nat&lt;/span&gt; -&amp;gt; &lt;span class=&quot;type&quot;&gt;Nat&lt;/span&gt; -&amp;gt; &lt;span class=&quot;type&quot;&gt;Nat&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;mult&lt;/span&gt; &lt;span class=&quot;type&quot;&gt;Zero&lt;/span&gt; _ = &lt;span class=&quot;type&quot;&gt;Zero&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;mult&lt;/span&gt; (&lt;span class=&quot;type&quot;&gt;Succ&lt;/span&gt; m) n = add (mult m n) n&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- *Main&amp;gt; nat2int(mult (int2nat 2) (int2nat 3))&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- 6&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- *Main&amp;gt; nat2int(mult (int2nat 0) (int2nat 3))&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- 0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- *Main&amp;gt; nat2int(mult (int2nat 1) (int2nat 3))&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- 3&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- *Main&amp;gt; nat2int(mult (int2nat 10) (int2nat 13))&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- 130&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;é‡æ–°å®šä¹‰occurs-int-tree-bool&quot;&gt;é‡æ–°å®šä¹‰&lt;code&gt;occurs :: Int -&amp;gt; Tree -&amp;gt; Bool&lt;/code&gt;&lt;/h4&gt;
&lt;p&gt;éœ€è¦ä½¿ç”¨æ ‡å‡†åº“&lt;code&gt;data Ordering = LT | EQ | GT&lt;/code&gt;, ä»¥åŠ&lt;br&gt;
&lt;code&gt;compare :: Ord =&amp;gt; a -&amp;gt; a -&amp;gt; Ordering&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight haskell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;type&quot;&gt;Tree&lt;/span&gt; = &lt;span class=&quot;type&quot;&gt;Leaf&lt;/span&gt; &lt;span class=&quot;type&quot;&gt;Int&lt;/span&gt; | &lt;span class=&quot;type&quot;&gt;Node&lt;/span&gt; &lt;span class=&quot;type&quot;&gt;Tree&lt;/span&gt; &lt;span class=&quot;type&quot;&gt;Int&lt;/span&gt; &lt;span class=&quot;type&quot;&gt;Tree&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;tr&lt;/span&gt; :: &lt;span class=&quot;type&quot;&gt;Tree&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;tr&lt;/span&gt; = &lt;span class=&quot;type&quot;&gt;Node&lt;/span&gt; (&lt;span class=&quot;type&quot;&gt;Node&lt;/span&gt; (&lt;span class=&quot;type&quot;&gt;Leaf&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt; (&lt;span class=&quot;type&quot;&gt;Leaf&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;)) &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt; (&lt;span class=&quot;type&quot;&gt;Node&lt;/span&gt; (&lt;span class=&quot;type&quot;&gt;Leaf&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;6&lt;/span&gt;) &lt;span class=&quot;number&quot;&gt;7&lt;/span&gt; (&lt;span class=&quot;type&quot;&gt;Leaf&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;9&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;occurs&lt;/span&gt; :: &lt;span class=&quot;type&quot;&gt;Int&lt;/span&gt; -&amp;gt; &lt;span class=&quot;type&quot;&gt;Tree&lt;/span&gt; -&amp;gt; &lt;span class=&quot;type&quot;&gt;Bool&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;occurs&lt;/span&gt; m (&lt;span class=&quot;type&quot;&gt;Leaf&lt;/span&gt; n) = m == n&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;occurs&lt;/span&gt; m (&lt;span class=&quot;type&quot;&gt;Node&lt;/span&gt; l n r) = &lt;span class=&quot;keyword&quot;&gt;case&lt;/span&gt; compare m n &lt;span class=&quot;keyword&quot;&gt;of&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                            &lt;span class=&quot;type&quot;&gt;LT&lt;/span&gt; -&amp;gt; occurs m l&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                            &lt;span class=&quot;type&quot;&gt;EQ&lt;/span&gt; -&amp;gt; &lt;span class=&quot;type&quot;&gt;True&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                            &lt;span class=&quot;type&quot;&gt;GT&lt;/span&gt; -&amp;gt; occurs m r&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="Haskell" scheme="http://duanyifu.com/categories/Haskell/"/>
    
    
      <category term="Haskell" scheme="http://duanyifu.com/tags/Haskell/"/>
    
      <category term="Programming in Haskell" scheme="http://duanyifu.com/tags/Programming-in-Haskell/"/>
    
  </entry>
  
  <entry>
    <title>Programming in Haskell Chapter8 Exercises Solutions</title>
    <link href="http://duanyifu.com/2016/09/08/PIHex8/"/>
    <id>http://duanyifu.com/2016/09/08/PIHex8/</id>
    <published>2016-09-08T13:24:24.000Z</published>
    <updated>2016-09-13T19:49:28.000Z</updated>
    
    <content type="html"><![CDATA[<p><em>Programming in Haskell</em>æ˜¯ä¸€æœ¬å…¥é—¨Haskellçš„å¥½ä¹¦ï¼Œä»‹ç»é¡µé¢ä»¥åŠé…å¥—çš„slides, vedios, codeséƒ½åœ¨<a href="http://www.cs.nott.ac.uk/~pszgmh/book.html" target="_blank" rel="noopener">è¿™é‡Œ</a>ã€‚</p><hr><p>è¿™ç« ä¿¡æ¯é‡ç®€ç›´çˆ†ç‚¸ï¼Œä¹¦ä¸Šç»™çš„ä¸œè¥¿å¤ªå°‘äº†ï¼Œè®²çš„åˆå¤ªå¤šäº†ã€‚æ‰¾äº†ä¸€å †èµ„æ–™çœ‹äº†å¥½ä¹…æ‰å¼„æ˜ç™½ã€‚</p><p>ç»“åˆçš„å‚è€ƒèµ„æ–™å¦‚ä¸‹ï¼š<br><a href="http://channel9.msdn.com/Series/C9-Lectures-Erik-Meijer-Functional-Programming-Fundamentals/C9-Lectures-Dr-Erik-Meijer-Functional-Programming-Fundamentals-Chapter-8-of-13" target="_blank" rel="noopener">Chapter8è®²è¯¾è§†é¢‘</a><br><a href="http://www.cs.uwyo.edu/~jlc/courses/3015/parser_pearl.pdf" target="_blank" rel="noopener">Monadic Parsing in Haskell</a><br><a href="http://stackoverflow.com/questions/2607498/programming-in-haskell-error-in-sat-function" target="_blank" rel="noopener">â€œProgramming In Haskellâ€ error in sat function</a></p><p>æŒ‰ç…§ä¹¦ä¸Šçš„<code>Parser</code>å®šä¹‰ï¼Œæ˜¯æ²¡æ³•ä½¿ç”¨do notationçš„ï¼Œæ‰€ä»¥ä¸‹é¢çš„ä¹ é¢˜å…¨éƒ¨ç”¨<code>&gt;&gt;=</code>å®Œæˆã€‚</p><p>å®Œæ•´çš„ä»£ç æˆ‘æ”¾åœ¨<a href="https://gist.github.com/mistwave/b48c517e18436f6ac8fe350de929ee6a" target="_blank" rel="noopener">è¿™é‡Œ</a>ã€‚</p><hr><h4 id="int-parser-int"><code>int :: Parser Int</code></h4><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">int</span> :: <span class="type">Parser</span> <span class="type">Int</span></span><br><span class="line"><span class="title">int</span> = natural +++</span><br><span class="line">      (symbol <span class="string">"-"</span> &gt;&gt;= \_ -&gt;</span><br><span class="line">       natural &gt;&gt;= \x -&gt;</span><br><span class="line">       return (-x))</span><br><span class="line"></span><br><span class="line"><span class="comment">-- *Main&gt; parse int "123da"</span></span><br><span class="line"><span class="comment">-- [(123,"da")]</span></span><br><span class="line"><span class="comment">-- *Main&gt; parse int "sdada"</span></span><br><span class="line"><span class="comment">-- []</span></span><br><span class="line"><span class="comment">-- *Main&gt; parse int "-213sdada"</span></span><br><span class="line"><span class="comment">-- [(-213,"sdada")]</span></span><br></pre></td></tr></table></figure><h4 id="comment-parser"><code>comment :: Parser ()</code></h4><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">comment</span> :: <span class="type">Parser</span> ()</span><br><span class="line"><span class="title">comment</span> = symbol <span class="string">"--"</span> &gt;&gt;= \_ -&gt;</span><br><span class="line">          many (sat (/= '\n')) &gt;&gt;= \_ -&gt;</span><br><span class="line">          many (char '\n') &gt;&gt;= \_ -&gt;</span><br><span class="line">          return ()  <span class="comment">-- why return ()?</span></span><br><span class="line"><span class="comment">-- *Main&gt; parse comment "foo"</span></span><br><span class="line"><span class="comment">-- []</span></span><br><span class="line"><span class="comment">-- *Main&gt; parse comment "--foo"</span></span><br><span class="line"><span class="comment">-- [((),"")]</span></span><br><span class="line"><span class="comment">-- *Main&gt; parse comment "--foo\nbar"</span></span><br><span class="line"><span class="comment">-- [((),"bar")]</span></span><br></pre></td></tr></table></figure><a id="more"></a><h4 id="æ‰©å±•arithmetic-expressions-parser">æ‰©å±•arithmetic expressions parser</h4><p>è¿™é‡Œä¸€ä¸ªå‘å°±æ˜¯åœ¨äºå¤„ç†<code>8 / 2 / 2 / 2</code>ï¼Œ<code>1 - 2 - 3 - 4</code>è¿™ç§æƒ…å†µï¼Œå¦‚æœæ¨¡ä»¿<code>+</code>, <code>*</code>ï¼Œçš„å®ç°ï¼Œå¾ˆé”™è¯¯åœ°å®¹æ˜“æŠŠ<code>8 / 2 / 2 / 2</code>parseæˆ<code>(8 / 2) / (2 / 2)</code>ã€‚</p><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">-- new gramma rules:</span></span><br><span class="line"><span class="comment">-- expr   ::= term (+ expr | - expr | &lt;E&gt;)</span></span><br><span class="line"><span class="comment">-- term   ::= power (* term | / term | &lt;E&gt;)</span></span><br><span class="line"><span class="comment">-- power  ::= factor (^ power | &lt;E&gt;)</span></span><br><span class="line"><span class="comment">-- factor ::= (expr) | nat</span></span><br><span class="line"><span class="comment">-- nat    ::= 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- !! WRONG:</span></span><br><span class="line"><span class="comment">-- (symbol "-" &gt;&gt;= \_ -&gt;</span></span><br><span class="line"><span class="comment">--  expr &gt;&gt;= \e -&gt;</span></span><br><span class="line"><span class="comment">--  return (ex - e))</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- (symbol "/" &gt;&gt;= \_ -&gt;</span></span><br><span class="line"><span class="comment">--  term &gt;&gt;= \t -&gt;</span></span><br><span class="line"><span class="comment">--  return (f `div` t))</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title">expr</span> :: <span class="type">Parser</span> <span class="type">Int</span></span><br><span class="line"><span class="title">expr</span> = term &gt;&gt;= \t -&gt;</span><br><span class="line">       (symbol <span class="string">"+"</span> &gt;&gt;= \_ -&gt;</span><br><span class="line">        expr       &gt;&gt;= \e -&gt;</span><br><span class="line">        return (t + e))</span><br><span class="line">       +++</span><br><span class="line">       (many (symbol <span class="string">"-"</span> &gt;&gt;= \_ -&gt;</span><br><span class="line">              term       &gt;&gt;= \n -&gt;</span><br><span class="line">              return n)  &gt;&gt;= \ss -&gt;</span><br><span class="line">        return (foldl (-) t ss))</span><br><span class="line">       +++</span><br><span class="line">       return t</span><br><span class="line"></span><br><span class="line"><span class="title">term</span> :: <span class="type">Parser</span> <span class="type">Int</span></span><br><span class="line"><span class="title">term</span> = power &gt;&gt;= \p -&gt;</span><br><span class="line">       (symbol <span class="string">"*"</span> &gt;&gt;= \_ -&gt;</span><br><span class="line">        term       &gt;&gt;= \t -&gt;</span><br><span class="line">        return (p * t))</span><br><span class="line">       +++</span><br><span class="line">       (many (symbol <span class="string">"/"</span> &gt;&gt;= \_ -&gt;</span><br><span class="line">              power      &gt;&gt;= \t -&gt;</span><br><span class="line">              return t)  &gt;&gt;= \ss -&gt;</span><br><span class="line">        return (foldl div p ss))</span><br><span class="line">       +++</span><br><span class="line">       return p</span><br><span class="line"></span><br><span class="line"><span class="title">power</span> :: <span class="type">Parser</span> <span class="type">Int</span></span><br><span class="line"><span class="title">power</span> = factor &gt;&gt;= \f -&gt;</span><br><span class="line">        (symbol <span class="string">"^"</span> &gt;&gt;= \_ -&gt;</span><br><span class="line">         power      &gt;&gt;= \p -&gt;</span><br><span class="line">         return (f ^ p))</span><br><span class="line">        +++ return f</span><br><span class="line"></span><br><span class="line"><span class="title">factor</span> :: <span class="type">Parser</span> <span class="type">Int</span></span><br><span class="line"><span class="title">factor</span> = (symbol <span class="string">"("</span> &gt;&gt;= \_ -&gt;</span><br><span class="line">          expr       &gt;&gt;= \e -&gt;</span><br><span class="line">          symbol <span class="string">")"</span> &gt;&gt;= \_ -&gt;</span><br><span class="line">          return e)</span><br><span class="line">         +++ natural</span><br><span class="line"></span><br><span class="line"><span class="title">eval</span> :: <span class="type">String</span> -&gt; <span class="type">Int</span></span><br><span class="line"><span class="title">eval</span> xs = <span class="keyword">case</span> parse expr xs <span class="keyword">of</span></span><br><span class="line">            [(n, [])] -&gt; n</span><br><span class="line">            [(_, out)] -&gt; error(<span class="string">"unused input "</span> ++ out)</span><br><span class="line">            [] -&gt; error <span class="string">"invalid input"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- *Main&gt; eval "2^3"</span></span><br><span class="line"><span class="comment">-- 8</span></span><br><span class="line"><span class="comment">-- *Main&gt; eval "2*3 ^ 4"</span></span><br><span class="line"><span class="comment">-- 1296</span></span><br><span class="line"><span class="comment">-- *Main&gt; eval "2 ^ 3 * 4"</span></span><br><span class="line"><span class="comment">-- 4096</span></span><br><span class="line"><span class="comment">-- *Main&gt; eval "2 + 2^ 2"</span></span><br><span class="line"><span class="comment">-- 6</span></span><br><span class="line"><span class="comment">-- *Main&gt; eval "2^2^2"</span></span><br><span class="line"><span class="comment">-- 16</span></span><br><span class="line"><span class="comment">-- *Main&gt; eval "8-2-2-2"</span></span><br><span class="line"><span class="comment">-- 2</span></span><br><span class="line"><span class="comment">-- *Main&gt; eval "16 /2/2/2"</span></span><br><span class="line"><span class="comment">-- 2</span></span><br></pre></td></tr></table></figure><h4 id="è€ƒè™‘expr-expr-nat-natçš„parser">è€ƒè™‘<code>expr ::= expr - nat | nat</code>çš„parser</h4><p>è¦æ³¨æ„çš„ç‚¹åœ¨å’Œä¸Šä¸€é¢˜æ˜¯ä¸€æ ·çš„.</p><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- expr'  ::= expr' - nat | nat</span></span><br><span class="line"><span class="comment">-- nat    ::= 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9</span></span><br><span class="line"></span><br><span class="line"><span class="title">expr'</span> :: <span class="type">Parser</span> <span class="type">Int</span></span><br><span class="line"><span class="title">expr'</span> = natural &gt;&gt;= \n -&gt;</span><br><span class="line">        many (symbol <span class="string">"-"</span> &gt;&gt;= \_ -&gt; natural) &gt;&gt;= \ns -&gt;</span><br><span class="line">        return (foldl (-) n ns)</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;em&gt;Programming in Haskell&lt;/em&gt;æ˜¯ä¸€æœ¬å…¥é—¨Haskellçš„å¥½ä¹¦ï¼Œä»‹ç»é¡µé¢ä»¥åŠé…å¥—çš„slides, vedios, codeséƒ½åœ¨&lt;a href=&quot;http://www.cs.nott.ac.uk/~pszgmh/book.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;è¿™é‡Œ&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;è¿™ç« ä¿¡æ¯é‡ç®€ç›´çˆ†ç‚¸ï¼Œä¹¦ä¸Šç»™çš„ä¸œè¥¿å¤ªå°‘äº†ï¼Œè®²çš„åˆå¤ªå¤šäº†ã€‚æ‰¾äº†ä¸€å †èµ„æ–™çœ‹äº†å¥½ä¹…æ‰å¼„æ˜ç™½ã€‚&lt;/p&gt;
&lt;p&gt;ç»“åˆçš„å‚è€ƒèµ„æ–™å¦‚ä¸‹ï¼š&lt;br&gt;
&lt;a href=&quot;http://channel9.msdn.com/Series/C9-Lectures-Erik-Meijer-Functional-Programming-Fundamentals/C9-Lectures-Dr-Erik-Meijer-Functional-Programming-Fundamentals-Chapter-8-of-13&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Chapter8è®²è¯¾è§†é¢‘&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://www.cs.uwyo.edu/~jlc/courses/3015/parser_pearl.pdf&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Monadic Parsing in Haskell&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;http://stackoverflow.com/questions/2607498/programming-in-haskell-error-in-sat-function&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;â€œProgramming In Haskellâ€ error in sat function&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æŒ‰ç…§ä¹¦ä¸Šçš„&lt;code&gt;Parser&lt;/code&gt;å®šä¹‰ï¼Œæ˜¯æ²¡æ³•ä½¿ç”¨do notationçš„ï¼Œæ‰€ä»¥ä¸‹é¢çš„ä¹ é¢˜å…¨éƒ¨ç”¨&lt;code&gt;&amp;gt;&amp;gt;=&lt;/code&gt;å®Œæˆã€‚&lt;/p&gt;
&lt;p&gt;å®Œæ•´çš„ä»£ç æˆ‘æ”¾åœ¨&lt;a href=&quot;https://gist.github.com/mistwave/b48c517e18436f6ac8fe350de929ee6a&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;è¿™é‡Œ&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h4 id=&quot;int-parser-int&quot;&gt;&lt;code&gt;int :: Parser Int&lt;/code&gt;&lt;/h4&gt;
&lt;figure class=&quot;highlight haskell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;int&lt;/span&gt; :: &lt;span class=&quot;type&quot;&gt;Parser&lt;/span&gt; &lt;span class=&quot;type&quot;&gt;Int&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;int&lt;/span&gt; = natural +++&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      (symbol &lt;span class=&quot;string&quot;&gt;&quot;-&quot;&lt;/span&gt; &amp;gt;&amp;gt;= \_ -&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       natural &amp;gt;&amp;gt;= \x -&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       return (-x))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- *Main&amp;gt; parse int &quot;123da&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- [(123,&quot;da&quot;)]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- *Main&amp;gt; parse int &quot;sdada&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- []&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- *Main&amp;gt; parse int &quot;-213sdada&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- [(-213,&quot;sdada&quot;)]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;comment-parser&quot;&gt;&lt;code&gt;comment :: Parser ()&lt;/code&gt;&lt;/h4&gt;
&lt;figure class=&quot;highlight haskell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;comment&lt;/span&gt; :: &lt;span class=&quot;type&quot;&gt;Parser&lt;/span&gt; ()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;comment&lt;/span&gt; = symbol &lt;span class=&quot;string&quot;&gt;&quot;--&quot;&lt;/span&gt; &amp;gt;&amp;gt;= \_ -&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          many (sat (/= &#39;\n&#39;)) &amp;gt;&amp;gt;= \_ -&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          many (char &#39;\n&#39;) &amp;gt;&amp;gt;= \_ -&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          return ()  &lt;span class=&quot;comment&quot;&gt;-- why return ()?&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- *Main&amp;gt; parse comment &quot;foo&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- []&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- *Main&amp;gt; parse comment &quot;--foo&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- [((),&quot;&quot;)]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- *Main&amp;gt; parse comment &quot;--foo\nbar&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- [((),&quot;bar&quot;)]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="Haskell" scheme="http://duanyifu.com/categories/Haskell/"/>
    
    
      <category term="Haskell" scheme="http://duanyifu.com/tags/Haskell/"/>
    
      <category term="Programming in Haskell" scheme="http://duanyifu.com/tags/Programming-in-Haskell/"/>
    
  </entry>
  
  <entry>
    <title>Programming in Haskell Chapter7 Exercises Solutions</title>
    <link href="http://duanyifu.com/2016/08/31/PIHex7/"/>
    <id>http://duanyifu.com/2016/08/31/PIHex7/</id>
    <published>2016-08-31T13:14:51.000Z</published>
    <updated>2016-09-04T13:23:12.000Z</updated>
    
    <content type="html"><![CDATA[<p><em>Programming in Haskell</em>æ˜¯ä¸€æœ¬å…¥é—¨Haskellçš„å¥½ä¹¦ï¼Œä»‹ç»é¡µé¢ä»¥åŠé…å¥—çš„slides, vedios, codeséƒ½åœ¨<a href="http://www.cs.nott.ac.uk/~pszgmh/book.html" target="_blank" rel="noopener">è¿™é‡Œ</a>ã€‚</p><hr><h4 id="ç”¨mapå’Œfilterè¡¨ç¤º-f-x-x-xs-p-x">ç”¨<code>map</code>å’Œ<code>filter</code>è¡¨ç¤º<code>[f x | x &lt;- xs, p x]</code></h4><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- [f x | x &lt;- xs, p x]</span></span><br><span class="line"><span class="comment">-- [f x | x &lt;- xs, p x]</span></span><br><span class="line"><span class="comment">-- = map f (filter p xs)</span></span><br></pre></td></tr></table></figure><h4 id="å®šä¹‰é«˜é˜¶å‡½æ•°all-any-takewhile-dropwhile">å®šä¹‰é«˜é˜¶å‡½æ•°<code>all</code>, <code>any</code>, <code>takeWhile</code>, <code>dropWhile</code></h4><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">myall</span> :: (a -&gt; <span class="type">Bool</span>) -&gt; [a] -&gt; <span class="type">Bool</span></span><br><span class="line"><span class="title">myall</span> _ [] = <span class="type">True</span></span><br><span class="line"><span class="title">myall</span> p (x : xs) | p x == <span class="type">False</span> = <span class="type">False</span></span><br><span class="line">                 | otherwise = myall p xs</span><br><span class="line"></span><br><span class="line"><span class="comment">-- *Main&gt; myall (&gt;3) [1..3]</span></span><br><span class="line"><span class="comment">-- False</span></span><br><span class="line"><span class="comment">-- *Main&gt; myall (&gt;3) [1..5]</span></span><br><span class="line"><span class="comment">-- False</span></span><br><span class="line"><span class="comment">-- *Main&gt; myall (&gt;3) [4..5]</span></span><br><span class="line"><span class="comment">-- True</span></span><br><span class="line"></span><br><span class="line"><span class="title">myany</span> :: (a -&gt; <span class="type">Bool</span>) -&gt; [a] -&gt; <span class="type">Bool</span></span><br><span class="line"><span class="title">myany</span> _ [] = <span class="type">False</span></span><br><span class="line"><span class="title">myany</span> p (x : xs) | p x == <span class="type">True</span> = <span class="type">True</span></span><br><span class="line">                 | otherwise = myany p xs</span><br><span class="line"></span><br><span class="line"><span class="comment">-- *Main&gt; myany (&gt;3) [1..5]</span></span><br><span class="line"><span class="comment">-- True</span></span><br><span class="line"><span class="comment">-- *Main&gt; myany (&gt;3) [1..3]</span></span><br><span class="line"><span class="comment">-- False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title">mytakeWhile</span> :: (a -&gt; <span class="type">Bool</span>) -&gt; [a] -&gt; [a]</span><br><span class="line"><span class="title">mytakeWhile</span> _ [] = []</span><br><span class="line"><span class="title">mytakeWhile</span> p (x : xs) | p x == <span class="type">True</span> = x : mytakeWhile p xs</span><br><span class="line">                       | otherwise = []</span><br><span class="line"></span><br><span class="line"><span class="comment">-- *Main&gt; mytakeWhile (&lt;3) [1..5]</span></span><br><span class="line"><span class="comment">-- [1,2]</span></span><br><span class="line"><span class="comment">-- *Main&gt; mytakeWhile (&gt;3) [1..5]</span></span><br><span class="line"><span class="comment">-- []</span></span><br><span class="line"><span class="comment">-- *Main&gt; mytakeWhile (&lt;3) [1,2,3,1,2]</span></span><br><span class="line"><span class="comment">-- [1,2]</span></span><br><span class="line"></span><br><span class="line"><span class="title">mydropWhile</span> :: (a -&gt; <span class="type">Bool</span>) -&gt; [a] -&gt; [a]</span><br><span class="line"><span class="title">mydropWhile</span> _ [] = []</span><br><span class="line"><span class="title">mydropWhile</span> p (x : xs) | p x == <span class="type">True</span> = mydropWhile p xs</span><br><span class="line">                       | otherwise = x : xs</span><br><span class="line"></span><br><span class="line"><span class="comment">-- *Main&gt; mydropWhile (&lt;3) [1..5]</span></span><br><span class="line"><span class="comment">-- [3,4,5]</span></span><br><span class="line"><span class="comment">-- *Main&gt; mydropWhile (&gt;3) [1..5]</span></span><br><span class="line"><span class="comment">-- [1,2,3,4,5]</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><a id="more"></a><h4 id="ç”¨foldrå®šä¹‰map-få’Œfilter-p">ç”¨<code>foldr</code>å®šä¹‰<code>map f</code>å’Œ<code>filter p</code></h4><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">mymap</span> f = foldr (\x xs -&gt; f x : xs) []</span><br><span class="line"></span><br><span class="line"><span class="comment">-- *Main&gt; mymap (*3) [1..6]</span></span><br><span class="line"><span class="comment">-- [3,6,9,12,15,18]</span></span><br><span class="line"><span class="title">myfilter</span> p = foldr (\x xs -&gt; <span class="keyword">if</span> p x <span class="keyword">then</span> x : xs <span class="keyword">else</span> xs) []</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="ç”¨foldlå®šä¹‰dec2int-int-int">ç”¨<code>foldl</code>å®šä¹‰<code>dec2int :: [Int] -&gt; Int</code></h4><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">dec2int</span> :: [<span class="type">Int</span>] -&gt; <span class="type">Int</span></span><br><span class="line"><span class="title">dec2int</span> = foldl (\x y -&gt; x * <span class="number">10</span> + y) <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- *Main&gt; dec2int [2,3,4,5]</span></span><br><span class="line"><span class="comment">-- 2345</span></span><br><span class="line"><span class="comment">-- *Main&gt; dec2int [2]</span></span><br><span class="line"><span class="comment">-- 2</span></span><br><span class="line"><span class="comment">-- *Main&gt; dec2int []</span></span><br><span class="line"><span class="comment">-- 0</span></span><br></pre></td></tr></table></figure><h4 id="ä¿®æ”¹é”™è¯¯ï¼šsumsqreven-compose-sum-map-2-filter-even">ä¿®æ”¹é”™è¯¯ï¼š<code>sumsqreven = compose [sum, map (^2), filter even]</code></h4><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">compose</span> = foldr (.) id</span><br><span class="line"></span><br><span class="line"><span class="title">sumsqreven</span> xs = sum (compose [map (^<span class="number">2</span>), filter even] xs)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="curry-uncurry"><code>curry</code> &amp; <code>uncurry</code></h4><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 6</span></span><br><span class="line"></span><br><span class="line"><span class="title">mycurry</span> :: ((a, b) -&gt; c) -&gt; (a -&gt; b -&gt; c)</span><br><span class="line"><span class="title">mycurry</span> f = \x y -&gt; f (x, y)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title">myuncurry</span> :: (a -&gt; b -&gt; c) -&gt; ((a, b) -&gt; c)</span><br><span class="line"><span class="title">myuncurry</span> f = \(x, y) -&gt; f x y</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="åˆ©ç”¨unfoldå®šä¹‰chop8-map-f-iterate-f">åˆ©ç”¨<code>unfold</code>å®šä¹‰<code>chop8</code>, <code>map f</code>, <code>iterate f</code></h4><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">unfold</span> p h t x | p x = []</span><br><span class="line">               | otherwise = h x : unfold p h t (t x)</span><br><span class="line"></span><br><span class="line"><span class="title">int2bin'</span> = unfold (== <span class="number">0</span>) (`mod` <span class="number">2</span>) (`div` <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="title">chop8'</span> :: [<span class="type">Int</span>] -&gt; [[<span class="type">Int</span>]]</span><br><span class="line"><span class="title">chop8'</span> = unfold (== []) (take <span class="number">8</span>) (drop <span class="number">8</span>)</span><br><span class="line"></span><br><span class="line"><span class="title">mymap'</span> f = unfold (== []) (f.head) tail</span><br><span class="line"></span><br><span class="line"><span class="title">myiterate</span> f = unfold (\_ -&gt; <span class="type">False</span>) id f</span><br></pre></td></tr></table></figure><h4 id="ç»™string-transmitterç¨‹åºåŠ ä¸Šå¥‡å¶æ ¡éªŒä½-parity-bit">ç»™string transmitterç¨‹åºåŠ ä¸Šå¥‡å¶æ ¡éªŒä½ï¼ˆparity bitï¼‰</h4><p>æˆ‘è¿™é‡Œæ˜¯åœ¨æ•°æ®ä½çš„æœ«ç«¯æ·»åŠ çš„ï¼Œå¥‡æ•°ä¸ª1åˆ™ä¸º1ï¼Œå¦åˆ™ä¸º0ã€‚</p><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 8</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- import Data.Char</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">type</span> <span class="type">Bit</span> = <span class="type">Int</span></span></span><br><span class="line"></span><br><span class="line"><span class="title">bin2int</span> :: [<span class="type">Bit</span>] -&gt; <span class="type">Int</span></span><br><span class="line"><span class="comment">-- bin2int bits = sum [w * b | (w, b) &lt;- zip weights bits]</span></span><br><span class="line"><span class="comment">--                 where weights = iterate (*2) 1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title">bin2int</span> = foldr (\x y -&gt; x + <span class="number">2</span> * y) <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="title">int2bin</span> :: <span class="type">Int</span> -&gt; [<span class="type">Bit</span>]</span><br><span class="line"><span class="title">int2bin</span> <span class="number">0</span> = []</span><br><span class="line"><span class="title">int2bin</span> n = n `mod` <span class="number">2</span> : int2bin (n `div` <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="title">make8</span> :: [<span class="type">Bit</span>] -&gt; [<span class="type">Bit</span>]</span><br><span class="line"><span class="title">make8</span> bits = take <span class="number">8</span> (bits ++ repeat <span class="number">0</span>)</span><br><span class="line"><span class="comment">--new</span></span><br><span class="line"><span class="title">count1</span> :: [<span class="type">Bit</span>] -&gt; <span class="type">Bit</span></span><br><span class="line"><span class="title">count1</span> = (`mod` <span class="number">2</span>) . sum</span><br><span class="line"><span class="comment">--new</span></span><br><span class="line"><span class="title">addparitybits</span> :: [<span class="type">Bit</span>] -&gt; [<span class="type">Bit</span>]</span><br><span class="line"><span class="title">addparitybits</span> bits = bits ++ [count1 bits]</span><br><span class="line"><span class="comment">--modifyed</span></span><br><span class="line"><span class="title">encode</span> :: <span class="type">String</span> -&gt; [<span class="type">Bit</span>]</span><br><span class="line"><span class="title">encode</span> = concat.map (addparitybits.make8.int2bin.ord)</span><br><span class="line"></span><br><span class="line"><span class="title">chop9</span> :: [<span class="type">Bit</span>] -&gt; [[<span class="type">Bit</span>]]</span><br><span class="line"><span class="title">chop9</span> [] = []</span><br><span class="line"><span class="title">chop9</span> bits = take <span class="number">9</span> bits : chop9 (drop <span class="number">9</span> bits)</span><br><span class="line"></span><br><span class="line"><span class="comment">--new</span></span><br><span class="line"><span class="title">isvalid</span> :: [<span class="type">Bit</span>] -&gt; <span class="type">Bool</span></span><br><span class="line"><span class="title">isvalid</span> bits = (count1 (take <span class="number">8</span> bits)) == (last bits)</span><br><span class="line"></span><br><span class="line"><span class="title">decode</span> :: [<span class="type">Bit</span>] -&gt; <span class="type">String</span></span><br><span class="line"></span><br><span class="line"><span class="title">decode</span> xs | all isvalid (chop9 xs) = map (chr.bin2int.(take <span class="number">8</span>)) (chop9 xs)</span><br><span class="line">          | otherwise = error <span class="string">"Wrong parity bit!"</span></span><br><span class="line"></span><br><span class="line"><span class="title">transmit</span> :: <span class="type">String</span> -&gt; <span class="type">String</span></span><br><span class="line"><span class="title">transmit</span> = decode.channel.encode</span><br><span class="line"></span><br><span class="line"><span class="title">channel</span> :: [<span class="type">Bit</span>] -&gt; [<span class="type">Bit</span>]</span><br><span class="line"><span class="title">channel</span> = id</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- *Main&gt; decode (encode "abc")</span></span><br><span class="line"><span class="comment">-- "abc"</span></span><br><span class="line"><span class="comment">-- *Main&gt; (encode "abc")</span></span><br><span class="line"><span class="comment">-- [1,0,0,0,0,1,1,0,1,0,1,0,0,0,1,1,0,1,1,1,0,0,0,1,1,0,0]</span></span><br><span class="line"><span class="comment">-- *Main&gt; decode [1,0,0,0,0,1,1,0,1,0,1,0,0,0,1,1,0,1,1,1,0,0,0,1,1,0,1] --&gt; change last bit</span></span><br><span class="line"><span class="comment">-- "*** Exception: Wrong parity bit!</span></span><br><span class="line"><span class="comment">-- CallStack (from HasCallStack):</span></span><br><span class="line"><span class="comment">--   error, called at ch7ex.hs:149:25 in main:Main</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 9</span></span><br><span class="line"><span class="title">transmit'</span> :: <span class="type">String</span> -&gt; <span class="type">String</span></span><br><span class="line"><span class="title">transmit'</span> = decode.tail.encode</span><br><span class="line"></span><br><span class="line"><span class="comment">-- *Main&gt; transmit "abc"</span></span><br><span class="line"><span class="comment">-- "abc"</span></span><br><span class="line"><span class="comment">-- *Main&gt; transmit' "abc"</span></span><br><span class="line"><span class="comment">-- "*** Exception: Wrong parity bit!</span></span><br><span class="line"><span class="comment">-- CallStack (from HasCallStack):</span></span><br><span class="line"><span class="comment">--   error, called at ch7ex.hs:147:25 in main:Main</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;em&gt;Programming in Haskell&lt;/em&gt;æ˜¯ä¸€æœ¬å…¥é—¨Haskellçš„å¥½ä¹¦ï¼Œä»‹ç»é¡µé¢ä»¥åŠé…å¥—çš„slides, vedios, codeséƒ½åœ¨&lt;a href=&quot;http://www.cs.nott.ac.uk/~pszgmh/book.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;è¿™é‡Œ&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h4 id=&quot;ç”¨mapå’Œfilterè¡¨ç¤º-f-x-x-xs-p-x&quot;&gt;ç”¨&lt;code&gt;map&lt;/code&gt;å’Œ&lt;code&gt;filter&lt;/code&gt;è¡¨ç¤º&lt;code&gt;[f x | x &amp;lt;- xs, p x]&lt;/code&gt;&lt;/h4&gt;
&lt;figure class=&quot;highlight haskell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- [f x | x &amp;lt;- xs, p x]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- [f x | x &amp;lt;- xs, p x]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- = map f (filter p xs)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;å®šä¹‰é«˜é˜¶å‡½æ•°all-any-takewhile-dropwhile&quot;&gt;å®šä¹‰é«˜é˜¶å‡½æ•°&lt;code&gt;all&lt;/code&gt;, &lt;code&gt;any&lt;/code&gt;, &lt;code&gt;takeWhile&lt;/code&gt;, &lt;code&gt;dropWhile&lt;/code&gt;&lt;/h4&gt;
&lt;figure class=&quot;highlight haskell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;myall&lt;/span&gt; :: (a -&amp;gt; &lt;span class=&quot;type&quot;&gt;Bool&lt;/span&gt;) -&amp;gt; [a] -&amp;gt; &lt;span class=&quot;type&quot;&gt;Bool&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;myall&lt;/span&gt; _ [] = &lt;span class=&quot;type&quot;&gt;True&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;myall&lt;/span&gt; p (x : xs) | p x == &lt;span class=&quot;type&quot;&gt;False&lt;/span&gt; = &lt;span class=&quot;type&quot;&gt;False&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                 | otherwise = myall p xs&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- *Main&amp;gt; myall (&amp;gt;3) [1..3]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- False&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- *Main&amp;gt; myall (&amp;gt;3) [1..5]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- False&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- *Main&amp;gt; myall (&amp;gt;3) [4..5]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- True&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;myany&lt;/span&gt; :: (a -&amp;gt; &lt;span class=&quot;type&quot;&gt;Bool&lt;/span&gt;) -&amp;gt; [a] -&amp;gt; &lt;span class=&quot;type&quot;&gt;Bool&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;myany&lt;/span&gt; _ [] = &lt;span class=&quot;type&quot;&gt;False&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;myany&lt;/span&gt; p (x : xs) | p x == &lt;span class=&quot;type&quot;&gt;True&lt;/span&gt; = &lt;span class=&quot;type&quot;&gt;True&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                 | otherwise = myany p xs&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- *Main&amp;gt; myany (&amp;gt;3) [1..5]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- True&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- *Main&amp;gt; myany (&amp;gt;3) [1..3]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- False&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;mytakeWhile&lt;/span&gt; :: (a -&amp;gt; &lt;span class=&quot;type&quot;&gt;Bool&lt;/span&gt;) -&amp;gt; [a] -&amp;gt; [a]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;mytakeWhile&lt;/span&gt; _ [] = []&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;mytakeWhile&lt;/span&gt; p (x : xs) | p x == &lt;span class=&quot;type&quot;&gt;True&lt;/span&gt; = x : mytakeWhile p xs&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                       | otherwise = []&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- *Main&amp;gt; mytakeWhile (&amp;lt;3) [1..5]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- [1,2]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- *Main&amp;gt; mytakeWhile (&amp;gt;3) [1..5]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- []&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- *Main&amp;gt; mytakeWhile (&amp;lt;3) [1,2,3,1,2]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- [1,2]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;mydropWhile&lt;/span&gt; :: (a -&amp;gt; &lt;span class=&quot;type&quot;&gt;Bool&lt;/span&gt;) -&amp;gt; [a] -&amp;gt; [a]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;mydropWhile&lt;/span&gt; _ [] = []&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;mydropWhile&lt;/span&gt; p (x : xs) | p x == &lt;span class=&quot;type&quot;&gt;True&lt;/span&gt; = mydropWhile p xs&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                       | otherwise = x : xs&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- *Main&amp;gt; mydropWhile (&amp;lt;3) [1..5]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- [3,4,5]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- *Main&amp;gt; mydropWhile (&amp;gt;3) [1..5]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- [1,2,3,4,5]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="Haskell" scheme="http://duanyifu.com/categories/Haskell/"/>
    
    
      <category term="Haskell" scheme="http://duanyifu.com/tags/Haskell/"/>
    
      <category term="Programming in Haskell" scheme="http://duanyifu.com/tags/Programming-in-Haskell/"/>
    
  </entry>
  
  <entry>
    <title>Programming in Haskell Chapter6 Exercises Solutions</title>
    <link href="http://duanyifu.com/2016/08/28/PIHex6/"/>
    <id>http://duanyifu.com/2016/08/28/PIHex6/</id>
    <published>2016-08-28T13:13:36.000Z</published>
    <updated>2016-08-28T15:50:56.000Z</updated>
    
    <content type="html"><![CDATA[<p><em>Programming in Haskell</em>æ˜¯ä¸€æœ¬å…¥é—¨Haskellçš„å¥½ä¹¦ï¼Œä»‹ç»é¡µé¢ä»¥åŠé…å¥—çš„slides, vedios, codeséƒ½åœ¨<a href="http://www.cs.nott.ac.uk/~pszgmh/book.html" target="_blank" rel="noopener">è¿™é‡Œ</a>ã€‚</p><hr><p>è¿™ä¸€ç« èŠ‚å°±æ˜¯åœ¨è®²é€’å½’ï¼Œæ‰€ä»¥ä¸‹é¢çš„å®šä¹‰éƒ½æ˜¯é»˜è®¤ç”¨é€’å½’å®šä¹‰ã€‚</p><h4 id="å®šä¹‰å¹‚å‡½æ•°">å®šä¹‰å¹‚å‡½æ•°</h4><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">mypow</span> :: <span class="type">Int</span> -&gt; <span class="type">Int</span> -&gt; <span class="type">Int</span></span><br><span class="line"><span class="title">mypow</span> _ <span class="number">0</span> = <span class="number">1</span></span><br><span class="line"><span class="title">mypow</span> x n = x * mypow x (n<span class="number">-1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- *Main&gt; mypow 2 3</span></span><br><span class="line"><span class="comment">-- 8</span></span><br><span class="line"><span class="comment">-- *Main&gt; mypow 3 0</span></span><br><span class="line"><span class="comment">-- 1</span></span><br><span class="line"><span class="comment">-- *Main&gt; mypow 3 1</span></span><br><span class="line"><span class="comment">-- 3</span></span><br></pre></td></tr></table></figure><h4 id="è§£é‡Šlength-drop-initçš„é€’å½’æ±‚å€¼è¿‡ç¨‹">è§£é‡Š<code>length</code>, <code>drop</code>, <code>init</code>çš„é€’å½’æ±‚å€¼è¿‡ç¨‹</h4><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">-- length [1, 2, 3]</span></span><br><span class="line"><span class="comment">-- = 1 + length [2, 3]</span></span><br><span class="line"><span class="comment">-- = 1 + (1 + length [3])</span></span><br><span class="line"><span class="comment">-- = 1 + (1 + (1 + length []))</span></span><br><span class="line"><span class="comment">-- = 3</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- drop 3 [1..5]</span></span><br><span class="line"><span class="comment">-- = drop 2 [2..5]</span></span><br><span class="line"><span class="comment">-- = drop 1 [3..5]</span></span><br><span class="line"><span class="comment">-- = drop 0 [4, 5]</span></span><br><span class="line"><span class="comment">-- = [4, 5]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- init [1..3]</span></span><br><span class="line"><span class="comment">-- = 1 : init [2, 3]</span></span><br><span class="line"><span class="comment">-- = 1 : 2 : init [3]</span></span><br><span class="line"><span class="comment">-- = 1 : 2 : []</span></span><br><span class="line"><span class="comment">-- = [1, 2]</span></span><br></pre></td></tr></table></figure><h4 id="å®šä¹‰ä»¥ä¸‹åº“å‡½æ•°">å®šä¹‰ä»¥ä¸‹åº“å‡½æ•°</h4><a id="more"></a><h5 id="and">and</h5><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">myand</span> :: [<span class="type">Bool</span>] -&gt; <span class="type">Bool</span></span><br><span class="line"><span class="title">myand</span> [] = <span class="type">True</span></span><br><span class="line"><span class="title">myand</span> (n : ns) | n == <span class="type">False</span> = <span class="type">False</span></span><br><span class="line">               | otherwise = myand ns</span><br><span class="line"></span><br><span class="line"><span class="comment">-- *Main&gt; myand [True, True]</span></span><br><span class="line"><span class="comment">-- True</span></span><br><span class="line"><span class="comment">-- *Main&gt; myand [True, False]</span></span><br><span class="line"><span class="comment">-- False</span></span><br><span class="line"><span class="comment">-- *Main&gt; myand []</span></span><br><span class="line"><span class="comment">-- True</span></span><br></pre></td></tr></table></figure><h5 id="concat">concat</h5><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">myconcat</span> :: [[a]] -&gt; [a]</span><br><span class="line"><span class="title">myconcat</span> [] = []</span><br><span class="line"><span class="title">myconcat</span> [[a]] = [a]</span><br><span class="line"><span class="title">myconcat</span> (n : ns) = n ++ myconcat ns</span><br><span class="line"></span><br><span class="line"><span class="comment">-- *Main&gt; myconcat []</span></span><br><span class="line"><span class="comment">-- []</span></span><br><span class="line"><span class="comment">-- *Main&gt; myconcat [[1,2,3]]</span></span><br><span class="line"><span class="comment">-- [1,2,3]</span></span><br><span class="line"><span class="comment">-- *Main&gt; myconcat [[1,2,3],[3,4,5],[2,7]]</span></span><br><span class="line"><span class="comment">-- [1,2,3,3,4,5,2,7]</span></span><br></pre></td></tr></table></figure><h5 id="replicate">replicate</h5><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">myreplicate</span> :: <span class="type">Int</span> -&gt; a -&gt; [a]</span><br><span class="line"><span class="title">myreplicate</span> <span class="number">0</span> _ = []</span><br><span class="line"><span class="title">myreplicate</span> n a = a : myreplicate (n - <span class="number">1</span>) a</span><br><span class="line"></span><br><span class="line"><span class="comment">-- *Main&gt; myreplicate 0 True</span></span><br><span class="line"><span class="comment">-- []</span></span><br><span class="line"><span class="comment">-- *Main&gt; myreplicate 1 True</span></span><br><span class="line"><span class="comment">-- [True]</span></span><br><span class="line"><span class="comment">-- *Main&gt; myreplicate 3 'c'</span></span><br><span class="line"><span class="comment">-- "ccc"</span></span><br><span class="line"><span class="comment">-- *Main&gt; myreplicate 3 "hs"</span></span><br><span class="line"><span class="comment">-- ["hs","hs","hs"]</span></span><br></pre></td></tr></table></figure><h5 id="none">(!!)</h5><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">mynth</span> :: [a] -&gt; <span class="type">Int</span> -&gt; a</span><br><span class="line"><span class="title">mynth</span> (x : xs) <span class="number">0</span> = x</span><br><span class="line"><span class="title">mynth</span> (x : xs) n = mynth xs (n - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- å…¶å®è¿™é‡Œå¦‚æœnå¤§äºé•¿åº¦åº”è¯¥è¦æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ï¼Œç›®å‰è¿˜æ²¡å­¦åˆ°ï¼Œå…ˆæ”¾ç€</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- *Main&gt; mynth [1..3] 0</span></span><br><span class="line"><span class="comment">-- 1</span></span><br><span class="line"><span class="comment">-- *Main&gt; mynth [1..3] 2</span></span><br><span class="line"><span class="comment">-- 3</span></span><br></pre></td></tr></table></figure><h5 id="elem">elem</h5><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">myelem</span> :: <span class="type">Eq</span> a =&gt; a -&gt; [a] -&gt; <span class="type">Bool</span></span><br><span class="line"><span class="title">myelem</span> x [] = <span class="type">False</span></span><br><span class="line"><span class="title">myelem</span> x (n : ns) | x == n = <span class="type">True</span></span><br><span class="line">                  | otherwise = myelem x ns</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- *Main&gt; myelem 0 []</span></span><br><span class="line"><span class="comment">-- False</span></span><br><span class="line"><span class="comment">-- *Main&gt; myelem 0 [1..3]</span></span><br><span class="line"><span class="comment">-- False</span></span><br><span class="line"><span class="comment">-- *Main&gt; myelem 3 [1..3]</span></span><br><span class="line"><span class="comment">-- True</span></span><br></pre></td></tr></table></figure><h4 id="å®šä¹‰mergeå‡½æ•°">å®šä¹‰<code>merge</code>å‡½æ•°</h4><p>merge: å°†ä¸¤ä¸ªæœ‰åºliståˆå¹¶æˆä¸€ä¸ªæœ‰åºlist</p><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">merge</span> :: <span class="type">Ord</span> a =&gt; [a] -&gt; [a] -&gt; [a]</span><br><span class="line"><span class="title">merge</span> [] [] = []</span><br><span class="line"><span class="title">merge</span> a [] = a</span><br><span class="line"><span class="title">merge</span> [] a = a</span><br><span class="line"><span class="title">merge</span> (n:ns) (x:xs) | x &gt;= n = n : merge ns (x:xs)</span><br><span class="line">                    | x &lt; n = x : merge (n:ns) xs</span><br><span class="line"></span><br><span class="line"><span class="comment">-- *Main&gt; merge [1,2,3,4,5] [2,3,5,6,7]</span></span><br><span class="line"><span class="comment">-- [1,2,2,3,3,4,5,5,6,7]</span></span><br><span class="line"><span class="comment">-- *Main&gt; merge [2,5,6] [1,3,4]</span></span><br><span class="line"><span class="comment">-- [1,2,3,4,5,6]</span></span><br><span class="line"><span class="comment">-- *Main&gt; merge [1,3,4] []</span></span><br><span class="line"><span class="comment">-- [1,3,4]</span></span><br><span class="line"><span class="comment">-- *Main&gt; merge [] []</span></span><br><span class="line"><span class="comment">-- []</span></span><br></pre></td></tr></table></figure><h4 id="åˆ©ç”¨mergeå®šä¹‰å½’å¹¶æ’åºmsort">åˆ©ç”¨<code>merge</code>å®šä¹‰å½’å¹¶æ’åº<code>msort</code></h4><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">halve</span> :: [a] -&gt; ([a], [a])</span><br><span class="line"><span class="title">halve</span> xs = <span class="keyword">let</span> hl = (length xs) `div` <span class="number">2</span> <span class="keyword">in</span></span><br><span class="line">            (take hl xs, drop hl xs)</span><br><span class="line"></span><br><span class="line"><span class="title">msort</span> :: <span class="type">Ord</span> a =&gt; [a] -&gt; [a]</span><br><span class="line"><span class="title">msort</span> [] = []</span><br><span class="line"><span class="title">msort</span> [a] = [a]</span><br><span class="line"><span class="title">msort</span> xs = merge (msort (fst (halve xs))) (msort (snd (halve xs)))</span><br><span class="line"></span><br><span class="line"><span class="comment">-- *Main&gt; msort []</span></span><br><span class="line"><span class="comment">-- []</span></span><br><span class="line"><span class="comment">-- *Main&gt; msort [3,1,2,4]</span></span><br><span class="line"><span class="comment">-- [1,2,3,4]</span></span><br><span class="line"><span class="comment">-- *Main&gt; msort [7,3,4,2,4,5,6,12,33,4,22,2]</span></span><br><span class="line"><span class="comment">-- [2,2,3,4,4,4,5,6,7,12,22,33]</span></span><br></pre></td></tr></table></figure><h4 id="å®šä¹‰sum-take-last">å®šä¹‰<code>sum</code>, <code>take</code>, <code>last</code></h4><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="title">mysum</span> :: <span class="type">Num</span> a =&gt; [a] -&gt; a</span><br><span class="line"><span class="title">mysum</span> [] = <span class="number">0</span></span><br><span class="line"><span class="title">mysum</span> (x : xs) = x + mysum xs</span><br><span class="line"></span><br><span class="line"><span class="comment">-- *Main&gt; mysum []</span></span><br><span class="line"><span class="comment">-- 0</span></span><br><span class="line"><span class="comment">-- *Main&gt; mysum [1..5]</span></span><br><span class="line"><span class="comment">-- 15</span></span><br><span class="line"><span class="comment">-- *Main&gt; mysum [3.6,7.6,5.77]</span></span><br><span class="line"><span class="comment">-- 16.97</span></span><br><span class="line"></span><br><span class="line"><span class="title">mytake</span> :: <span class="type">Int</span> -&gt; [a] -&gt; [a]</span><br><span class="line"><span class="title">mytake</span> <span class="number">0</span> _ = []</span><br><span class="line"><span class="title">mytake</span> _ [] = []</span><br><span class="line"><span class="title">mytake</span> n (x : xs) = x : mytake (n - <span class="number">1</span>) xs</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- *Main&gt; mytake 0 [1..5]</span></span><br><span class="line"><span class="comment">-- []</span></span><br><span class="line"><span class="comment">-- *Main&gt; mytake 3 [1..5]</span></span><br><span class="line"><span class="comment">-- [1,2,3]</span></span><br><span class="line"><span class="comment">-- *Main&gt; mytake 7 [1..5]</span></span><br><span class="line"><span class="comment">-- [1,2,3,4,5]</span></span><br><span class="line"><span class="comment">-- *Main&gt; mytake 7 []</span></span><br><span class="line"><span class="comment">-- []</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title">mylast</span> :: [a] -&gt; a</span><br><span class="line"><span class="title">mylast</span> [x] = x</span><br><span class="line"><span class="title">mylast</span> (x : xs) = mylast xs</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- *Main&gt; mylast [1..3]</span></span><br><span class="line"><span class="comment">-- 3</span></span><br><span class="line"><span class="comment">-- *Main&gt; mylast [5]</span></span><br><span class="line"><span class="comment">-- 5</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;em&gt;Programming in Haskell&lt;/em&gt;æ˜¯ä¸€æœ¬å…¥é—¨Haskellçš„å¥½ä¹¦ï¼Œä»‹ç»é¡µé¢ä»¥åŠé…å¥—çš„slides, vedios, codeséƒ½åœ¨&lt;a href=&quot;http://www.cs.nott.ac.uk/~pszgmh/book.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;è¿™é‡Œ&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;è¿™ä¸€ç« èŠ‚å°±æ˜¯åœ¨è®²é€’å½’ï¼Œæ‰€ä»¥ä¸‹é¢çš„å®šä¹‰éƒ½æ˜¯é»˜è®¤ç”¨é€’å½’å®šä¹‰ã€‚&lt;/p&gt;
&lt;h4 id=&quot;å®šä¹‰å¹‚å‡½æ•°&quot;&gt;å®šä¹‰å¹‚å‡½æ•°&lt;/h4&gt;
&lt;figure class=&quot;highlight haskell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;mypow&lt;/span&gt; :: &lt;span class=&quot;type&quot;&gt;Int&lt;/span&gt; -&amp;gt; &lt;span class=&quot;type&quot;&gt;Int&lt;/span&gt; -&amp;gt; &lt;span class=&quot;type&quot;&gt;Int&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;mypow&lt;/span&gt; _ &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;mypow&lt;/span&gt; x n = x * mypow x (n&lt;span class=&quot;number&quot;&gt;-1&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- *Main&amp;gt; mypow 2 3&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- 8&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- *Main&amp;gt; mypow 3 0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- 1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- *Main&amp;gt; mypow 3 1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- 3&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;è§£é‡Šlength-drop-initçš„é€’å½’æ±‚å€¼è¿‡ç¨‹&quot;&gt;è§£é‡Š&lt;code&gt;length&lt;/code&gt;, &lt;code&gt;drop&lt;/code&gt;, &lt;code&gt;init&lt;/code&gt;çš„é€’å½’æ±‚å€¼è¿‡ç¨‹&lt;/h4&gt;
&lt;figure class=&quot;highlight haskell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- length [1, 2, 3]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- = 1 + length [2, 3]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- = 1 + (1 + length [3])&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- = 1 + (1 + (1 + length []))&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- = 3&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- drop 3 [1..5]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- = drop 2 [2..5]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- = drop 1 [3..5]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- = drop 0 [4, 5]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- = [4, 5]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- init [1..3]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- = 1 : init [2, 3]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- = 1 : 2 : init [3]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- = 1 : 2 : []&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- = [1, 2]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;å®šä¹‰ä»¥ä¸‹åº“å‡½æ•°&quot;&gt;å®šä¹‰ä»¥ä¸‹åº“å‡½æ•°&lt;/h4&gt;
    
    </summary>
    
      <category term="Haskell" scheme="http://duanyifu.com/categories/Haskell/"/>
    
    
      <category term="Haskell" scheme="http://duanyifu.com/tags/Haskell/"/>
    
      <category term="Programming in Haskell" scheme="http://duanyifu.com/tags/Programming-in-Haskell/"/>
    
  </entry>
  
  <entry>
    <title>Programming in Haskell Chapter5 Exercises Solutions</title>
    <link href="http://duanyifu.com/2016/08/27/PIHex5/"/>
    <id>http://duanyifu.com/2016/08/27/PIHex5/</id>
    <published>2016-08-27T15:13:37.000Z</published>
    <updated>2016-08-28T15:49:38.000Z</updated>
    
    <content type="html"><![CDATA[<p><em>Programming in Haskell</em>æ˜¯ä¸€æœ¬å…¥é—¨Haskellçš„å¥½ä¹¦ï¼Œä»‹ç»é¡µé¢ä»¥åŠé…å¥—çš„slides, vedios, codeséƒ½åœ¨<a href="http://www.cs.nott.ac.uk/~pszgmh/book.html" target="_blank" rel="noopener">è¿™é‡Œ</a>ã€‚</p><hr><h4 id="ç”¨list-comprehensionè®¡ç®—1åˆ°100å¹³æ–¹å’Œ">ç”¨List Comprehensionè®¡ç®—1åˆ°100å¹³æ–¹å’Œ</h4><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">sum</span> [x^<span class="number">2</span> | x &lt;- [<span class="number">1.</span><span class="number">.100</span>]]</span><br></pre></td></tr></table></figure><h4 id="å®šä¹‰åº“å‡½æ•°replicate">å®šä¹‰åº“å‡½æ•°<code>replicate</code></h4><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- &gt; replicate 3 True</span></span><br><span class="line"><span class="comment">-- [True, True, True]</span></span><br><span class="line"></span><br><span class="line"><span class="title">myreplicate</span> :: <span class="type">Int</span> -&gt; a -&gt; [a]</span><br><span class="line"><span class="title">myreplicate</span> n x = [x | _ &lt;- [<span class="number">1.</span>.n]]</span><br></pre></td></tr></table></figure><h4 id="å®šä¹‰å‡½æ•°pyths">å®šä¹‰å‡½æ•°<code>pyths</code></h4><p><code>pyths n</code>è¿”å›æ»¡è¶³<code>x^2 + y^2 == z^2</code>çš„ä¸‰å…ƒç»„<code>(x, y, z)</code>ï¼Œå…¶ä¸­xyzéƒ½å°äºç­‰äºn</p><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- &gt; paths 10</span></span><br><span class="line"><span class="comment">-- [(3, 4, 5), (4, 3, 5), (6, 8, 10), (8, 6, 10)]</span></span><br><span class="line"></span><br><span class="line"><span class="title">pyths</span>   :: <span class="type">Int</span> -&gt; [(<span class="type">Int</span>, <span class="type">Int</span>, <span class="type">Int</span>)]</span><br><span class="line"><span class="title">pyths</span> n = [(x,y,z) | x &lt;- [<span class="number">1.</span>.n],</span><br><span class="line">                     y &lt;- [<span class="number">1.</span>.n],</span><br><span class="line">                     z &lt;- [<span class="number">1.</span>.n],</span><br><span class="line">                     x^<span class="number">2</span> + y^<span class="number">2</span> == z^<span class="number">2</span>]</span><br></pre></td></tr></table></figure><a id="more"></a><h4 id="å®šä¹‰å®Œç¾æ•°å‡½æ•°perfects">å®šä¹‰å®Œç¾æ•°å‡½æ•°<code>perfects</code></h4><p>å®Œç¾æ•°çš„å®šä¹‰ï¼šä¸€ä¸ªæ•°æ‰€æœ‰çš„çœŸå› å­ï¼ˆé™¤æ‰è‡ªèº«ä»¥å¤–çš„å› å­ï¼‰ä¹‹å’Œç­‰äºå®ƒæœ¬èº«ã€‚<br>ä¾‹å¦‚ï¼š6 = 1 + 2 + 3</p><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">factors</span> :: <span class="type">Int</span> -&gt; [<span class="type">Int</span>]</span><br><span class="line"><span class="title">factors</span> x = [n | n &lt;- [<span class="number">1.</span>.x<span class="number">-1</span>], x `mod` n == <span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="title">perfects</span> :: <span class="type">Int</span> -&gt; [<span class="type">Int</span>]</span><br><span class="line"><span class="title">perfects</span> n = [x | x &lt;- [<span class="number">1.</span>.n], x == sum (factors x)]</span><br></pre></td></tr></table></figure><p>æ·±å…¥é˜…è¯»ï¼š<a href="https://en.wikipedia.org/wiki/Perfect_number" target="_blank" rel="noopener">Perfect number</a></p><h4 id="æ”¹å†™-x-y-x-1-3-y-1-3">æ”¹å†™<code>[(x, y) | x &lt;- [1..3], y &lt;- [1..3]]</code></h4><p>å°†ä¸¤å±‚List ComprehensionåµŒå¥—èµ·æ¥</p><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">concat</span> [[(x,y)| x &lt;- [<span class="number">1.</span><span class="number">.3</span>] ]| y &lt;- [<span class="number">1.</span><span class="number">.3</span>]]</span><br></pre></td></tr></table></figure><h4 id="åˆ©ç”¨findå‡½æ•°é‡æ–°å®šä¹‰positionså‡½æ•°">åˆ©ç”¨<code>find</code>å‡½æ•°é‡æ–°å®šä¹‰<code>positions</code>å‡½æ•°</h4><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">positions</span> :: <span class="type">Eq</span> a =&gt; a -&gt; [a] -&gt; [<span class="type">Int</span>]</span><br><span class="line"><span class="title">positions</span> x xs = [i | (x', i) &lt;- zip xs [<span class="number">0.</span>.n], x == x']</span><br><span class="line">                    <span class="keyword">where</span> n = length xs <span class="number">-1</span></span><br><span class="line"></span><br><span class="line"><span class="title">find</span> :: <span class="type">Eq</span> a =&gt; a -&gt; [(a, b)] -&gt; [b]</span><br><span class="line"><span class="title">find</span> k t = [v | (k', v) &lt;- t, k == k']</span><br></pre></td></tr></table></figure><h4 id="è®¡ç®—å†…ç§¯å‡½æ•°scalarproduct">è®¡ç®—å†…ç§¯å‡½æ•°<code>scalarproduct</code></h4><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">scalarproduct</span> :: [<span class="type">Int</span>] -&gt; [<span class="type">Int</span>] -&gt; <span class="type">Int</span></span><br><span class="line"><span class="title">scalarproduct</span> x y = sum [x * y | (x, y) &lt;- zip x y]</span><br></pre></td></tr></table></figure><h4 id="ä¿®æ”¹ä¹¦ä¸Šçš„caesar-cipherç¨‹åº-ä½¿ä¹‹èƒ½å¤„ç†å¤§å†™å­—æ¯">ä¿®æ”¹ä¹¦ä¸Šçš„Caesar cipherç¨‹åºï¼Œä½¿ä¹‹èƒ½å¤„ç†å¤§å†™å­—æ¯</h4><p>æ€è·¯æ˜¯ï¼š</p><ol><li>ç”¨<code>shift</code>è¿›è¡Œç§»ä½çš„æ—¶å€™ï¼Œå°†å¤§å†™å­—æ¯ã€å°å†™å­—æ¯åˆ†å¼€å¤„ç†ï¼›</li><li>crackè®¡ç®—æ¦‚ç‡çš„æ—¶å€™ï¼ŒæŠŠå¤§å†™å­—æ¯å½“åšå°å†™å­—æ¯å¤„ç†ã€‚</li></ol><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">let2int</span> :: <span class="type">Char</span> -&gt; <span class="type">Int</span></span><br><span class="line"><span class="title">let2int</span> c = ord c - ord 'a'</span><br><span class="line"></span><br><span class="line"><span class="comment">-- new</span></span><br><span class="line"><span class="title">let2intup</span> :: <span class="type">Char</span> -&gt; <span class="type">Int</span></span><br><span class="line"><span class="title">let2intup</span> c = ord c - ord '<span class="type">A'</span></span><br><span class="line"></span><br><span class="line"><span class="title">int2let</span> :: <span class="type">Int</span> -&gt; <span class="type">Char</span></span><br><span class="line"><span class="title">int2let</span> n = chr (ord 'a' + n)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- new</span></span><br><span class="line"><span class="title">int2letup</span> :: <span class="type">Int</span> -&gt; <span class="type">Char</span></span><br><span class="line"><span class="title">int2letup</span> n = chr (ord '<span class="type">A'</span> + n)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- modified</span></span><br><span class="line"><span class="title">shift</span> :: <span class="type">Int</span> -&gt; <span class="type">Char</span> -&gt; <span class="type">Char</span></span><br><span class="line"><span class="title">shift</span> n c | isLower c = int2let ((let2int c + n) `mod` <span class="number">26</span>)</span><br><span class="line">          | isUpper c = int2letup ((let2intup c + n) `mod` <span class="number">26</span>)</span><br><span class="line">          | otherwise = c</span><br><span class="line"></span><br><span class="line"><span class="title">table</span> :: [<span class="type">Float</span>]</span><br><span class="line"><span class="title">table</span> = [<span class="number">8.2</span>, <span class="number">1.5</span>, <span class="number">2.8</span>, <span class="number">4.3</span>, <span class="number">12.7</span>, <span class="number">2.2</span>,</span><br><span class="line">         <span class="number">2.0</span>, <span class="number">6.1</span>, <span class="number">7.0</span>, <span class="number">0.2</span>, <span class="number">0.8</span>, <span class="number">4.0</span>,</span><br><span class="line">         <span class="number">2.4</span>, <span class="number">6.7</span>, <span class="number">7.5</span>, <span class="number">1.9</span>, <span class="number">0.1</span>, <span class="number">6.0</span>,</span><br><span class="line">         <span class="number">6.3</span>, <span class="number">9.1</span>, <span class="number">2.8</span>, <span class="number">1.0</span>, <span class="number">2.4</span>, <span class="number">0.2</span>,</span><br><span class="line">         <span class="number">2.0</span>, <span class="number">0.1</span>]</span><br><span class="line"></span><br><span class="line"><span class="title">encode</span> :: <span class="type">Int</span> -&gt; <span class="type">String</span> -&gt; <span class="type">String</span></span><br><span class="line"><span class="title">encode</span> n xs = [shift n x | x &lt;- xs]</span><br><span class="line"></span><br><span class="line"><span class="title">percent</span> :: <span class="type">Int</span> -&gt; <span class="type">Int</span> -&gt; <span class="type">Float</span></span><br><span class="line"><span class="title">percent</span> n m = (fromIntegral n / fromIntegral m) * <span class="number">100</span></span><br><span class="line"></span><br><span class="line"><span class="title">count</span> :: <span class="type">Char</span> -&gt; <span class="type">String</span> -&gt; <span class="type">Int</span></span><br><span class="line"><span class="title">count</span> x xs = length [x' | x' &lt;- xs, x == x']</span><br><span class="line"></span><br><span class="line"><span class="comment">-- lowers :: String -&gt; Int</span></span><br><span class="line"><span class="comment">-- lowers xs = length [x | x &lt;- xs, isLower x]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- new</span></span><br><span class="line"><span class="title">lowerstring</span> :: <span class="type">String</span> -&gt; <span class="type">String</span></span><br><span class="line"><span class="title">lowerstring</span> xs = [<span class="keyword">if</span> isUpper x <span class="keyword">then</span> chr (ord x + <span class="number">32</span>) <span class="keyword">else</span> x| x &lt;- xs]</span><br><span class="line"></span><br><span class="line"><span class="comment">-- modified</span></span><br><span class="line"><span class="title">freqs</span> :: <span class="type">String</span> -&gt; [<span class="type">Float</span>]</span><br><span class="line"><span class="title">freqs</span> xs = [percent (count x (lowerstring xs)) n | x &lt;- ['a'..'z']]</span><br><span class="line">            <span class="keyword">where</span> n = length xs</span><br><span class="line"></span><br><span class="line"><span class="comment">-- chi-square</span></span><br><span class="line"><span class="title">chisqr</span> :: [<span class="type">Float</span>] -&gt; [<span class="type">Float</span>] -&gt; <span class="type">Float</span></span><br><span class="line"><span class="title">chisqr</span> os es = sum [(o - e)^<span class="number">2</span> / e | (o, e) &lt;- zip os es]</span><br><span class="line"></span><br><span class="line"><span class="title">rotate</span> :: <span class="type">Int</span> -&gt; [a] -&gt; [a]</span><br><span class="line"><span class="title">rotate</span> n xs = drop n xs ++ take n xs</span><br><span class="line"></span><br><span class="line"><span class="title">crack</span> :: <span class="type">String</span> -&gt; <span class="type">String</span></span><br><span class="line"><span class="title">crack</span> xs = encode (-factor) xs</span><br><span class="line">    <span class="keyword">where</span></span><br><span class="line">        factor = head (positions (minimum chitab) chitab)</span><br><span class="line">        chitab = [chisqr (rotate n table') table | n &lt;- [<span class="number">0.</span><span class="number">.25</span>]]</span><br><span class="line">        table' = freqs xs</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>testï¼š</p><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">*<span class="type">Main</span>&gt; :l ch5ex.hs </span><br><span class="line">[<span class="number">1</span> <span class="keyword">of</span> <span class="number">1</span>] <span class="type">Compiling</span> <span class="type">Main</span>             ( ch5ex.hs, interpreted )</span><br><span class="line"><span class="type">Ok</span>, modules loaded: <span class="type">Main</span>.</span><br><span class="line">*<span class="type">Main</span>&gt; encode <span class="number">3</span> <span class="string">"HasKELL iS FuN"</span></span><br><span class="line"><span class="string">"KdvNHOO lV IxQ"</span></span><br><span class="line">*<span class="type">Main</span>&gt; crack <span class="string">"KDvnhoO Lv IXQ"</span></span><br><span class="line"><span class="string">"HAskelL Is FUN"</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;em&gt;Programming in Haskell&lt;/em&gt;æ˜¯ä¸€æœ¬å…¥é—¨Haskellçš„å¥½ä¹¦ï¼Œä»‹ç»é¡µé¢ä»¥åŠé…å¥—çš„slides, vedios, codeséƒ½åœ¨&lt;a href=&quot;http://www.cs.nott.ac.uk/~pszgmh/book.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;è¿™é‡Œ&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h4 id=&quot;ç”¨list-comprehensionè®¡ç®—1åˆ°100å¹³æ–¹å’Œ&quot;&gt;ç”¨List Comprehensionè®¡ç®—1åˆ°100å¹³æ–¹å’Œ&lt;/h4&gt;
&lt;figure class=&quot;highlight haskell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;sum&lt;/span&gt; [x^&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; | x &amp;lt;- [&lt;span class=&quot;number&quot;&gt;1.&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;.100&lt;/span&gt;]]&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;å®šä¹‰åº“å‡½æ•°replicate&quot;&gt;å®šä¹‰åº“å‡½æ•°&lt;code&gt;replicate&lt;/code&gt;&lt;/h4&gt;
&lt;figure class=&quot;highlight haskell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- &amp;gt; replicate 3 True&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- [True, True, True]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;myreplicate&lt;/span&gt; :: &lt;span class=&quot;type&quot;&gt;Int&lt;/span&gt; -&amp;gt; a -&amp;gt; [a]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;myreplicate&lt;/span&gt; n x = [x | _ &amp;lt;- [&lt;span class=&quot;number&quot;&gt;1.&lt;/span&gt;.n]]&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;å®šä¹‰å‡½æ•°pyths&quot;&gt;å®šä¹‰å‡½æ•°&lt;code&gt;pyths&lt;/code&gt;&lt;/h4&gt;
&lt;p&gt;&lt;code&gt;pyths n&lt;/code&gt;è¿”å›æ»¡è¶³&lt;code&gt;x^2 + y^2 == z^2&lt;/code&gt;çš„ä¸‰å…ƒç»„&lt;code&gt;(x, y, z)&lt;/code&gt;ï¼Œå…¶ä¸­xyzéƒ½å°äºç­‰äºn&lt;/p&gt;
&lt;figure class=&quot;highlight haskell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- &amp;gt; paths 10&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- [(3, 4, 5), (4, 3, 5), (6, 8, 10), (8, 6, 10)]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;pyths&lt;/span&gt;   :: &lt;span class=&quot;type&quot;&gt;Int&lt;/span&gt; -&amp;gt; [(&lt;span class=&quot;type&quot;&gt;Int&lt;/span&gt;, &lt;span class=&quot;type&quot;&gt;Int&lt;/span&gt;, &lt;span class=&quot;type&quot;&gt;Int&lt;/span&gt;)]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;pyths&lt;/span&gt; n = [(x,y,z) | x &amp;lt;- [&lt;span class=&quot;number&quot;&gt;1.&lt;/span&gt;.n],&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                     y &amp;lt;- [&lt;span class=&quot;number&quot;&gt;1.&lt;/span&gt;.n],&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                     z &amp;lt;- [&lt;span class=&quot;number&quot;&gt;1.&lt;/span&gt;.n],&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                     x^&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; + y^&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; == z^&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="Haskell" scheme="http://duanyifu.com/categories/Haskell/"/>
    
    
      <category term="Haskell" scheme="http://duanyifu.com/tags/Haskell/"/>
    
      <category term="Programming in Haskell" scheme="http://duanyifu.com/tags/Programming-in-Haskell/"/>
    
  </entry>
  
  <entry>
    <title>Programming in Haskell Chapter4 Exercises Solutions</title>
    <link href="http://duanyifu.com/2016/08/26/PIHex4/"/>
    <id>http://duanyifu.com/2016/08/26/PIHex4/</id>
    <published>2016-08-25T17:00:18.000Z</published>
    <updated>2016-08-28T15:48:38.000Z</updated>
    
    <content type="html"><![CDATA[<p><em>Programming in Haskell</em>æ˜¯ä¸€æœ¬å…¥é—¨Haskellçš„å¥½ä¹¦ï¼Œä»‹ç»é¡µé¢ä»¥åŠé…å¥—çš„slides, vedios, codeséƒ½åœ¨<a href="http://www.cs.nott.ac.uk/~pszgmh/book.html" target="_blank" rel="noopener">è¿™é‡Œ</a>ã€‚</p><hr><h4 id="å®šä¹‰-halve">å®šä¹‰ halve</h4><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">halve</span> :: [a] -&gt; ([a], [a])</span><br><span class="line"><span class="title">halve</span> a = <span class="keyword">let</span> n = (length a) `div` <span class="number">2</span> <span class="keyword">in</span> (take n a, drop n a)</span><br></pre></td></tr></table></figure><h4 id="ç”¨ä¸‰ç§æ–¹å¼å®šä¹‰safetail">ç”¨ä¸‰ç§æ–¹å¼å®šä¹‰safetail</h4><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- conditional expression</span></span><br><span class="line"><span class="title">safetail1</span> :: [a] -&gt; [a]</span><br><span class="line"><span class="title">safetail1</span> xs = <span class="keyword">if</span> null xs <span class="keyword">then</span> xs <span class="keyword">else</span> tail xs</span><br><span class="line"></span><br><span class="line"><span class="comment">-- guarded equations</span></span><br><span class="line"><span class="title">safetail2</span> :: [a] -&gt; [a]</span><br><span class="line"><span class="title">safetail2</span> xs | null xs      = xs</span><br><span class="line">             | otherwise    = tail xs</span><br><span class="line"></span><br><span class="line"><span class="comment">-- pattern matching</span></span><br><span class="line"><span class="title">safetail3</span> :: [a] -&gt; [a]</span><br><span class="line"><span class="title">safetail3</span> [] = []</span><br><span class="line"><span class="title">safetail3</span> (_:xs) = xs</span><br><span class="line"></span><br></pre></td></tr></table></figure><a id="more"></a><h4 id="å®šä¹‰å¹¶è¿ç®—-disjunction-operator">å®šä¹‰å¹¶è¿ç®—ï¼ˆdisjunction operatorï¼‰</h4><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 1 all pattern matching</span></span><br><span class="line"><span class="title">md1</span> :: <span class="type">Bool</span> -&gt; <span class="type">Bool</span> -&gt; <span class="type">Bool</span></span><br><span class="line"><span class="title">md1</span> <span class="type">True</span> <span class="type">True</span> = <span class="type">True</span></span><br><span class="line"><span class="title">md1</span> <span class="type">True</span> <span class="type">False</span> = <span class="type">True</span></span><br><span class="line"><span class="title">md1</span> <span class="type">False</span> <span class="type">True</span> = <span class="type">True</span></span><br><span class="line"><span class="title">md1</span> <span class="type">False</span> <span class="type">False</span> = <span class="type">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 2 wildcard pattern</span></span><br><span class="line"></span><br><span class="line"><span class="title">md2</span> <span class="type">False</span> <span class="type">False</span> = <span class="type">False</span></span><br><span class="line"><span class="title">md2</span> _ _ = <span class="type">True</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 3</span></span><br><span class="line"><span class="title">md3</span> <span class="type">False</span> b = b</span><br><span class="line"><span class="title">md3</span> <span class="type">True</span> _ = <span class="type">True</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 4</span></span><br><span class="line"><span class="title">md4</span> a b | a == b    = a</span><br><span class="line">        | otherwise = <span class="type">True</span></span><br></pre></td></tr></table></figure><h4 id="ç”¨æ¡ä»¶è¡¨è¾¾å¼-conditional-expressions-é‡æ–°å®šä¹‰å¹¶è¿ç®—">ç”¨æ¡ä»¶è¡¨è¾¾å¼ï¼ˆconditional expressionsï¼‰é‡æ–°å®šä¹‰å¹¶è¿ç®—</h4><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">mc1</span> a b = <span class="keyword">if</span> a == <span class="type">False</span> <span class="keyword">then</span> <span class="type">False</span> <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">if</span> b == <span class="type">True</span> <span class="keyword">then</span> <span class="type">True</span> <span class="keyword">else</span> <span class="type">False</span></span><br></pre></td></tr></table></figure><h4 id="åŒä¸Šä¸€é¢˜">åŒä¸Šä¸€é¢˜</h4><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">mc2</span> a b = <span class="keyword">if</span> a == <span class="type">True</span> <span class="keyword">then</span> b <span class="keyword">else</span> <span class="type">False</span></span><br></pre></td></tr></table></figure><h4 id="ç”¨lambdaè¡¨è¾¾å¼ç†è§£å‡½æ•°mult-x-y-z-x-y-z">ç”¨lambdaè¡¨è¾¾å¼ç†è§£å‡½æ•°<code>mult x y z = x * y * z</code></h4><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">mult</span> x y z == \x -&gt; (\y -&gt; (\z -&gt; x * y * z))</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;em&gt;Programming in Haskell&lt;/em&gt;æ˜¯ä¸€æœ¬å…¥é—¨Haskellçš„å¥½ä¹¦ï¼Œä»‹ç»é¡µé¢ä»¥åŠé…å¥—çš„slides, vedios, codeséƒ½åœ¨&lt;a href=&quot;http://www.cs.nott.ac.uk/~pszgmh/book.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;è¿™é‡Œ&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h4 id=&quot;å®šä¹‰-halve&quot;&gt;å®šä¹‰ halve&lt;/h4&gt;
&lt;figure class=&quot;highlight haskell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;halve&lt;/span&gt; :: [a] -&amp;gt; ([a], [a])&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;halve&lt;/span&gt; a = &lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; n = (length a) `div` &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; (take n a, drop n a)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;ç”¨ä¸‰ç§æ–¹å¼å®šä¹‰safetail&quot;&gt;ç”¨ä¸‰ç§æ–¹å¼å®šä¹‰safetail&lt;/h4&gt;
&lt;figure class=&quot;highlight haskell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- conditional expression&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;safetail1&lt;/span&gt; :: [a] -&amp;gt; [a]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;safetail1&lt;/span&gt; xs = &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; null xs &lt;span class=&quot;keyword&quot;&gt;then&lt;/span&gt; xs &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; tail xs&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- guarded equations&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;safetail2&lt;/span&gt; :: [a] -&amp;gt; [a]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;safetail2&lt;/span&gt; xs | null xs      = xs&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;             | otherwise    = tail xs&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- pattern matching&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;safetail3&lt;/span&gt; :: [a] -&amp;gt; [a]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;safetail3&lt;/span&gt; [] = []&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;safetail3&lt;/span&gt; (_:xs) = xs&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="Haskell" scheme="http://duanyifu.com/categories/Haskell/"/>
    
    
      <category term="Haskell" scheme="http://duanyifu.com/tags/Haskell/"/>
    
      <category term="Programming in Haskell" scheme="http://duanyifu.com/tags/Programming-in-Haskell/"/>
    
  </entry>
  
  <entry>
    <title>Programming in Haskell Chapter3 Exercises Solutions</title>
    <link href="http://duanyifu.com/2016/08/25/PIHex3/"/>
    <id>http://duanyifu.com/2016/08/25/PIHex3/</id>
    <published>2016-08-25T15:45:14.000Z</published>
    <updated>2016-08-25T17:57:18.000Z</updated>
    
    <content type="html"><![CDATA[<p><em>Programming in Haskell</em>æ˜¯ä¸€æœ¬å…¥é—¨Haskellçš„å¥½ä¹¦ï¼Œä»‹ç»é¡µé¢ä»¥åŠé…å¥—çš„slides, vedios, codeséƒ½åœ¨<a href="http://www.cs.nott.ac.uk/~pszgmh/book.html" target="_blank" rel="noopener">è¿™é‡Œ</a>ã€‚</p><hr><h4 id="å†™å‡ºè¿™äº›è¡¨è¾¾å¼çš„type">å†™å‡ºè¿™äº›è¡¨è¾¾å¼çš„type</h4><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">['a', 'b', 'c']             <span class="comment">-- :: [Char]</span></span><br><span class="line">('a', 'b', 'c')             <span class="comment">-- :: (Char, Char, Char)</span></span><br><span class="line">[(<span class="type">False</span>, '<span class="type">O'</span>), (<span class="type">True</span>, '<span class="number">1</span>')] <span class="comment">-- :: [(Bool, Char)]</span></span><br><span class="line">([<span class="type">False</span>, <span class="type">True</span>], ['<span class="number">0</span>', '<span class="number">1</span>']) <span class="comment">-- :: ([Bool], [Char])</span></span><br><span class="line">[tail, init, reverse]       <span class="comment">-- :: [[a] -&gt; [a]]</span></span><br></pre></td></tr></table></figure><h4 id="å†™å‡ºè¿™äº›å‡½æ•°çš„type">å†™å‡ºè¿™äº›å‡½æ•°çš„type</h4><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">second</span> xs       = head (tail xs)    <span class="comment">-- [a] -&gt; a</span></span><br><span class="line"><span class="title">swap</span> (x, y)     = (y, x)            <span class="comment">-- (a, b) -&gt; (b, a)</span></span><br><span class="line"><span class="title">pair</span> x y        = (x, y)            <span class="comment">-- a -&gt; b -&gt; (a, b)</span></span><br><span class="line"><span class="title">double</span> x        = x * <span class="number">2</span>             <span class="comment">-- Num a =&gt; a -&gt; a</span></span><br><span class="line"><span class="title">palindrome</span> xs   = reverse xs == xs  <span class="comment">-- Eq a =&gt; a -&gt; Bool</span></span><br><span class="line"><span class="title">twice</span> f x       = f (f x)           <span class="comment">-- (a -&gt; a) -&gt; a -&gt; a</span></span><br></pre></td></tr></table></figure><a id="more"></a><h4 id="åœ¨hugsä¸­éªŒè¯å‰ä¸¤é¢˜">åœ¨Hugsä¸­éªŒè¯å‰ä¸¤é¢˜</h4><p>ç¬¬äºŒé¢˜ä¸­ï¼Œæœ‰å‡ ä¸ªå‡½æ•°ç”¨<code>:t</code>æŸ¥çœ‹çš„typeæ˜¯ç”¨<code>t</code> <code>t1</code>è¡¨ç¤ºçš„ï¼Œå’Œ<code>a</code> <code>b</code>æ˜¯ä¸€ä¸ªæ„æ€ã€‚</p><h4 id="ä¸ºä»€ä¹ˆ-å°†æ‰€æœ‰çš„å‡½æ•°ç±»å‹éƒ½å®šä¹‰ä¸ºeq-classçš„å®ä¾‹-instance-æ˜¯ä¸å¯è¡Œçš„ï¼Ÿ">ä¸ºä»€ä¹ˆâ€œå°†æ‰€æœ‰çš„å‡½æ•°ç±»å‹éƒ½å®šä¹‰ä¸º<code>Eq class</code>çš„å®ä¾‹ï¼ˆinstanceï¼‰â€æ˜¯ä¸å¯è¡Œçš„ï¼Ÿ</h4><p>é¢˜ç›®ä¸­ç»™å‡ºçš„ä¸¤ä¸ªå‡½æ•°ç›¸ç­‰çš„å®šä¹‰æ˜¯è¿™æ ·ï¼š</p><ol><li>typeç›¸åŒ</li><li>å¯¹äºä»»æ„çš„è¾“å…¥ï¼Œéƒ½æ‹¥æœ‰ç›¸åŒçš„è¾“å‡º</li></ol><p>æ˜¾ç„¶ï¼Œç¼–è¯‘å™¨ä¸å¯èƒ½å¯¹ä¸¤ä¸ªå‡½æ•°æµ‹è¯•æ‰€æœ‰çš„å‚æ•°æ¥åˆ¤æ–­å®ƒä»¬æ˜¯å¦ç›¸ç­‰ã€‚å› ä¸ºå¯èƒ½çš„å‚æ•°æ˜¯æœ‰æ— ç©·å¤šä¸ªçš„ã€‚</p><p>æ·±å…¥é˜…è¯»: <a href="http://stackoverflow.com/questions/10956419/why-isnt-every-type-part-of-eq-in-haskell" target="_blank" rel="noopener">Why isnâ€™t every type part of Eq in Haskell?</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;em&gt;Programming in Haskell&lt;/em&gt;æ˜¯ä¸€æœ¬å…¥é—¨Haskellçš„å¥½ä¹¦ï¼Œä»‹ç»é¡µé¢ä»¥åŠé…å¥—çš„slides, vedios, codeséƒ½åœ¨&lt;a href=&quot;http://www.cs.nott.ac.uk/~pszgmh/book.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;è¿™é‡Œ&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h4 id=&quot;å†™å‡ºè¿™äº›è¡¨è¾¾å¼çš„type&quot;&gt;å†™å‡ºè¿™äº›è¡¨è¾¾å¼çš„type&lt;/h4&gt;
&lt;figure class=&quot;highlight haskell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;]             &lt;span class=&quot;comment&quot;&gt;-- :: [Char]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;(&#39;a&#39;, &#39;b&#39;, &#39;c&#39;)             &lt;span class=&quot;comment&quot;&gt;-- :: (Char, Char, Char)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[(&lt;span class=&quot;type&quot;&gt;False&lt;/span&gt;, &#39;&lt;span class=&quot;type&quot;&gt;O&#39;&lt;/span&gt;), (&lt;span class=&quot;type&quot;&gt;True&lt;/span&gt;, &#39;&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&#39;)] &lt;span class=&quot;comment&quot;&gt;-- :: [(Bool, Char)]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;([&lt;span class=&quot;type&quot;&gt;False&lt;/span&gt;, &lt;span class=&quot;type&quot;&gt;True&lt;/span&gt;], [&#39;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&#39;, &#39;&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&#39;]) &lt;span class=&quot;comment&quot;&gt;-- :: ([Bool], [Char])&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[tail, init, reverse]       &lt;span class=&quot;comment&quot;&gt;-- :: [[a] -&amp;gt; [a]]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;å†™å‡ºè¿™äº›å‡½æ•°çš„type&quot;&gt;å†™å‡ºè¿™äº›å‡½æ•°çš„type&lt;/h4&gt;
&lt;figure class=&quot;highlight haskell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;second&lt;/span&gt; xs       = head (tail xs)    &lt;span class=&quot;comment&quot;&gt;-- [a] -&amp;gt; a&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;swap&lt;/span&gt; (x, y)     = (y, x)            &lt;span class=&quot;comment&quot;&gt;-- (a, b) -&amp;gt; (b, a)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;pair&lt;/span&gt; x y        = (x, y)            &lt;span class=&quot;comment&quot;&gt;-- a -&amp;gt; b -&amp;gt; (a, b)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;double&lt;/span&gt; x        = x * &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;             &lt;span class=&quot;comment&quot;&gt;-- Num a =&amp;gt; a -&amp;gt; a&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;palindrome&lt;/span&gt; xs   = reverse xs == xs  &lt;span class=&quot;comment&quot;&gt;-- Eq a =&amp;gt; a -&amp;gt; Bool&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;twice&lt;/span&gt; f x       = f (f x)           &lt;span class=&quot;comment&quot;&gt;-- (a -&amp;gt; a) -&amp;gt; a -&amp;gt; a&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="Haskell" scheme="http://duanyifu.com/categories/Haskell/"/>
    
    
      <category term="Haskell" scheme="http://duanyifu.com/tags/Haskell/"/>
    
      <category term="Programming in Haskell" scheme="http://duanyifu.com/tags/Programming-in-Haskell/"/>
    
  </entry>
  
  <entry>
    <title>ç”¨Sublime Textå†™Haskell</title>
    <link href="http://duanyifu.com/2016/08/24/write-haskell-with-sublime/"/>
    <id>http://duanyifu.com/2016/08/24/write-haskell-with-sublime/</id>
    <published>2016-08-23T18:09:20.000Z</published>
    <updated>2016-08-23T20:00:47.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="åŸºç¡€å‡†å¤‡">åŸºç¡€å‡†å¤‡</h3><ul><li><a href="https://www.haskell.org/downloads" target="_blank" rel="noopener">Haskell</a> (æˆ‘é€‰æ‹©çš„æ˜¯Haskell Platform 8.0.1)</li><li><a href="https://www.sublimetext.com/3" target="_blank" rel="noopener">Sublime Text</a></li><li><a href="https://packagecontrol.io/installation" target="_blank" rel="noopener">Package Control: The Sublime Text package manager</a></li></ul><h3 id="å®‰è£…æ’ä»¶">å®‰è£…æ’ä»¶</h3><h4 id="sublimehaskell">SublimeHaskell</h4><p>åœ¨Package Controlä¸­å®‰è£…SublimeHaskellã€‚<br>æ’ä»¶å®‰è£…å®Œæˆåï¼Œé‡å¯SublimeæŠ¥é”™ï¼Œæç¤ºéœ€è¦å®‰è£…hsdev cabal packageã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SublimeHaskell: hsdev executable couldn&apos;t be found!</span><br><span class="line">It&apos;s used in most features of SublimeHaskell</span><br><span class="line">Check if it&apos;s installed and in PATH</span><br><span class="line">If it&apos;s not installed, run &apos;cabal install hsdev&apos; to install hsdev</span><br><span class="line">You may also want to adjust &apos;add_to_PATH&apos; setting</span><br></pre></td></tr></table></figure><a id="more"></a><p>ç”¨cabalå®‰è£…ä¹‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ cabal install hsdev</span><br></pre></td></tr></table></figure><p>ç„¶åæ˜¯cabalè¿è¡Œè¿‡ç¨‹ä¸­æŠ¥é”™ï¼Œæç¤ºç¼ºå°‘happy cabal packageã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$ cabal install hsdev</span><br><span class="line">Resolving dependencies...</span><br><span class="line">Configuring haskell-src-exts-1.17.1...</span><br><span class="line">Failed to install haskell-src-exts-1.17.1</span><br><span class="line">Build log ( /Users/mist/.cabal/logs/haskell-src-exts-1.17.1.log ):</span><br><span class="line">cabal: Entering directory &apos;/var/folders/4f/s20y12v152dgfl1rqbs3ztfc0000gn/T/cabal-tmp-245/haskell-src-exts-1.17.1&apos;</span><br><span class="line">Configuring haskell-src-exts-1.17.1...</span><br><span class="line">cabal.real: The program &apos;happy&apos; version &gt;=1.19 is required but it could not be</span><br><span class="line">found.</span><br><span class="line">cabal: Leaving directory &apos;/var/folders/4f/s20y12v152dgfl1rqbs3ztfc0000gn/T/cabal-tmp-245/haskell-src-exts-1.17.1&apos;</span><br><span class="line">cabal: Error: some packages failed to install:</span><br><span class="line">haskell-src-exts-1.17.1 failed during the configure step. The exception was:</span><br><span class="line">ExitFailure 1</span><br><span class="line">hlint-1.9.35 depends on haskell-src-exts-1.17.1 which failed to install.</span><br><span class="line">hsdev-0.2.0.0 depends on haskell-src-exts-1.17.1 which failed to install.</span><br></pre></td></tr></table></figure><p>é‚å…ˆè£…happyï¼Œå†æ¥è£…hsdevã€‚<br>(PS: è¿™ä¸ªhsdevåŒ…å®‰è£…è¿‡ç¨‹ä¸­çš„å„ç§buildè¶…è¶…è¶…æ…¢)</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ cabal install happy</span><br><span class="line">$ cabal install hsdev  </span><br></pre></td></tr></table></figure><p>ç­‰äº†å¥½ä¹…ç»ˆäºè£…å¥½äº†ï¼Œç»“æœæ‰“å¼€Sublimeä¾ç„¶æŠ¥é”™ï¼Œè¿˜éœ€è¦æ‰‹åŠ¨é…ç½®SublimeHaskellã€‚<br>èœå•æ é€‰<code>Preferences -&gt; Package Settings -&gt; SublimeHaskell -&gt; Settings - User</code>è¿›è¡Œé…ç½®ï¼Œæ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"add_to_PATH"</span>:</span><br><span class="line">    [</span><br><span class="line">        <span class="string">"/Users/mist/Library/Haskell/bin"</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">"enable_ghc_mod"</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">"enable_hdevtools"</span>: <span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„ï¼šæ–‡ä»¶ä¸­çš„è·¯å¾„åº”å½“ä¿®æ”¹ä¸ºä½ è‡ªå·±çš„è·¯å¾„ï¼Œå¯ä»¥ç”¨<code>cat ~/.cabal/where-is-my-stuff.txt</code>æŸ¥çœ‹ã€‚</strong></p><p>å†æ¬¡é‡å¯sublimeï¼Œè¿™æ¬¡æ²¡æœ‰æŠ¥é”™ã€‚</p><h4 id="sublimerepl">SublimeREPL</h4><p>åœ¨Package Controlä¸­å®‰è£…SublimeREPLã€‚<br>è¿™ä¸ªæ’ä»¶å¯ä»¥ç›´æ¥æ–°å»ºä¸€ä¸ªtabç”¨æ¥è·‘GHCiï¼Œé…åˆ<code>View -&gt; Layout -&gt; Coloum: 2</code>ä½¿ç”¨ï¼Œæ–¹ä¾¿å¼€å‘ä¸è°ƒè¯•ã€‚</p><h4 id="stylish-haskell">stylish-haskell</h4><p>æœ‰å¾…ç ”ç©¶ã€‚</p><h3 id="æµ‹è¯•ä¸€ä¸‹">æµ‹è¯•ä¸€ä¸‹</h3><h4 id="è‡ªå¸¦build-systemå¯ä»¥ä½¿ç”¨">è‡ªå¸¦Build Systemå¯ä»¥ä½¿ç”¨</h4><p><code>Tools -&gt; Build System -&gt; Automatic æˆ– Haskell</code><br>ç›´æ¥è¿è¡Œå½“å‰æ–‡ä»¶ã€‚<br><img src="http://ocdmsdl3m.bkt.clouddn.com/sublime_haskell_1.png" alt="sublime build system"></p><h4 id="sublimehaskellå¸¸ç”¨å‘½ä»¤">SublimeHaskellå¸¸ç”¨å‘½ä»¤</h4><p>æ˜¾ç¤ºå£°æ˜ä½ç½®ï¼š<code>f12</code><br>è¯¦ç»†å£°æ˜æ–‡æ¡£ï¼š<code>ctrl+k ctrl+i</code><br>æ˜¾ç¤ºç±»å‹ï¼š<code>ctrl+k ctrl+h ctrl+t</code><br>æ’å…¥ç±»å‹ï¼š<code>ctrl+k ctrl+i ctrl+i</code><br>å½“ç„¶ï¼Œä¹Ÿå¯ä»¥ç”¨<code>command+shift+p</code>è°ƒç”¨è¿™äº›å‘½ä»¤ã€‚</p><h4 id="sublimerepl-v2">SublimeREPL</h4><p>ä¸ç”¨é¢å¤–é…ç½®ï¼Œé€šè¿‡<code>Tools -&gt; SublimeREPL -&gt; Haskell</code>å¯ä»¥ç›´æ¥æ‰“å¼€GHCiã€‚</p><h3 id="æ€»ç»“">æ€»ç»“</h3><p>ç”Ÿå‘½ä¸æ¯ï¼ŒæŠ˜è…¾ä¸æ­¢ï¼Œç»ˆäºå¯ä»¥æ„‰å¿«åœ°æ•²haskellå•¦~<br>ä¸»è¦çš„å‘éƒ½åœ¨cabalä¸Šï¼Œcabalè¿™ä¸ªåŒ…ç®¡ç†æ¯”èµ· pip npm å•¥çš„å®åœ¨å¤ªå¼±äº†ï¼Œè¿uninstalléƒ½æ²¡æœ‰ï¼(æ•²<code>cabal uninstall</code>ä¼šå‘Šè¯‰ä½ ä»¥åä¼šåŠ ä¸Šè¿™ä¸ªåŠŸèƒ½çš„ã€‚ã€‚ã€‚)</p><h3 id="å‚è€ƒ">å‚è€ƒ</h3><ol><li><a href="https://github.com/SublimeHaskell/SublimeHaskell" target="_blank" rel="noopener">SublimeHaskell GitHub repo</a></li><li><a href="http://tonylawrence.com/2014/01/01/configuring-your-haskell-environment/" target="_blank" rel="noopener">Configuring your Haskell environment</a></li><li><a href="http://umairsaeed.com/blog/2015/05/02/sublime-text-and-haskell/" target="_blank" rel="noopener">Sublime Text &amp; Haskell</a></li><li><a href="https://github.com/jaspervdj/stylish-haskell" target="_blank" rel="noopener">stylish-haskell GitHub repo</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;åŸºç¡€å‡†å¤‡&quot;&gt;åŸºç¡€å‡†å¤‡&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.haskell.org/downloads&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Haskell&lt;/a&gt; (æˆ‘é€‰æ‹©çš„æ˜¯Haskell Platform 8.0.1)&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.sublimetext.com/3&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Sublime Text&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://packagecontrol.io/installation&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Package Control: The Sublime Text package manager&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;å®‰è£…æ’ä»¶&quot;&gt;å®‰è£…æ’ä»¶&lt;/h3&gt;
&lt;h4 id=&quot;sublimehaskell&quot;&gt;SublimeHaskell&lt;/h4&gt;
&lt;p&gt;åœ¨Package Controlä¸­å®‰è£…SublimeHaskellã€‚&lt;br&gt;
æ’ä»¶å®‰è£…å®Œæˆåï¼Œé‡å¯SublimeæŠ¥é”™ï¼Œæç¤ºéœ€è¦å®‰è£…hsdev cabal packageã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;SublimeHaskell: hsdev executable couldn&amp;apos;t be found!&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;It&amp;apos;s used in most features of SublimeHaskell&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Check if it&amp;apos;s installed and in PATH&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;If it&amp;apos;s not installed, run &amp;apos;cabal install hsdev&amp;apos; to install hsdev&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;You may also want to adjust &amp;apos;add_to_PATH&amp;apos; setting&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="Haskell" scheme="http://duanyifu.com/categories/Haskell/"/>
    
    
      <category term="Haskell" scheme="http://duanyifu.com/tags/Haskell/"/>
    
      <category term="Sublime" scheme="http://duanyifu.com/tags/Sublime/"/>
    
  </entry>
  
  <entry>
    <title>Programming in Haskell Chapter2 Exercises Solutions</title>
    <link href="http://duanyifu.com/2016/08/23/PIHex2/"/>
    <id>http://duanyifu.com/2016/08/23/PIHex2/</id>
    <published>2016-08-23T07:13:53.000Z</published>
    <updated>2016-08-28T15:47:58.000Z</updated>
    
    <content type="html"><![CDATA[<p><em>Programming in Haskell</em>æ˜¯ä¸€æœ¬å…¥é—¨Haskellçš„å¥½ä¹¦ï¼Œä»‹ç»é¡µé¢ä»¥åŠé…å¥—çš„slides, vedios, codeséƒ½åœ¨<a href="http://www.cs.nott.ac.uk/~pszgmh/book.html" target="_blank" rel="noopener">è¿™é‡Œ</a>ã€‚</p><hr><h4 id="ç»™ç®—æ•°è¡¨è¾¾å¼åŠ ä¸Šæ‹¬å·">ç»™ç®—æ•°è¡¨è¾¾å¼åŠ ä¸Šæ‹¬å·</h4><p>æŒ‰ç…§è¿ç®—ç¬¦ä¼˜å…ˆçº§å°±å¯ä»¥ï¼Œç•¥è¿‡ã€‚</p><h4 id="ä¿®æ”¹ä»£ç -ä½¿ä¹‹æ­£ç¡®">ä¿®æ”¹ä»£ç ï¼Œä½¿ä¹‹æ­£ç¡®</h4><p>å°†<code>length xs</code>ç”¨æ‹¬å·æ‹¬èµ·æ¥å³å¯ã€‚</p><h4 id="å°è¯•å®šä¹‰last">å°è¯•å®šä¹‰<code>last</code></h4><p><code>last</code>: è¿”å›éç©ºlistçš„æœ€åä¸€ä¸ªå…ƒç´ </p><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">mylast</span> a = a !! ((length a) - <span class="number">1</span>)</span><br></pre></td></tr></table></figure><h4 id="å°è¯•å®šä¹‰init">å°è¯•å®šä¹‰<code>init</code></h4><p><code>init</code>: åˆ é™¤éç©ºlistçš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¿”å›list</p><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">myinit1</span> a = take ((length a) - <span class="number">1</span>) a</span><br><span class="line"></span><br><span class="line"><span class="title">myinit2</span> a = <span class="keyword">let</span> n = length a <span class="keyword">in</span> reverse (tail (reverse a))</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;em&gt;Programming in Haskell&lt;/em&gt;æ˜¯ä¸€æœ¬å…¥é—¨Haskellçš„å¥½ä¹¦ï¼Œä»‹ç»é¡µé¢ä»¥åŠé…å¥—çš„slides, vedios, codeséƒ½åœ¨&lt;a href=&quot;http://www.cs.nott.ac.uk/~pszgmh/book.html&quot; targe
      
    
    </summary>
    
      <category term="Haskell" scheme="http://duanyifu.com/categories/Haskell/"/>
    
    
      <category term="Haskell" scheme="http://duanyifu.com/tags/Haskell/"/>
    
      <category term="Programming in Haskell" scheme="http://duanyifu.com/tags/Programming-in-Haskell/"/>
    
  </entry>
  
  <entry>
    <title>hexo deploy å‘½ä»¤å¡ä½çš„å¥‡æ€ªé—®é¢˜</title>
    <link href="http://duanyifu.com/2016/08/23/hexo-deploy-problem/"/>
    <id>http://duanyifu.com/2016/08/23/hexo-deploy-problem/</id>
    <published>2016-08-22T18:25:10.000Z</published>
    <updated>2016-08-22T18:56:46.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="é—®é¢˜æè¿°">é—®é¢˜æè¿°</h3><p>ç”¨<code>hexo d</code>å‘½ä»¤éƒ¨ç½²çš„æ—¶å€™æ€»æ˜¯ä¼šå¡ä½å¾ˆä¹…ï¼Œåå¤å°è¯•äº†å‡ æ¬¡åï¼Œæ¯æ¬¡éƒ½æ˜¯control+Cå‘Šç»ˆã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">â–¶ hexo d</span><br><span class="line">INFO  Deploying: git</span><br><span class="line">INFO  Clearing .deploy_git folder...</span><br><span class="line">INFO  Copying files from public folder...</span><br><span class="line">On branch master</span><br><span class="line">nothing to commit, working directory clean</span><br><span class="line">^CINFO  Bye!</span><br></pre></td></tr></table></figure><a id="more"></a><p><code>hexo d -debug</code>æŸ¥çœ‹æ—¥å¿—å‘ç°ä¿¡æ¯ä¸€ç›´åœ¨å¾ªç¯</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">â–¶ hexo deploy -debug</span><br><span class="line">INFO  Start processing</span><br><span class="line">INFO  Files loaded in 620 ms</span><br><span class="line">INFO  0 files generated in 518 ms</span><br><span class="line">INFO  Start processing</span><br><span class="line">INFO  Files loaded in 468 ms</span><br><span class="line">INFO  0 files generated in 363 ms</span><br><span class="line">INFO  Start processing</span><br><span class="line">INFO  Files loaded in 342 ms</span><br><span class="line">...</span><br><span class="line">INFO  Start processing</span><br><span class="line">INFO  Files loaded in 274 ms</span><br><span class="line">INFO  0 files generated in 381 ms</span><br><span class="line">INFO  Start processing</span><br><span class="line">^CINFO  Bye!</span><br></pre></td></tr></table></figure><h3 id="è§£å†³åŠæ³•">è§£å†³åŠæ³•</h3><p>é¦–å…ˆæ£€æŸ¥_config.ymlæ–‡ä»¶ï¼Œçœ‹çœ‹deploymentç›¸å…³é…ç½®å†™å¯¹äº†æ²¡</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># Deployment</span><br><span class="line">## Docs: https://hexo.io/docs/deployment.html</span><br><span class="line">deploy:</span><br><span class="line">  type: git</span><br><span class="line">  repo: git@github.com:mistwave/mistwave.github.io.git</span><br><span class="line">  branch: master</span><br></pre></td></tr></table></figure><p>å¯¹ç…§å®˜æ–¹æ–‡æ¡£åï¼Œå‘ç°é…ç½®å¹¶æ²¡æœ‰é”™ï¼Œæ¨æµ‹æ˜¯sshçš„é—®é¢˜ã€‚<br>å°†repoæ”¹æˆhttpsåœ°å€åï¼Œé—®é¢˜ä¾æ—§å­˜åœ¨ã€‚</p><p>æ‰¾äº†ä¸€äº›ç±»ä¼¼é—®é¢˜çš„èµ„æ–™åï¼Œå°è¯•äº†åˆ é™¤<code>.deploy_git</code>ï¼Œæ›´æ–°gitç‰ˆæœ¬åï¼Œé—®é¢˜ä¾ç„¶æ²¡æœ‰è§£å†³ã€‚</p><p>ä½†æ˜¯åœ¨åˆ é™¤<code>.deploy_git</code>åï¼Œå‘ç°æ€»æ˜¯åœ¨gitlogåé¢å¡ä½ï¼Œæ¨æµ‹æ˜¯<code>git push</code>çš„é—®é¢˜ï¼Œå°è¯•è®©gitèµ°ä»£ç†ï¼Œé—®é¢˜è§£å†³ï¼Œä»¤äººå“­ç¬‘ä¸å¾—ã€‚</p><p>gité…ç½®å¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config --global http.proxy &apos;socks5://127.0.0.1:1080&apos;</span><br><span class="line">git config --global https.proxy &apos;socks5://127.0.0.1:1080&apos;</span><br></pre></td></tr></table></figure><p>è®¾ç½®çš„æ„æ€æ˜¯è®©http/httpsåè®®èµ°ä»£ç†ï¼Œå³Shadowsocksçš„æœ¬åœ°ä»£ç†ã€‚</p><h3 id="å‚è€ƒæ–‡ç« ">å‚è€ƒæ–‡ç« </h3><ol><li><a href="https://github.com/hexojs/hexo/issues/1478" target="_blank" rel="noopener">hexo repoä¸Šä¸€ä¸ªç±»ä¼¼issues</a></li><li><a href="http://www.wuliaole.com/post/the_lag_problem_for_hexo_deploying_on_github/" target="_blank" rel="noopener">hexoåœ¨githubéƒ¨ç½²å¡ä½çš„å¥‡æ€ªé—®é¢˜</a></li><li><a href="http://droidyue.com/blog/2016/04/04/set-shadowsocks-proxy-for-terminal/index.html" target="_blank" rel="noopener">ä¸ºç»ˆç«¯è®¾ç½®Shadowsocksä»£ç†</a></li><li><a href="http://blog.fazero.cc/2015/07/11/%E7%94%A8shadowsocks%E5%8A%A0%E9%80%9Fgit-clone/" target="_blank" rel="noopener">ç”¨shadowsocksåŠ é€Ÿgit clone</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;é—®é¢˜æè¿°&quot;&gt;é—®é¢˜æè¿°&lt;/h3&gt;
&lt;p&gt;ç”¨&lt;code&gt;hexo d&lt;/code&gt;å‘½ä»¤éƒ¨ç½²çš„æ—¶å€™æ€»æ˜¯ä¼šå¡ä½å¾ˆä¹…ï¼Œåå¤å°è¯•äº†å‡ æ¬¡åï¼Œæ¯æ¬¡éƒ½æ˜¯control+Cå‘Šç»ˆã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;â–¶ hexo d&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;INFO  Deploying: git&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;INFO  Clearing .deploy_git folder...&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;INFO  Copying files from public folder...&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;On branch master&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;nothing to commit, working directory clean&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;^CINFO  Bye!&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="ç–‘éš¾æ‚ç—‡" scheme="http://duanyifu.com/categories/%E7%96%91%E9%9A%BE%E6%9D%82%E7%97%87/"/>
    
    
      <category term="hexo" scheme="http://duanyifu.com/tags/hexo/"/>
    
      <category term="git" scheme="http://duanyifu.com/tags/git/"/>
    
      <category term="shadowsocks" scheme="http://duanyifu.com/tags/shadowsocks/"/>
    
  </entry>
  
  <entry>
    <title>Programming in Haskell Chapter1 Exercises Solutions</title>
    <link href="http://duanyifu.com/2016/08/22/PIHex1/"/>
    <id>http://duanyifu.com/2016/08/22/PIHex1/</id>
    <published>2016-08-22T15:47:22.000Z</published>
    <updated>2016-08-28T15:47:52.000Z</updated>
    
    <content type="html"><![CDATA[<p><em>Programming in Haskell</em>æ˜¯ä¸€æœ¬å…¥é—¨Haskellçš„å¥½ä¹¦ï¼Œä»‹ç»é¡µé¢ä»¥åŠé…å¥—çš„slides, vedios, codeséƒ½åœ¨<a href="http://www.cs.nott.ac.uk/~pszgmh/book.html" target="_blank" rel="noopener">è¿™é‡Œ</a>ã€‚</p><hr><h4 id="ç»™å‡ºdouble-double-2-çš„å¦å¤–ä¸€ç§å¯èƒ½è§£é‡Š">ç»™å‡º<code>double (double 2)</code>çš„å¦å¤–ä¸€ç§å¯èƒ½è§£é‡Šã€‚</h4><p>ä¹¦ä¸Šç»™çš„ä¾‹å­æ˜¯åº”ç”¨åºå’Œæ­£åˆ™åºï¼ˆä»å·¦å‘å³ï¼‰ï¼Œå¯ä»¥å°†æ­£åˆ™åºï¼ˆä»å³å‘å·¦ï¼‰å½“ä½œç­”æ¡ˆã€‚</p><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">double</span> (double <span class="number">2</span>)</span><br><span class="line">= double <span class="number">2</span> + double <span class="number">2</span></span><br><span class="line">= double <span class="number">2</span> + (<span class="number">2</span> + <span class="number">2</span>)</span><br><span class="line">= double <span class="number">2</span> + <span class="number">4</span></span><br><span class="line">= (<span class="number">2</span> + <span class="number">2</span>) + <span class="number">4</span></span><br><span class="line">= <span class="number">4</span> + <span class="number">4</span></span><br><span class="line">= <span class="number">8</span></span><br></pre></td></tr></table></figure><a id="more"></a><h4 id="è§£é‡Šsum-x-çš„æ±‚å€¼è¿‡ç¨‹">è§£é‡Š<code>sum [x]</code>çš„æ±‚å€¼è¿‡ç¨‹ã€‚</h4><p>sumçš„å®šä¹‰ï¼š</p><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">sum</span> [] = <span class="number">0</span></span><br><span class="line"><span class="title">sum</span> (x:xs) = x + sum xs</span><br></pre></td></tr></table></figure><p>sum [x] æ±‚å€¼è¿‡ç¨‹ï¼š</p><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">sum</span> [x]</span><br><span class="line">= x + sum []</span><br><span class="line">= x + <span class="number">0</span></span><br><span class="line">= x</span><br></pre></td></tr></table></figure><h4 id="å®šä¹‰product">å®šä¹‰<code>product</code>ã€‚</h4><p>ä»¿ç…§sumçš„å®šä¹‰ï¼Œå°†productå®šä¹‰å¦‚ä¸‹ï¼š</p><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">product</span> []     = <span class="number">1</span></span><br><span class="line"><span class="title">product</span> (x:xs) = x * sum xs</span><br></pre></td></tr></table></figure><p>product [2, 3, 4]æ±‚å€¼è¿‡ç¨‹ï¼š</p><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">product</span> [<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>]</span><br><span class="line">= <span class="number">2</span> * product [<span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line">= <span class="number">2</span> * <span class="number">3</span> * product [<span class="number">4</span>]</span><br><span class="line">= <span class="number">2</span> * <span class="number">3</span> * <span class="number">4</span> * product []</span><br><span class="line">= <span class="number">2</span> * <span class="number">3</span> * <span class="number">4</span> * <span class="number">1</span></span><br><span class="line">= <span class="number">24</span></span><br></pre></td></tr></table></figure><h4 id="å°†qsortæ”¹æˆè¾“å‡ºå€’åºçš„">å°†<code>qsort</code>æ”¹æˆè¾“å‡ºå€’åºçš„ã€‚</h4><p>å°†è¯¾æœ¬ä¸­çš„ä¾‹å­largerå’Œsmalleräº¤æ¢å³å¯ã€‚</p><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- qsort.hs</span></span><br><span class="line"><span class="title">qsort</span> [] = []</span><br><span class="line"><span class="title">qsort</span> (x:xs) = qsort larger ++ [x] ++ qsort smaller</span><br><span class="line">               <span class="keyword">where</span></span><br><span class="line">                larger = [a | a &lt;- xs, a &gt; x]</span><br><span class="line">                smaller = [b | b &lt;- xs, b &lt;= x]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">--- *Main&gt; qsort [3,5,1,4,2]</span></span><br><span class="line"><span class="comment">--- [5,4,3,2,1]</span></span><br></pre></td></tr></table></figure><h4 id="å°†qsortå®šä¹‰ä¸­çš„-æ¢æˆ-ä¼šå¦‚ä½•">å°†<code>qsort</code>å®šä¹‰ä¸­çš„<code>&lt;=</code>æ¢æˆ<code>&lt;</code>ä¼šå¦‚ä½•ã€‚</h4><p>è‹¥å°†<code>&lt;=</code>æ¢æˆ<code>&lt;</code>ï¼Œåˆ™ä¸<code>x</code>ç›¸ç­‰çš„å…ƒç´ å°†ä¼šä¸¢å¤±ã€‚</p><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">*<span class="type">Main</span>&gt; qsort [<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">1</span>]</span><br><span class="line">[<span class="number">3</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">1</span>]</span><br></pre></td></tr></table></figure><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">this</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;em&gt;Programming in Haskell&lt;/em&gt;æ˜¯ä¸€æœ¬å…¥é—¨Haskellçš„å¥½ä¹¦ï¼Œä»‹ç»é¡µé¢ä»¥åŠé…å¥—çš„slides, vedios, codeséƒ½åœ¨&lt;a href=&quot;http://www.cs.nott.ac.uk/~pszgmh/book.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;è¿™é‡Œ&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h4 id=&quot;ç»™å‡ºdouble-double-2-çš„å¦å¤–ä¸€ç§å¯èƒ½è§£é‡Š&quot;&gt;ç»™å‡º&lt;code&gt;double (double 2)&lt;/code&gt;çš„å¦å¤–ä¸€ç§å¯èƒ½è§£é‡Šã€‚&lt;/h4&gt;
&lt;p&gt;ä¹¦ä¸Šç»™çš„ä¾‹å­æ˜¯åº”ç”¨åºå’Œæ­£åˆ™åºï¼ˆä»å·¦å‘å³ï¼‰ï¼Œå¯ä»¥å°†æ­£åˆ™åºï¼ˆä»å³å‘å·¦ï¼‰å½“ä½œç­”æ¡ˆã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight haskell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;double&lt;/span&gt; (double &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;= double &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; + double &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;= double &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; + (&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; + &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;= double &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; + &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;= (&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; + &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;) + &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;= &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt; + &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;= &lt;span class=&quot;number&quot;&gt;8&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="Haskell" scheme="http://duanyifu.com/categories/Haskell/"/>
    
    
      <category term="Haskell" scheme="http://duanyifu.com/tags/Haskell/"/>
    
      <category term="Programming in Haskell" scheme="http://duanyifu.com/tags/Programming-in-Haskell/"/>
    
  </entry>
  
</feed>
